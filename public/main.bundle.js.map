{"version":3,"file":"main.bundle.js","mappings":"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","sources":["webpack://avaruussota/./js/common.js","webpack://avaruussota/./js/controls.js","webpack://avaruussota/./js/cursor.js","webpack://avaruussota/./js/draw.js","webpack://avaruussota/./js/joystick.js","webpack://avaruussota/./js/ui.js","webpack://avaruussota/./node_modules/js-cookie/dist/js.cookie.js","webpack://avaruussota/./src/game/bullet.js","webpack://avaruussota/./src/game/physics.js","webpack://avaruussota/./src/game/powerup.js","webpack://avaruussota/./src/game/ship.js","webpack://avaruussota/./src/utils/chron.js","webpack://avaruussota/./src/utils/counter.js","webpack://avaruussota/./src/utils/geom.js","webpack://avaruussota/./src/utils/lcg.js","webpack://avaruussota/./src/utils/maths.js","webpack://avaruussota/./src/utils/serial.js","webpack://avaruussota/webpack/bootstrap","webpack://avaruussota/./js/main.js"],"sourcesContent":["\nconst isMobile = () => {\n  return /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)\n}\n\nmodule.exports = {\n  isMobile\n}\n","const chron = require('../src/utils/chron')\n\nmodule.exports = (canvas, self, state, cursor, callbacks) => {\n  let firing = false\n  let accel = false\n  let brake = false\n  let turnLeft = false\n  let turnRight = false\n\n  const isAccelerating = () => accel\n  const isBraking = () => brake\n  const isFiring = () => firing\n  const isTurningLeft = () => turnLeft\n  const isTurningRight = () => turnRight\n\n  const accelerate = flag => {\n    if (accel !== flag) {\n      accel = flag\n      if (!flag)\n        self.accel = null\n      resendControls()\n    }\n  }\n\n  const reset = () => {\n    accel = false\n    brake = false\n    turnLeft = false\n    turnRight = false\n    firing = false\n  }\n\n  const resendControls = () => callbacks.resendControls()\n\n  const unpress = () => {\n    reset()\n    self.accel = null\n    resendControls()\n  }\n\n  const handleMouseDown = (e) =>{\n    if (!state.mouseLocked && !document.hidden && !state.dead) {\n      callbacks.tryLockMouse(e)\n    }\n    handleMouseMove(e)\n  }\n  \n  const handleMouseUp = (e) => {\n    handleMouseMove(e)\n  }\n  \n  const handleMouseMove = (e) => {\n    const leftButton = (e.buttons & 1) !== 0\n    const rightButton = (e.buttons & 2) !== 0\n  \n    if (leftButton && !firing) {\n      firing = true\n      resendControls()\n    } else if (!leftButton && firing) {\n      firing = false\n      resendControls()\n    }\n  \n    if (rightButton) {\n      callbacks.useItem()\n    }\n  \n    if (state.mouseLocked) {\n      cursor.addPosition(e.movementX, e.movementY)\n      const mcx = document.body.clientWidth / 2\n      const mcy = document.body.clientHeight / 2\n      const radius = Math.hypot(cursor.getX() - mcx, mcy - cursor.getY())\n      if (!self.latched && radius > 2) {\n        self.orient = Math.atan2(cursor.getX() - mcx, mcy - cursor.getY())\n        resendControls()\n      }\n    }\n  }\n  \n  document.addEventListener('pointerlockchange', () => {\n    state.mouseLocked = document.pointerLockElement === canvas\n  })\n  \n  canvas.addEventListener('pointerdown', (e) => {\n    if (e.pointerType == 'mouse') {\n      handleMouseDown(e)\n    }\n  })\n  \n  canvas.addEventListener('pointerup', (e) => {\n    if (e.pointerType == 'mouse') {\n      handleMouseUp(e)\n    }\n  })\n  \n  canvas.addEventListener('pointermove', (e) => {\n    if (e.pointerType == 'mouse') {\n      handleMouseMove(e)\n    }\n  })\n  \n  document.getElementById('btnfire').addEventListener('pointerdown', () => {\n    firing = true\n    resendControls()\n  })\n  document.getElementById('btnfire').addEventListener('pointerover', (e) => {\n    if (e.pressure > 0) {\n      firing = true\n      resendControls()\n    }\n  })\n  \n  document.getElementById('btnfire').addEventListener('pointerout', () => {\n    firing = false\n    resendControls()\n  })\n  document.getElementById('btnfire').addEventListener('pointerup', () => {\n    firing = false\n    resendControls()\n  })\n  \n  document.getElementById('btnbrake').addEventListener('pointerdown', () => {\n    brake = true\n    resendControls()\n  })\n  document.getElementById('btnbrake').addEventListener('pointerover', (e) => {\n    if (e.pressure > 0) {\n      brake = true\n      resendControls()\n    }\n  })\n  \n  document.getElementById('btnbrake').addEventListener('pointerout', () => {\n    brake = false\n    resendControls()\n  })\n  document.getElementById('btnbrake').addEventListener('pointerup', () => {\n    brake = false\n    resendControls()\n  })\n  \n  document.getElementById('btnconsume').addEventListener('pointerdown', () => {\n    callbacks.useItem()\n  })\n  document.getElementById('btnconsume').addEventListener('pointerover', (e) => {\n    if (e.pressure > 0) {\n      callbacks.useItem()\n    }\n  })\n  \n  if (!window.PointerEvent) {\n    canvas.addEventListener('mousedown', (e) => {\n      handleMouseDown(e)\n    })\n    \n    canvas.addEventListener('mouseup', (e) => {\n      handleMouseUp(e)\n    })\n    \n    canvas.addEventListener('mousemove', (e) => {\n      handleMouseMove(e)\n    })\n  }\n  \n  window.addEventListener('keydown', (e) => {\n    if (!state.token || state.dead) {\n      return\n    }\n  \n    if (e.code == 'KeyW') {\n      accel = true\n      self.accel = chron.timeMs()\n      resendControls()\n    } else if (e.code == 'KeyS') {\n      brake = true\n      resendControls()\n    } else if (e.code == 'KeyA') {\n      turnLeft = true\n    } else if (e.code == 'KeyD') {\n      turnRight = true\n    } else if (e.code == 'KeyQ') {\n      callbacks.useItem()\n    } else if (e.code == 'Space') {\n      firing = true\n      resendControls()\n    }\n  }, true)\n  \n  window.addEventListener('keyup', (e) => {\n    if (!state.token || state.dead) {\n      return\n    }\n  \n    if (e.code == 'KeyW') {\n      accel = false\n      self.accel = null\n      resendControls()\n    } else if (e.code == 'KeyS') {\n      brake = false\n      resendControls()\n    } else if (e.code == 'KeyA') {\n      turnLeft = false\n    } else if (e.code == 'KeyD') {\n      turnRight = false\n    } else if (e.code == 'KeyZ') {\n      callbacks.nextZoom(e.shiftKey ? -1 : 1)\n    } else if (e.code == 'Space') {\n      firing = false\n      resendControls()\n    }\n  }, true)\n  \n  return {\n    accelerate,\n    resendControls,\n    isAccelerating,\n    isBraking,\n    isFiring,\n    isTurningLeft,\n    isTurningRight,\n    reset,\n    unpress\n  }\n}\n","let cursorX = -10\nlet cursorY = -10\n\nconst setPosition = (x, y) => (cursorX = x, cursorY = y)\nconst addPosition = (x, y) => (cursorX += x, cursorY += y)\nconst getX = () => cursorX\nconst getY = () => cursorY\n\nmodule.exports = {\n  setPosition,\n  addPosition,\n  getX,\n  getY\n}\n","const LCG = require('../src/utils/lcg')\nconst geom = require('../src/utils/geom')\nconst physics = require('../src/game/physics')\n\nconst fogCanvas = document.createElement('canvas')\nconst fogCtx = fogCanvas.getContext('2d')\nconst SQRT_H = Math.sqrt(0.5)\nconst GRID_SIZE = 10\nconst PLANET_SPIN_SPEED = 0.02\nconst MINE_X = [0, SQRT_H, 1, SQRT_H, 0, -SQRT_H, -1, -SQRT_H]\nconst MINE_Y = [1, SQRT_H, 0, -SQRT_H, -1, -SQRT_H, 0, SQRT_H]\n\nmodule.exports = (canvas, self, objects, state, cursor) => {\n  const ctx = canvas.getContext('2d')\n\n  let damageGot = 0\n  let lcg = new LCG(0)\n  let lines = []\n  let smokes = []\n  let bubbles = []\n  let planetAngle = 0\n  let damageAlpha = 0\n  let lastSmoke = {}\n  let zoom = 1\n  let rubber = 150\n  let cx = 0\n  let cy = 0\n  let unitSize = 1\n\n  const reset = () => {\n    lines = []\n    smokes = []\n    damageGot = 0\n    damageAlpha = 0\n  }\n\n  const gotDamage = (damage) => {\n    damageGot = performance.now() + damage * 700\n    damageAlpha = 0.8 * damage\n  }\n\n  const setZoom = z => zoom = z\n\n  const setRubber = r => rubber = r\n\n  const checkSize = () => {\n    ctx.canvas.width = window.innerWidth * window.devicePixelRatio\n    ctx.canvas.height = window.innerHeight * window.devicePixelRatio\n    cx = ctx.canvas.width / 2\n    cy = ctx.canvas.height / 2\n    unitSize = Math.min(ctx.canvas.width, ctx.canvas.height) \n      / physics.VIEW_DISTANCE * (zoom / 2)\n    \n    drawFog()\n  }\n\n  const addBubble = bubble => bubbles.push(bubble)\n\n  const drawFog = () => {\n    fogCanvas.width = ctx.canvas.width\n    fogCanvas.height = ctx.canvas.height\n\n    fogCtx.clearRect(0, 0, fogCanvas.width, fogCanvas.height)\n    const bgradient = fogCtx.createRadialGradient(cx, cy,\n      (physics.VIEW_DISTANCE - 1) * unitSize,\n      cx, cy,\n      (physics.VIEW_DISTANCE + 10) * unitSize)\n\n    bgradient.addColorStop(0, 'rgba(0,0,0,0)')\n    bgradient.addColorStop(0.5, 'rgba(0,0,0,0.2)')\n    bgradient.addColorStop(1, 'rgba(0,0,0,0.9)')\n    fogCtx.beginPath()\n    fogCtx.arc(cx, cy, \n      (physics.VIEW_DISTANCE - 1) * unitSize, 0, 2 * Math.PI)\n    fogCtx.rect(fogCtx.canvas.width, 0, -fogCtx.canvas.width, fogCtx.canvas.height)\n    fogCtx.fillStyle = bgradient\n    fogCtx.fill()\n  }\n\n  const drawShip = (ship) => {\n    const [p1, p2, p3, p4] = geom.getShipPoints(ship)\n    let [x1, y1] = p1\n    let [x2, y2] = p2\n    let [x3, y3] = p3\n    let [x4, y4] = p4\n    let [x0, y0] = [0, 0]\n\n    x0 = cx + (self.posX - ship.posX) * unitSize\n    x1 = cx + (self.posX - x1) * unitSize\n    x2 = cx + (self.posX - x2) * unitSize\n    x3 = cx + (self.posX - x3) * unitSize\n    x4 = cx + (self.posX - x4) * unitSize\n\n    y0 = cy + (self.posY - ship.posY) * unitSize\n    y1 = cy + (self.posY - y1) * unitSize\n    y2 = cy + (self.posY - y2) * unitSize\n    y3 = cy + (self.posY - y3) * unitSize\n    y4 = cy + (self.posY - y4) * unitSize\n\n    ctx.strokeStyle = '#fff'\n    ctx.beginPath()\n    ctx.moveTo(x1, y1)\n    ctx.lineTo(x2, y2)\n    ctx.lineTo(x3, y3)\n    ctx.lineTo(x4, y4)\n    ctx.closePath()\n    ctx.stroke()\n\n    if (ship.accel !== null) {\n      const [tp1, tp2, tp3, tp4, tp5] = geom.getThrusterPoints(ship)\n      let [x1, y1] = tp1\n      let [x2, y2] = tp2\n      let [x3, y3] = tp3\n      let [x4, y4] = tp4\n      let [x5, y5] = tp5\n\n      let xo = (Math.random() - 0.5) * unitSize / 2\n      let yo = (Math.random() - 0.5) * unitSize / 2\n\n      x1 = cx + (self.posX - x1) * unitSize\n      x2 = cx + (self.posX - x2) * unitSize\n      x3 = cx + (self.posX - x3) * unitSize\n      x4 = cx + (self.posX - x4) * unitSize\n      x5 = cx + (self.posX - x5) * unitSize\n    \n      y1 = cy + (self.posY - y1) * unitSize\n      y2 = cy + (self.posY - y2) * unitSize\n      y3 = cy + (self.posY - y3) * unitSize\n      y4 = cy + (self.posY - y4) * unitSize\n      y5 = cy + (self.posY - y5) * unitSize\n\n      x3 += xo\n      y3 += yo\n      x5 += xo / 2\n      y5 += yo / 2  \n\n      ctx.strokeStyle = '#888'\n      ctx.beginPath()\n      ctx.moveTo(x1, y1)\n      ctx.lineTo(x2, y2)\n      ctx.lineTo(x3, y3)\n      ctx.lineTo(x4, y4)\n      ctx.lineTo(x1, y1)\n      ctx.lineTo(x5, y5)\n      ctx.closePath()\n      ctx.stroke()\n    }\n\n    ctx.font = `${18 * window.devicePixelRatio}px monospace`\n    ctx.fillStyle = 'rgba(255,255,255,0.75)'\n    ctx.textAlign = 'center'\n    ctx.fillText(ship.name, x0, y0 - 3.75 * unitSize)\n  }\n\n  const drawBullet = (bullet) => {\n    const x = cx + (self.posX - bullet.posX) * unitSize\n    const y = cy + (self.posY - bullet.posY) * unitSize\n\n    ctx.lineWidth = 1 * window.devicePixelRatio\n    if (bullet.type === 'bullet') {\n      ctx.moveTo(x, y)\n      ctx.arc(x, y, 0.3 * unitSize, 0, 2 * Math.PI)\n    } else if (bullet.type === 'laser') {\n      const x1 = cx + (self.posX - (bullet.posX + bullet.velX)) * unitSize\n      const y1 = cy + (self.posY - (bullet.posY + bullet.velY)) * unitSize\n      ctx.moveTo(x, y)\n      ctx.lineTo(x1, y1)\n    } else if (bullet.type === 'mine') {\n      ctx.moveTo(x + 1.6 * unitSize, y)\n      ctx.arc(x, y, 1.6 * unitSize, 0, 2 * Math.PI)\n      for (let i = 0; i < 8; ++i) {\n        const xo = unitSize * 0.8 * MINE_X[i]\n        const yo = unitSize * 0.8 * MINE_Y[i]\n        ctx.moveTo(x + 2 * xo, y + 2 * yo)\n        ctx.lineTo(x + 3 * xo, y + 3 * yo)\n      }\n      ctx.moveTo(x, y)\n    }\n  }\n\n  const drawLine = (line) => {\n    const { x, y, angle, r, alpha } = line\n    const x1 = cx + unitSize * (self.posX - x - r * Math.cos(angle))\n    const y1 = cy + unitSize * (self.posY - y - r * Math.sin(angle))\n    const x2 = cx + unitSize * (self.posX - x + r * Math.cos(angle))\n    const y2 = cy + unitSize * (self.posY - y + r * Math.sin(angle))\n\n    ctx.strokeStyle = `rgba(192,192,192,${alpha * 0.01})` \n    ctx.beginPath()\n    ctx.moveTo(x1, y1)\n    ctx.lineTo(x2, y2)\n    ctx.stroke()\n  }\n\n  const drawPowerup = (powerup, color) => {\n    const { posX, posY } = powerup\n\n    const sx = cx + (self.posX - posX) * unitSize\n    const sy = cy + (self.posY - posY) * unitSize\n\n    if (sx < -20 || sy < -20 \n      || sx > ctx.canvas.width + 20 || sy > ctx.canvas.height + 20) {\n      return\n    }\n\n    ctx.fillStyle = color\n    ctx.beginPath()\n    ctx.arc(sx, sy, unitSize, 0, 2 * Math.PI)\n    ctx.fill()\n  }\n\n  const drawSmoke = (smoke) => {\n    const { x, y, radius, alpha } = smoke\n    const sx = cx + (self.posX - x) * unitSize\n    const sy = cy + (self.posY - y) * unitSize\n\n    ctx.fillStyle = `rgba(92,92,92,${alpha * 0.01})` \n    ctx.beginPath()\n    ctx.arc(sx, sy, radius * unitSize, 0, 2 * Math.PI)\n    ctx.fill()\n  }\n\n  const drawBubble = (bubble) => {\n    const { x, y, radius, alpha } = bubble\n    const sx = cx + (self.posX - x) * unitSize\n    const sy = cy + (self.posY - y) * unitSize\n\n    ctx.lineWidth = window.devicePixelRatio * (1 + Math.max(0, alpha - 1))\n    ctx.strokeStyle = `rgba(128,128,128,${Math.min(1, alpha) * 0.01})` \n    ctx.beginPath()\n    ctx.arc(sx, sy, radius * unitSize, 0, 2 * Math.PI)\n    ctx.stroke()\n  }\n\n  const computePlanetAngle = (radius, sx, sy, angle) => {\n    return [sx + Math.sin(angle) * radius * unitSize,\n      sy + Math.cos(angle) * radius * unitSize]\n  }\n\n  const drawPlanet = (planet) => {\n    ctx.strokeStyle = '#fff'\n    ctx.lineWidth = 1 * window.devicePixelRatio\n    \n    const sx = cx + (self.posX - planet.x) * unitSize\n    const sy = cy + (self.posY - planet.y) * unitSize\n\n    if (sx < -planet.radius * unitSize \n      || sy < -planet.radius  * unitSize\n      || sx > ctx.canvas.width + planet.radius * unitSize \n      || sy > ctx.canvas.height + planet.radius * unitSize) {\n      return\n    }\n\n    lcg.reseed(planet.seed)\n    const gon = Math.abs(lcg.randomInt()) % 19 + 12\n\n    let angle = lcg.randomOffset() * Math.PI * 2 + planetAngle * lcg.randomSign()\n    let [x, y] = computePlanetAngle(planet.radius, sx, sy, angle)\n    let fac = 2 * Math.PI / gon\n\n    ctx.moveTo(x, y)\n    for (let i = 0; i <= gon; ++i) {\n      [x, y] = computePlanetAngle(planet.radius, sx, sy, angle + i * fac)\n      ctx.lineTo(x, y)\n    }\n  }\n\n  const createLine = (x1, y1, x2, y2, xv, yv, tpf) => {\n    const [x, y] = [(x1 + x2) / 2, (y1 + y2) / 2]\n    const angle = Math.atan2(x2 - x1, y2 - y1)\n    const r = Math.hypot(x2 - x1, y2 - y1) / 2\n    const vx = -0.05 + 0.1 * Math.random() + xv * tpf\n    const vy = -0.05 + 0.1 * Math.random() + yv * tpf\n    const vangle = -0.1 + 0.2 * Math.random()\n\n    return { x, y, angle, alpha: 100, r, vx, vy, vangle }\n  }\n\n  const explosion = (ship, tpf) => {\n    if (!ship) {\n      return\n    }\n\n    const [p1, p2, p3, p4] = geom.getShipPoints(ship)\n    let [x1, y1] = p1\n    let [x2, y2] = p2\n    let [x3, y3] = p3\n    let [x4, y4] = p4\n\n    let [x5, y5] = [(x1 + x2) / 2, (y1 + y2) / 2]\n    let [x6, y6] = [(x1 + x4) / 2, (y1 + y4) / 2]\n\n    lines.push(createLine(x1, y1, x5, y5, ship.velX, ship.velY, tpf))\n    lines.push(createLine(x5, y5, x2, y2, ship.velX, ship.velY, tpf))\n    lines.push(createLine(x2, y2, x3, y3, ship.velX, ship.velY, tpf))\n    lines.push(createLine(x3, y3, x4, y4, ship.velX, ship.velY, tpf))\n    lines.push(createLine(x4, y4, x6, y6, ship.velX, ship.velY, tpf))\n    lines.push(createLine(x6, y6, x1, y1, ship.velX, ship.velY, tpf))\n  }\n\n  const frame = (time, delta) => {\n    const xm = ((self.posX % GRID_SIZE) + GRID_SIZE) % GRID_SIZE\n    const ym = ((self.posY % GRID_SIZE) + GRID_SIZE) % GRID_SIZE\n\n    ctx.fillStyle = '#000'\n    ctx.fillRect(0, 0, ctx.canvas.width, ctx.canvas.height)\n\n    // draw grid\n    ctx.lineWidth = 1 * window.devicePixelRatio\n    ctx.strokeStyle = '#333'\n    ctx.beginPath()\n    for (let x = xm * unitSize; \n      x < ctx.canvas.width; \n      x += GRID_SIZE * unitSize) {\n      const dx = x | 0 + 0.5\n      ctx.moveTo(dx, 0)\n      ctx.lineTo(dx, ctx.canvas.height)\n    }\n    for (let y = ym * unitSize; \n      y < ctx.canvas.height;\n      y += GRID_SIZE * unitSize) {\n      const dy = y | 0 + 0.5\n      ctx.moveTo(0, dy)\n      ctx.lineTo(ctx.canvas.width, dy)\n    }\n    ctx.stroke()\n    \n    if (!self.dead) {\n      // draw red mask\n      if (rubber > 1) {\n        const gradient = ctx.createRadialGradient(cx + self.posX * unitSize,\n          cy + self.posY * unitSize,\n          (rubber - 1) * unitSize,\n          cx + self.posX * unitSize,\n          cy + self.posY * unitSize,\n          (rubber + physics.RUBBERBAND_BUFFER - 1) * unitSize)\n        gradient.addColorStop(0, 'rgba(192,192,192,0)')\n        gradient.addColorStop(1, 'rgba(192,192,192,0.25)')\n        ctx.beginPath()\n        ctx.arc(cx + self.posX * unitSize, cy + self.posY * unitSize, \n          rubber * unitSize, 0, 2 * Math.PI)\n        ctx.rect(ctx.canvas.width, 0, -ctx.canvas.width, ctx.canvas.height)\n        ctx.fillStyle = gradient\n        ctx.fill()\n      }\n\n      // draw player ship\n      ctx.lineWidth = 1.5 * window.devicePixelRatio\n      drawShip(self)\n      if (self.health < 0.75) {\n        const interval = 320 ** (self.health * 0.35 + 0.9) / 2 / (1 + Math.hypot(self.velX, self.velY) / 6)\n        if (!Object.prototype.hasOwnProperty.call(lastSmoke, self._id) || time - lastSmoke[self._id] > interval) {\n          smokes.push({ \n            x: self.posX + 1.5 * Math.random() - 0.75, \n            y: self.posY + 1.5 * Math.random() - 0.75, \n            radius: 0.15 + (0.75 - self.health) + Math.random() * 0.3, \n            alpha: 100 * Math.min(1, 1.4 - self.health) })\n          lastSmoke[self._id] = time\n        }\n      }\n\n      // draw ships\n      ctx.lineWidth = 1 * window.devicePixelRatio\n      for (const ship of objects.ships) {\n        drawShip(ship)\n        if (ship.health < 0.75) {\n          const interval = 320 ** (ship.health * 0.35 + 0.9) / 2 / (1 + Math.hypot(ship.velX, ship.velY) / 6)\n          if (!Object.prototype.hasOwnProperty.call(lastSmoke, ship._id) || time - lastSmoke[ship._id] > interval) {\n            smokes.push({ \n              x: ship.posX + 1.5 * Math.random() - 0.75, \n              y: ship.posY + 1.5 * Math.random() - 0.75, \n              radius: 0.15 + (0.75 - ship.health) + Math.random() * 0.3, \n              alpha: 100 * Math.min(1, 1.4 - ship.health) })\n            lastSmoke[ship._id] = time\n          }\n        }\n      }\n\n      ctx.fillStyle = '#fff'\n      ctx.strokeStyle = '#fff'\n      ctx.beginPath()\n      // draw bullets\n      for (const bullet of objects.bullets) {\n        drawBullet(bullet)\n      }\n      ctx.stroke()\n    }\n\n    ctx.beginPath()\n    // draw planets\n    for (const planet of objects.planets) {\n      drawPlanet(planet)\n    }\n    ctx.stroke()\n\n    if (objects.powerups.length) {\n      const ctr = 0 | ((time % 300) / 15)\n      const alp = (time / 1000) % 1.0\n      const powerupColor = `rgba(${224+ctr},255,${192+ctr*2},${Math.max(alp, 1 - alp)})`\n      // draw powerups\n      for (const powerup of objects.powerups) {\n        drawPowerup(powerup, powerupColor)\n      }\n    }\n      \n    // draw lines\n    for (const line of lines) {\n      drawLine(line)\n\n      line.x += line.vx\n      line.y += line.vy\n      line.angle += line.vangle\n      line.vx *= 0.99\n      line.vy *= 0.99\n      line.vangle *= 0.99\n      line.alpha -= 1\n    }\n    lines = lines.filter(line => line.alpha > 0)\n\n    // draw smokes\n    for (const smoke of smokes) {\n      drawSmoke(smoke)\n\n      smoke.radius += 0.015\n      smoke.alpha -= 1\n    }\n    smokes = smokes.filter(smoke => smoke.alpha > 0)\n\n    for (const shipid of Object.keys(lastSmoke)) {\n      if (time - lastSmoke[shipid] >= 5000) {\n        delete lastSmoke[shipid]\n      }\n    }\n\n    // draw bubbles\n    for (const bubble of bubbles) {\n      drawBubble(bubble)\n\n      bubble.radius += 0.05\n      bubble.alpha -= 1\n    }\n    bubbles = bubbles.filter(bubble => bubble.alpha > 0)\n\n    if (!self.dead) {\n      ctx.drawImage(fogCanvas, 0, 0)\n\n      if (damageAlpha > 0) {\n        ctx.beginPath()\n        ctx.fillStyle = `rgba(128,0,0,${damageAlpha})`\n        ctx.rect(0, 0, ctx.canvas.width, ctx.canvas.height)\n        ctx.fill()\n        if (time > damageGot && damageAlpha > 0) {\n          damageAlpha = Math.max(0, damageAlpha - delta / 800)\n        }\n      }\n    }\n    \n    if (state.mouseLocked) {\n      const cursorX = cursor.getX()\n      const cursorY = cursor.getY()\n      ctx.beginPath()\n      ctx.strokeStyle = '#fff'\n      ctx.lineWidth = 1 * window.devicePixelRatio\n      ctx.moveTo(cursorX - 8.5, cursorY + 0.5)\n      ctx.lineTo(cursorX + 9.5, cursorY + 0.5)\n      ctx.moveTo(cursorX + 0.5, cursorY - 8.5)\n      ctx.lineTo(cursorX + 0.5, cursorY + 9.5)\n      ctx.stroke()\n    }\n\n    planetAngle += PLANET_SPIN_SPEED\n    planetAngle %= 2 * Math.PI\n  }\n\n  window.addEventListener('resize', () => checkSize())\n\n  return {\n    reset,\n    gotDamage,\n    setZoom,\n    setRubber,\n    checkSize,\n    addBubble,\n    drawFog,\n    drawShip,\n    drawBullet,\n    drawLine,\n    drawPowerup,\n    drawSmoke,\n    drawBubble,\n    drawPlanet,\n    explosion,\n    frame\n  }\n}\n","const chron = require('../src/utils/chron')\nconst jouter = document.getElementById('joystickouter')\nconst jbase = document.getElementById('joystickbase')\nconst jstick = document.getElementById('joystick')\n\nmodule.exports = (self, state, controls) => {\n  const applyPosition = () => {\n    if (state.dead || self === null) {\n      return\n    }\n\n    const hjbw = jbase.offsetWidth / 2\n    const hjbh = jbase.offsetHeight / 2\n    let x = (jstick.offsetLeft + (jstick.offsetWidth / 2) - (jbase.offsetLeft + hjbw)) / hjbw * Math.sqrt(2)\n    let y = (jstick.offsetTop + (jstick.offsetHeight / 2) - (jbase.offsetTop + hjbh)) / hjbh * Math.sqrt(2)\n    if (x > 1) x = 1\n    if (x < -1) x = -1\n    if (y > 1) y = 1\n    if (y < -1) y = -1\n\n    const h = Math.hypot(x, y)\n    \n    const willAccel = h > 0.8\n    let shouldUpdateAccelStart = willAccel != controls.isAccelerating()\n\n    if (!self.latched && h > 0.01) {\n      const angle = Math.atan2(x, -y)\n      shouldUpdateAccelStart |= self.orient != angle\n      self.orient = angle \n    }\n\n    controls.accelerate(willAccel)\n    if (shouldUpdateAccelStart) {\n      if (willAccel) {\n        self.accel = chron.timeMs()\n      } else {\n        self.accel = null\n      }\n      controls.resendControls()\n    }\n  }\n\n  const resetJoystickCenter = () => {\n    jstick.style.top = jbase.offsetTop + (jbase.offsetHeight / 2) - (jstick.offsetHeight / 2) + 'px'\n    jstick.style.left = jbase.offsetLeft + (jbase.offsetWidth / 2) - (jstick.offsetWidth / 2) + 'px'\n    applyPosition()\n  }\n\n  jbase.addEventListener('pointerdown', (e) => {\n    jstick.style.left = e.clientX - (jstick.offsetWidth / 2) + 'px'\n    jstick.style.top = e.clientY - (jstick.offsetHeight / 2) + 'px'\n    applyPosition()\n  })\n\n  jbase.addEventListener('pointermove', (e) => {\n    if (e.pressure > 0 || e.buttons & 1) {\n      jstick.style.left = e.clientX - (jstick.offsetWidth / 2) + 'px'\n      jstick.style.top = e.clientY - (jstick.offsetHeight / 2) + 'px'\n      applyPosition()\n    }\n  })\n\n  jbase.addEventListener('pointerout', (e) => {\n    e.stopPropagation()\n    e.stopImmediatePropagation()\n  })\n\n  jstick.addEventListener('pointerout', (e) => {\n    e.stopPropagation()\n    e.stopImmediatePropagation()\n  })\n\n  jouter.addEventListener('pointerout', () => {\n    resetJoystickCenter()\n  })\n\n  jouter.addEventListener('pointerup', () => {\n    resetJoystickCenter()\n  })\n\n  return {\n    applyPosition,\n    resetJoystickCenter\n  }\n}\n","const common = require('./common')\n\nmodule.exports = (callbacks) => {\n  let dialogOpacity = 0\n\n  document.getElementById('scoreanimation').style.animation = 'none'\n  document.getElementById('scoreanimation').style.visibility = 'hidden'\n  document.getElementById('powerupanimation').style.animation = 'none'\n  document.getElementById('powerupanimation').style.visibility = 'hidden'\n\n  const updateZoomText = zoom => {\n    document.getElementById('btnzoom').textContent = `zoom: ${(zoom * 100) | 0}%`\n  }\n\n  const showDialog = () => {\n    dialogOpacity = 0\n    document.getElementById('dialogbox').style.opacity = '0'\n    document.getElementById('dialog').style.display = 'flex'\n    document.getElementById('stats').style.display = 'none'\n    document.getElementById('finalscore').style.display = 'block'\n    document.body.style.position = 'absolute'\n    document.body.style.overflow = ''\n  }\n\n  const hideDialog = () => {\n    document.getElementById('dialog').style.display = 'none'\n    document.getElementById('stats').style.display = 'block'\n    document.body.style.position = 'relative'\n    document.body.style.overflow = 'hidden'\n  }\n\n  const hideLose = () => {\n    document.getElementById('defeat').style.display = 'none'\n    document.getElementById('defeatcrash').style.display = 'none'\n    document.getElementById('defeatplanet').style.display = 'none'\n    document.getElementById('defeatname').style.display = 'none'\n    document.getElementById('disconnected').style.display = 'none'\n    document.getElementById('finalscore').style.display = 'none'\n  }\n\n  const disconnect = () => {\n    hideLose()\n    document.getElementById('disconnected').style.display = 'inline'\n  }\n\n  const updateOpacity = (delta) => {\n    if (dialogOpacity < 1) {\n      dialogOpacity = Math.min(1, dialogOpacity + delta / 250)\n      document.getElementById('dialogbox').style.opacity = dialogOpacity\n    }\n  }\n\n  const makeTd = (text) => {\n    const td = document.createElement('td')\n    td.textContent = text\n    return td\n  }\n  \n  const makeTableRow = (lb) => {\n    const tr = document.createElement('tr')\n    tr.appendChild(makeTd(lb[0]))\n    tr.appendChild(makeTd(lb[1]))\n    return tr\n  }\n  \n  const updateLeaderboard = (leaderboard) => {\n    const leaderBoardTable = document.getElementById('leaderboard')\n    const newBody = document.createElement('tbody')\n    \n    for (let i = 0; i < Math.min(10, leaderboard.length); ++i) {\n      newBody.appendChild(makeTableRow(leaderboard[i]))\n    }\n  \n    leaderBoardTable.replaceChild(newBody, leaderBoardTable.childNodes[0])\n  }\n    \n  const formatTime = (sec) => {\n    sec = Math.floor(sec)\n    return `${0 | (sec / 60)}:${('0' + (sec % 60)).slice(-2)}`\n  }\n\n  const updateControls = (state) => {\n    if (state.dead) {\n      document.getElementById('mobilecontrols').style.display = 'none'\n    } else {\n      document.getElementById('mobilecontrols').style.display = common.isMobile() ? 'block' : 'none'\n    }\n  }\n\n  const updatePowerup = (self, state) => {\n    let resText = ''\n    if (!state.dead) {\n      if (self.item !== null) {\n        if (common.isMobile()) {\n          resText += `item: ${self.item} ([USE] to use)\\n`\n        } else {\n          resText += `item: ${self.item} ([Q] to use)\\n`\n        }\n      }\n      if (self.rubbership > 0) {\n        resText += `[${formatTime(self.rubbership / 1000)}] rubber ship\\n`\n      }\n      if (self.overdrive > 0) {\n        resText += `[${formatTime(self.overdrive / 1000)}] overdrive\\n`\n      }\n      if (self.regen > 0) {\n        resText += `[${formatTime(self.regen / 1000)}] regen\\n`\n      }\n    }\n    document.getElementById('powerupstatus').textContent = resText.trim()\n    document.getElementById('btnconsume').style.display = self.item !== null ? 'block' : 'none'\n  }\n\n  const updateOnlineStatus = (text) => {\n    document.getElementById('onlinestatus').textContent = text\n  }\n\n  const updateColors = (health, time) => {\n    if (health < 0.3) {\n      document.getElementById('yourscore').style.color = (time % 1000) >= 500 ? '#f88' : '#fff'\n      document.getElementById('healthbarhealth').style.background = ((time + 100) % 800) >= 400 ? '#800' : '#c00'\n    } else if (health < 0.7) {\n      const t = (health - 0.3) / 0.4 * 204\n      document.getElementById('yourscore').style.color = '#fff'\n      document.getElementById('healthbarhealth').style.background = `rgba(204,${t},${t})`\n    } else {\n      document.getElementById('yourscore').style.color = '#fff'\n      document.getElementById('healthbarhealth').style.background = '#ccc'\n    }\n  }\n\n  const updateScore = (scoreNow, scoreWas) => {\n    document.getElementById('yourscore').textContent \n      = document.getElementById('scoreanimation').textContent \n      = document.getElementById('finalscorenum').textContent \n      = scoreNow\n    if (scoreNow > scoreWas) {\n      document.getElementById('scoreanimation').style.visibility = 'visible'\n      document.getElementById('scoreanimation').style.animation = 'none'\n      document.getElementById('scoreanimation').style.animation = ''\n    }\n  }\n\n  const updatePlayerCount = (players) => {\n    document.getElementById('playerCountNum').textContent = players\n  }\n\n  const updateHealthBar = (health) => {\n    document.getElementById('healthbarhealth').style.width = `${Math.ceil(health * 200)}px`\n  }\n\n  const addDeathLog = (text) => {\n    const deathLog = document.getElementById('deathlog')\n    if (deathLog.childElementCount > 5)\n      deathLog.removeChild(deathLog.firstChild)\n    const p = document.createElement('p')\n    p.textContent = text\n    setTimeout(() => {\n      if (p.parentNode) p.parentNode.removeChild(p)\n    }, 5000)\n    deathLog.appendChild(p)\n  }\n\n  const defeatedByPlayer = (name) => {\n    hideLose()\n    document.getElementById('defeat').style.display = 'inline'\n    document.getElementById('defeatname').style.display = 'inline'\n    document.getElementById('defeatname').innerHTML = name\n  }\n\n  const defeatedByCrash = (name) => {\n    hideLose()\n    document.getElementById('defeatcrash').style.display = 'inline'\n    document.getElementById('defeatname').style.display = 'inline'\n    document.getElementById('defeatname').innerHTML = name\n  }\n\n  const defeatedByPlanet = () => {\n    hideLose()\n    document.getElementById('defeatplanet').style.display = 'inline'\n  }\n\n  const showPowerupAnimation = () => {\n    // document.getElementById('powerupanimation').style.visibility = 'visible'\n    document.getElementById('powerupanimation').style.animation = 'none'\n    document.getElementById('powerupanimation').style.animation = ''\n  }\n\n  const joiningGame = () => {\n    document.getElementById('scoreanimation').style.animation = 'none'\n    document.getElementById('scoreanimation').style.visibility = 'hidden'\n    document.getElementById('powerupanimation').style.animation = 'none'\n    document.getElementById('powerupanimation').style.visibility = 'hidden'\n    document.getElementById('btnplay').blur()\n    updateOnlineStatus('connecting')\n  }\n\n  document.getElementById('btnplay').addEventListener('click', (e) => {\n    callbacks.tryLockMouse(e)\n    callbacks.joinGame()\n  })\n  document.getElementById('btnfs').addEventListener('click', () => {\n    if (document.fullscreenElement) {\n      document.exitFullscreen()\n    } else {\n      document.documentElement.requestFullscreen()\n    }\n  })\n  document.getElementById('btnzoom').addEventListener('click', () => {\n    callbacks.nextZoom(1)\n  })\n\n  return {\n    updateZoomText,\n    updatePowerup,\n    showDialog,\n    hideDialog,\n    hideLose,\n    disconnect,\n    updateControls,\n    updateOpacity,\n    updateLeaderboard,\n    updateOnlineStatus,\n    updateColors,\n    updateScore,\n    updatePlayerCount,\n    updateHealthBar,\n    showPowerupAnimation,\n    defeatedByPlayer,\n    defeatedByCrash,\n    defeatedByPlanet,\n    joiningGame,\n    addDeathLog,\n  }\n}\n","/*! js-cookie v3.0.1 | MIT */\n;\n(function (global, factory) {\n  typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\n  typeof define === 'function' && define.amd ? define(factory) :\n  (global = global || self, (function () {\n    var current = global.Cookies;\n    var exports = global.Cookies = factory();\n    exports.noConflict = function () { global.Cookies = current; return exports; };\n  }()));\n}(this, (function () { 'use strict';\n\n  /* eslint-disable no-var */\n  function assign (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n      for (var key in source) {\n        target[key] = source[key];\n      }\n    }\n    return target\n  }\n  /* eslint-enable no-var */\n\n  /* eslint-disable no-var */\n  var defaultConverter = {\n    read: function (value) {\n      if (value[0] === '\"') {\n        value = value.slice(1, -1);\n      }\n      return value.replace(/(%[\\dA-F]{2})+/gi, decodeURIComponent)\n    },\n    write: function (value) {\n      return encodeURIComponent(value).replace(\n        /%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,\n        decodeURIComponent\n      )\n    }\n  };\n  /* eslint-enable no-var */\n\n  /* eslint-disable no-var */\n\n  function init (converter, defaultAttributes) {\n    function set (key, value, attributes) {\n      if (typeof document === 'undefined') {\n        return\n      }\n\n      attributes = assign({}, defaultAttributes, attributes);\n\n      if (typeof attributes.expires === 'number') {\n        attributes.expires = new Date(Date.now() + attributes.expires * 864e5);\n      }\n      if (attributes.expires) {\n        attributes.expires = attributes.expires.toUTCString();\n      }\n\n      key = encodeURIComponent(key)\n        .replace(/%(2[346B]|5E|60|7C)/g, decodeURIComponent)\n        .replace(/[()]/g, escape);\n\n      var stringifiedAttributes = '';\n      for (var attributeName in attributes) {\n        if (!attributes[attributeName]) {\n          continue\n        }\n\n        stringifiedAttributes += '; ' + attributeName;\n\n        if (attributes[attributeName] === true) {\n          continue\n        }\n\n        // Considers RFC 6265 section 5.2:\n        // ...\n        // 3.  If the remaining unparsed-attributes contains a %x3B (\";\")\n        //     character:\n        // Consume the characters of the unparsed-attributes up to,\n        // not including, the first %x3B (\";\") character.\n        // ...\n        stringifiedAttributes += '=' + attributes[attributeName].split(';')[0];\n      }\n\n      return (document.cookie =\n        key + '=' + converter.write(value, key) + stringifiedAttributes)\n    }\n\n    function get (key) {\n      if (typeof document === 'undefined' || (arguments.length && !key)) {\n        return\n      }\n\n      // To prevent the for loop in the first place assign an empty array\n      // in case there are no cookies at all.\n      var cookies = document.cookie ? document.cookie.split('; ') : [];\n      var jar = {};\n      for (var i = 0; i < cookies.length; i++) {\n        var parts = cookies[i].split('=');\n        var value = parts.slice(1).join('=');\n\n        try {\n          var foundKey = decodeURIComponent(parts[0]);\n          jar[foundKey] = converter.read(value, foundKey);\n\n          if (key === foundKey) {\n            break\n          }\n        } catch (e) {}\n      }\n\n      return key ? jar[key] : jar\n    }\n\n    return Object.create(\n      {\n        set: set,\n        get: get,\n        remove: function (key, attributes) {\n          set(\n            key,\n            '',\n            assign({}, attributes, {\n              expires: -1\n            })\n          );\n        },\n        withAttributes: function (attributes) {\n          return init(this.converter, assign({}, this.attributes, attributes))\n        },\n        withConverter: function (converter) {\n          return init(assign({}, this.converter, converter), this.attributes)\n        }\n      },\n      {\n        attributes: { value: Object.freeze(defaultAttributes) },\n        converter: { value: Object.freeze(converter) }\n      }\n    )\n  }\n\n  var api = init(defaultConverter, { path: '/' });\n  /* eslint-enable no-var */\n\n  return api;\n\n})));\n","const geom = require('../utils/geom')\nconst physics = require('./physics')\nconst Counter = require('../utils/counter')\nconst bulletCounter = new Counter()\n\nconst BULLET_DAMAGE_MULTIPLIER = 0.115\n\nconst newBullet = () => ({\n  posX: 0, posY: 0,           // position X, Y\n  velX: 0, velY: 0,           // velocity X, Y\n  dist: 0,                    // distance taken\n  velocity: 0,\n  shooter: null,\n  shooterName: '',\n  isHit: false,\n  canPickUp: true,\n  type: 'bullet',\n  damage: 1,\n\n  dead: false,\n  _id: bulletCounter.next()\n})\n\nconst bulletFields = [\n  '_id', 'dead', 'posX', 'posY', 'velX', 'velY', 'dist', 'velocity',\n  'shooter', 'shooterName', 'isHit', 'canPickUp', 'type', 'damage'\n]\n\nconst bulletSystemFactory = handler => {\n  let bullets = {}\n\n  const getBullets = () => Object.values(bullets)\n\n  const getBulletsById = (ids) => ids.map(id => bullets[id])\n\n  const removeBullet = (bullet) => {\n    bullet.dead = true\n    delete bullets[bullet._id]\n    handler.onBulletDeleted(bullet)\n  }\n\n  const handleShipBulletCollision = (ships, ship, bullet) => {\n    if (bullet.dead) {\n      return\n    }\n    const shooter = ships.getShipById(bullet.shooter)\n    ship.health -= BULLET_DAMAGE_MULTIPLIER * ship.healthMul * bullet.damage\n    if (shooter && shooter.absorber) {\n      shooter.health += 0.01 * shooter.healthMul\n    }\n    if (ship.health <= 0) {\n      if (shooter) {\n        ++shooter.score\n      }\n      handler.killShipByBullet(ship, bullet)\n    }\n    if (bullet.type !== 'laser') {\n      removeBullet(bullet)\n    }\n  }\n\n  const handlePowerupBulletCollision = (ships, powerup, bullet, powerups) => {\n    if (bullet.dead) {\n      return\n    }\n    const shooter = ships.getShipById(bullet.shooter)\n    if (shooter) {\n      powerups.applyPowerup(shooter, powerup)\n    }\n    if (bullet.type !== 'laser') {\n      removeBullet(bullet)\n    }\n  }\n\n  const removeMinesBy = ship => {\n    const shipId = ship._id\n    const projList = getBullets()\n    const projCount = projList.length\n    for (let i = 0; i < projCount; ++i) {\n      const bullet = projList[i]\n      if (bullet.type === 'mine' && bullet.shooter === shipId) {\n        removeBullet(bullet)\n      }\n    }\n  }\n\n  const moveBullets = (delta, ships, powerups) => {\n    const shipList = ships.getShips()\n    const powerupList = powerups.getPowerups()\n    const bulletList = getBullets()\n    const shipCount = shipList.length\n    const powerupCount = powerupList.length\n    const bulletCount = bulletList.length\n\n    for (let i = 0; i < bulletCount; ++i) {\n      const bullet = bulletList[i]\n      if (bullet.dist > physics.MAX_BULLET_DISTANCE) {\n        removeBullet(bullet)\n        continue\n      }\n\n      if (bullet.type == 'bullet' || bullet.type == 'laser') {\n        physics.gravityBullet(bullet, physics.getPlanets(bullet.posX, bullet.posY))\n\n        const newX = bullet.posX + delta * bullet.velX\n        const newY = bullet.posY + delta * bullet.velY\n\n        let collisionShip = null\n        for (let j = 0; j < shipCount; ++j) {\n          const ship = shipList[j]\n          if (ship._id !== bullet.shooter\n            && Math.abs(ship.posX - bullet.posX) < bullet.velocity\n            && Math.abs(ship.posY - bullet.posY) < bullet.velocity) {\n            const [p1, p2, p3] = geom.getCollisionPoints(ship)\n            if (geom.lineIntersectsTriangle([bullet.posX, bullet.posY],\n              [newX, newY], p1, p2, p3)) {\n              collisionShip = ship\n              break\n            }\n          }\n        }\n\n        if (collisionShip) {\n          handleShipBulletCollision(ships, collisionShip, bullet)\n        }\n\n        let collisionPowerup = null\n        if (bullet.canPickUp) {\n          for (let j = 0; j < powerupCount; ++j) {\n            const powerup = powerupList[j]\n            if (Math.abs(powerup.posX - bullet.posX) < bullet.velocity &&\n                Math.abs(powerup.posY - bullet.posY) < bullet.velocity) {\n              const r = powerup.pickupRadius * 0.35\n              const a1 = [\n                powerup.posX - (bullet.posY - powerup.posY) * r,\n                powerup.posY - (powerup.posX - bullet.posX) * r\n              ]\n              const a2 = [\n                powerup.posX + (bullet.posY - powerup.posY) * r,\n                powerup.posY + (powerup.posX - bullet.posX) * r\n              ]\n              if (geom.lineIntersectsLine([bullet.posX, bullet.posY],\n                [newX, newY], a1, a2)) {\n                collisionPowerup = powerup\n                break\n              }\n            }\n          }\n        }\n\n        if (collisionPowerup) {\n          handlePowerupBulletCollision(ships, collisionPowerup, bullet, powerups)\n        }\n        \n        let hitPlanet = false\n        const planets = physics.getPlanets(newX, newY)\n        for (const planet of planets) {\n          if (Math.hypot(planet.x - newX, planet.y - newY) < planet.radius) {\n            hitPlanet = true\n            break\n          }\n        }\n\n        if (hitPlanet) {\n          removeBullet(bullet)\n          continue\n        }\n\n        bullet.posX = newX\n        bullet.posY = newY\n        bullet.dist += delta * bullet.velocity\n      } else if (bullet.type == 'mine') {\n        const r = 3 + 7 * Math.random() ** 3\n        let primerShip = null\n        \n        for (let j = 0; j < shipCount; ++j) {\n          const ship = shipList[j]\n          if (!ship.dead && bullet.shooter !== ship._id &&\n              Math.hypot(ship.posX - bullet.posX,\n                ship.posY - bullet.posY) < r) {\n            primerShip = ship\n            break\n          }\n        }\n\n        if (primerShip || bullet.isHit) {\n          // blow up the mine\n          shipList.forEach(ship => {\n            if (Math.abs(ship.posX - bullet.posX) > 15 ||\n              Math.abs(ship.posY - bullet.posY) > 15) {\n              return\n            }\n\n            let damage = 2 / Math.sqrt(Math.hypot(\n              ship.posX - bullet.posX, ship.posY - bullet.posY))\n\n            if (damage < 0.05) {\n              damage = 0\n            }\n\n            const shooter = ships.getShipById[bullet.shooter]\n            if (shooter && shooter._id !== ship._id) {\n              ship.health -= damage * ship.healthMul\n              \n              if (ship.health <= 0) {\n                if (shooter) {\n                  ++shooter.score\n                }\n                handler.killShipByBullet(ship, bullet)\n              }\n            }\n          })\n\n          handler.onMineExplode(bullet)\n          removeBullet(bullet)\n          continue\n        }\n\n        bullet.dist += physics.MAX_BULLET_DISTANCE / (physics.MINE_LIFETIME * physics.TICKS_PER_SECOND)\n      }\n    }\n  }\n\n  const addProjectile = (ship, type, extras) => {\n    const [p1, , , ] = geom.getShipPoints(ship)\n    const { \n      extraDist, \n      orientOffset, \n      speedFactor,\n      damageFactor, \n      rangeSub,\n      canPickUp } = { \n      extraDist: 0,\n      orientOffset: 0,\n      speedFactor: 1,\n      damageFactor: 1,\n      rangeSub: 0,\n      canPickUp: true,\n      ...(extras || {}) }\n\n    let typeSpeedMul = 1\n    if (type == 'mine') {\n      typeSpeedMul = 0\n    }\n\n    let bullet = newBullet()\n    bullet = {\n      ...bullet,\n      posX: p1[0] + Math.sin(-ship.orient + orientOffset) * extraDist,\n      posY: p1[1] + Math.cos(-ship.orient + orientOffset) * extraDist,\n      type: type,\n      velocity: physics.BULLET_VELOCITY * ship.bulletSpeedMul * speedFactor,\n      velX: typeSpeedMul * physics.BULLET_VELOCITY * Math.sin(-ship.orient + orientOffset) * ship.bulletSpeedMul,\n      velY: typeSpeedMul * physics.BULLET_VELOCITY * Math.cos(-ship.orient + orientOffset) * ship.bulletSpeedMul,\n      dist: rangeSub,\n      damage: damageFactor,\n      canPickUp: canPickUp,\n      shooter: ship._id,\n      shooterName: ship.name\n    }\n    bullets[bullet._id] = bullet\n    return bullet\n  }\n\n  return {\n    getBullets,\n    getBulletsById,\n    moveBullets,\n    addProjectile,\n    removeBullet,\n    removeMinesBy\n  }\n}\n\nmodule.exports = {\n  system: bulletSystemFactory,\n  fields: bulletFields,\n}\n","const GRAV = 6.67e-11\nconst TICKS_PER_SECOND = 20\nconst MS_PER_TICK = 1000 / TICKS_PER_SECOND\nconst MAX_SHIP_VELOCITY = 48 / TICKS_PER_SECOND\nconst MIN_SHIP_VELOCITY = 0.01\nconst LATCH_VELOCITY = 0.3\nconst BULLET_VELOCITY = MAX_SHIP_VELOCITY * 1.75\nconst BRAKE_MUL = (MIN_SHIP_VELOCITY / MAX_SHIP_VELOCITY) ** (1 / (TICKS_PER_SECOND * 1.5))\nconst VIEW_DISTANCE = 50\nconst MAX_BULLET_DISTANCE = 70\nconst RUBBERBAND_BUFFER = 80\nconst MINE_LIFETIME = 60\nconst INERTIA_MUL = 1\n// (MIN_SHIP_VELOCITY / MAX_SHIP_VELOCITY) ** (1 / (TICKS_PER_SECOND * 90))\n\nconst LCG = require('../utils/lcg')\nconst PLANET_CHUNK_SIZE = VIEW_DISTANCE * 1.6 + 1\nconst lcg = new LCG(0)\n\nlet PLANET_SEED = 1340985553\n\nconst getAccelMul = (accelTimeMs) => { // time in milliseconds\n  return 0.0875 + 0.000025 * accelTimeMs\n}\n\nconst onTurn = (ship, now) => {\n  if (ship.highAgility) {\n    ship.accel = now / 16 + ship.accel * 15 / 16\n  } else {\n    ship.accel = now\n  }\n}\n\nconst checkMinVelocity = (ship) => {\n  const v = Math.hypot(ship.velX, ship.velY)\n  if (v <= MIN_SHIP_VELOCITY) {\n    ship.velX = 0\n    ship.velY = 0\n  }\n}\n\nconst checkMaxVelocity = (ship) => {\n  const maxvel = MAX_SHIP_VELOCITY * healthToVelocity(ship.health) * ship.speedMul\n  const v = Math.hypot(ship.velX, ship.velY)\n  if (v > maxvel) {\n    ship.velX *= maxvel / v\n    ship.velY *= maxvel / v\n  }\n}\n\nconst getPlanetSeed = () => {\n  return PLANET_SEED\n}\n\nconst setPlanetSeed = (seed) => {\n  PLANET_SEED = seed\n}\n\nconst newPlanetSeed = () => {\n  PLANET_SEED = Math.floor(Math.random() * 2147483647)\n}\n\n// planet: x, y, radius, seed\nconst getPlanetsForChunk = (cx, cy) => {\n  const r = PLANET_CHUNK_SIZE\n  const xb = (cx + 0.5) * r\n  const yb = (cy + 0.5) * r\n\n  lcg.reseed((PLANET_SEED ^ (cx * 1173320513) ^ (cy * 891693747)) & 0xFFFFFFFF)\n  \n  const xo = lcg.randomOffset() * (r / 4)\n  const yo = lcg.randomOffset() * (r / 4)\n  const radius = (r / 20) + (r / 12) * lcg.random()\n  const seed = lcg.randomInt()\n  return [ { x: xb + xo, y: yb + yo, radius, seed } ]\n}\n\nconst getPlanets = (x, y) => {\n  const x0 = Math.floor(x / PLANET_CHUNK_SIZE)\n  const y0 = Math.floor(y / PLANET_CHUNK_SIZE)\n\n  const xu = [x0 - 2, x0 - 1, x0, x0 + 1, x0 + 2]\n  const yu = [y0 - 2, y0 - 1, y0, y0 + 1, y0 + 2]\n  let planets = []\n\n  for (const x of xu) {\n    for (const y of yu) {\n      planets = [...planets, ...getPlanetsForChunk(x, y)]\n    }\n  }\n  \n  return planets\n}\n\nconst hasOverdrive = (ship) => {\n  return ship.overdrive > 0\n}\n\nconst hasRubbership = (ship) => {\n  return ship.rubbership > 0\n}\n\nconst hasRegen = (ship) => {\n  return ship.regen > 0\n}\n\nconst accel = (ship, accelTimeMs) => {\n  let accelMul = getAccelMul(accelTimeMs) * healthToVelocity(ship.health)\n    * (hasOverdrive(ship) ? 2 : 1)\n  if (ship.speedMul !== 1) {\n    accelMul *= Math.sqrt(ship.speedMul)\n  }\n  ship.velX += accelMul * Math.sin(-ship.orient)\n  ship.velY += accelMul * Math.cos(-ship.orient)\n  checkMaxVelocity(ship)\n}\n\nconst inertia = (ship) => {\n  ship.velX *= INERTIA_MUL\n  ship.velY *= INERTIA_MUL\n  checkMinVelocity(ship)\n}\n\nconst brake = (ship) => {\n  ship.velX *= BRAKE_MUL\n  ship.velY *= BRAKE_MUL\n  checkMinVelocity(ship)\n}\n\nconst recoil = (ship) => {\n  ship.velX -= 0.017 * Math.sin(-ship.orient)\n  ship.velY -= 0.017 * Math.cos(-ship.orient)\n  checkMaxVelocity(ship)\n}\n\nconst gravityBullet = (bullet, planets) => {\n  if (bullet.type == 'mine') {\n    return\n  }\n\n  for (const planet of planets) {\n    const d = Math.hypot(bullet.posX - planet.x, bullet.posY - planet.y)\n    if (d > (planet.radius + 1) && d < 10 + planet.radius * 3) {\n      const dx = planet.x - bullet.posX\n      const dy = planet.y - bullet.posY\n      const r2 = Math.hypot(dx, dy) ** 2\n      const f = GRAV * 8e+9 / r2 * planet.radius\n      bullet.velX += f * dx\n      bullet.velY += f * dy\n    }\n  }\n  const d = Math.hypot(bullet.velX, bullet.velY)\n  bullet.velX *= bullet.velocity / d\n  bullet.velY *= bullet.velocity / d\n}\n\nconst gravityShip = (ship, planets) => {\n  for (const planet of planets) {\n    const d = Math.hypot(ship.posX - planet.x, ship.posY - planet.y)\n    const dv = Math.hypot(ship.velX, ship.velY)\n    if (d > (planet.radius + 1.5 + dv * 0.3) && d < 10 + planet.radius * 3) {\n      const dx = planet.x - ship.posX\n      const dy = planet.y - ship.posY\n      const r2 = Math.hypot(dx, dy) ** 2\n      const f = GRAV * 8e+8 * planet.radius / r2 / (\n        (ship.accel !== null || ship.brake !== null) ? 5 : 1)\n      ship.velX += f * dx\n      ship.velY += f * dy\n    }\n  }\n  checkMaxVelocity(ship)\n}\n\nconst getRubberbandRadius = (playerCount) => {\n  return 75 * Math.pow(Math.max(playerCount, 1), 0.75)\n}\n\nconst rubberband = (ship, radius) => {\n  const distCenter = Math.hypot(ship.posX, ship.posY)\n  if (distCenter > radius) {\n    const maxRadius = radius + RUBBERBAND_BUFFER\n    const baseX = -ship.posX / Math.hypot(ship.posX, ship.posY)\n    const baseY = -ship.posY / Math.hypot(ship.posX, ship.posY)\n    if (distCenter > maxRadius) {\n      ship.velX = ship.velY = 0\n    }\n    ship.velX += baseX * 0.3 * MAX_SHIP_VELOCITY *\n      (1.1 * (distCenter - radius) / (maxRadius - radius)) ** 8\n    ship.velY += baseY * 0.3 * MAX_SHIP_VELOCITY *\n      (1.1 * (distCenter - radius) / (maxRadius - radius)) ** 8\n    checkMaxVelocity(ship)\n  }\n}\n\nconst healthToVelocity = (health) => {\n  return 0.6 + 0.4 * health\n}\n\nmodule.exports = {\n  TICKS_PER_SECOND,\n  MAX_SHIP_VELOCITY,\n  MS_PER_TICK,\n  BULLET_VELOCITY,\n  LATCH_VELOCITY,\n  VIEW_DISTANCE,\n  MAX_BULLET_DISTANCE,\n  PLANET_CHUNK_SIZE,\n  RUBBERBAND_BUFFER,\n  MINE_LIFETIME,\n  hasOverdrive,\n  hasRubbership,\n  hasRegen,\n  accel,\n  inertia,\n  brake,\n  recoil,\n  onTurn,\n  gravityBullet,\n  gravityShip,\n  rubberband,\n  getPlanets,\n  getPlanetSeed,\n  setPlanetSeed,\n  newPlanetSeed,\n  getRubberbandRadius,\n  healthToVelocity }\n","const chron = require('../utils/chron')\nconst physics = require('./physics')\nconst Counter = require('../utils/counter')\nconst powerupCounter = new Counter()\n\nconst newPowerup = () => ({\n  posX: 0, posY: 0,           // position X, Y\n  despawn: chron.timeMs() + 15000,\n  pickupRadius: 3.5,\n  pickupDist: 100,\n  pickupPlayer: null,\n  \n  dead: false,\n  _id: powerupCounter.next()\n})\n\nconst powerupFields = [\n  '_id', 'dead', 'posX', 'posY', 'despawn',\n  'pickupRadius', 'pickupDist', 'pickupPlayer'\n]\n\nconst powerupSystemFactory = handler => {\n  let powerups = {}\n  let nextPowerup = null\n\n  const getPowerups = () => Object.values(powerups)\n\n  const trySpawnPowerup = (playerCount, ships, radius) => {\n    let tries = playerCount * 4\n    let count = 0\n    while (tries > 0) {\n      const r = Math.sqrt(Math.random()) * (radius + 5)\n      const theta = Math.random() * 2 * Math.PI\n\n      const x = Math.sin(theta) * r\n      const y = Math.cos(theta) * r\n      \n      const playerDist = Math.min.apply(null, ships.getShips().map(\n        ship => Math.hypot(ship.posX - x, ship.posY - y)\n      ))\n      const inPlanet = Math.min.apply(null, physics.getPlanets(x, y).map(\n        planet => Math.hypot(planet.x - x, planet.y - y) - planet.radius\n      )) <= 2\n      const tooClose = Math.min.apply(null, getPowerups().map(\n        powerup => Math.hypot(powerup.x - x, powerup.y - y) - 4\n      )) <= 0\n\n      if (Math.random() < 0.2 && playerDist >= 30 && !inPlanet && !tooClose) {\n        let powerup = newPowerup()\n        powerup = {\n          ...powerup,\n          posX: x,\n          posY: y\n        }\n        powerups[powerup._id] = powerup\n        handler.onPowerupSpawned(powerup)\n        ++count\n      }\n      --tries\n    }\n    return count\n  }\n\n  const setNextPowerupTime = (ships, division) => {\n    const playerCount = Math.max(1, ships.getShipCount())\n    nextPowerup = chron.timeMs() + (1000 * (10 + 18 * Math.random()) / Math.pow(playerCount, 0.125) / division)\n  }\n\n  const maybeSpawnPowerup = (ships, radius) => {\n    const playerCount = Math.max(1, ships.getShipCount())\n    let division = 1\n    if (nextPowerup != null && chron.timeMs() >= nextPowerup) {\n      division = trySpawnPowerup(playerCount, ships, radius) > 0 ? 1 : 8\n      setNextPowerupTime(ships, division)\n    } else if (nextPowerup == null) {\n      setNextPowerupTime(ships, division)\n    }\n  }\n\n  const applyPowerup = (ship, powerup) => {\n    const ITEM_COUNT = 9\n    const item = 0 | (ITEM_COUNT * Math.random())\n    switch (item) {\n    case 0:\n      if (ship.item === null) {\n        ship.item = 'laser'\n      }\n      break\n    case 1:\n      if (ship.item === null) {\n        ship.item = 'reheal'\n      }\n      break\n    case 2:\n      if (ship.item === null) {\n        ship.item = 'bomb'\n      }\n      break\n    case 3:\n      if (ship.item === null) {\n        ship.item = 'mine'\n      }\n      break\n    case 4:\n      if (ship.item === null) {\n        ship.item = 'orion'\n      }\n      break\n    case 5:\n      ship.rubbership = 30 * 1000\n      break\n    case 6:\n      ship.regen = 10 * 1000\n      break\n    case 7:\n      ship.overdrive = 10 * 1000\n      break\n    case 8:\n      if (ship.item === null) {\n        ship.item = 'spread'\n      }\n      break\n    }\n    removePowerup(powerup)\n  }\n\n  const updateClosestPlayer = (powerup, ship, t) => {\n    if (powerup.pickupDist > t) {\n      powerups[powerup._id].pickupDist = t\n      powerups[powerup._id].pickupPlayer = ship._id\n    }\n  }\n\n  const removePowerup = (powerup) => {\n    delete powerups[powerup._id]\n    handler.onPowerupDeleted(powerup)\n  }\n\n  const updatePowerups = (ships) => {\n    const now = chron.timeMs()\n    getPowerups().forEach((powerup) => {\n      if (now >= powerup.despawn) {\n        removePowerup(powerup)\n        return\n      }\n\n      if (powerup.pickupPlayer !== null) {\n        const ship = ships.getShipById(powerup.pickupPlayer)\n        if (ship !== null && !ship.dead) {\n          applyPowerup(ship, powerup)\n          return\n        } else {\n          powerup.pickupDist = 10000\n          powerup.pickupPlayer = null\n        }\n      }\n    })\n  }\n\n  return {\n    getPowerups,\n    applyPowerup,\n    updateClosestPlayer,\n    maybeSpawnPowerup,\n    removePowerup,\n    updatePowerups\n  }\n}\n\nmodule.exports = {\n  system: powerupSystemFactory,\n  fields: powerupFields,\n}\n","const geom = require('../utils/geom')\nconst chron = require('../utils/chron')\nconst physics = require('./physics')\nconst maths = require('../utils/maths')\nconst Counter = require('../utils/counter')\nconst shipCounter = new Counter()\n\nconst newShip = () => ({\n  posX: 0, posY: 0,           // position X, Y\n  velX: 0, velY: 0,           // velocity X, Y\n  orient: 0,                  // radians, clockwise from 0 = up\n  health: 1,                  // 0 = no health, 1 = max health\n\n  name: '',\n  score: 0,\n  accel: null,\n  brake: null,\n  firing: false,\n  latched: false,\n  fireWaitTicks: 0,\n\n  // perks\n  firingInterval: 4,\n  bulletSpeedMul: 1.0,\n  healthMul: 1.0,\n  speedMul: 1.0,\n  planetDamageMul: 1.0,\n  highAgility: false,\n  absorber: false,\n  healRate: 1,\n\n  // powerups\n  item: null,\n  rubbership: 0,\n  regen: 0,\n  overdrive: 0,\n\n  dead: false,\n  _id: shipCounter.next()\n})\n\nconst shipFields = [\n  '_id', 'dead', 'posX', 'posY', 'velX', 'velY', 'orient', 'health',\n  'name', 'score', 'accel', 'brake', 'firing', 'latched', 'fireWaitTicks',\n  'firingInterval', 'bulletSpeedMul', 'healthMul', 'speedMul', 'planetDamageMul',\n  'highAgility', 'absorber', 'healRate', 'item', 'rubbership', 'regen', 'overdrive'\n]\n\nconst shipSystemFactory = handler => {\n  let ships = {}\n\n  const getShips = () => Object.values(ships)\n  const getShipById = id => ships[id]\n  const getShipCount = () => Object.keys(ships).length\n  const removeShipById = id => delete ships[id]\n\n  const newPlayerShip = (radius, bullets) => {\n    const ship = newShip()\n    spawn(ship, radius, bullets)\n    ships[ship._id] = ship\n    return ship\n  }\n\n  const latchToPlanet = (ship, planet) => {\n    const planetAngle = Math.atan2(planet.x - ship.posX,\n      planet.y - ship.posY) + Math.PI\n    latchToPlanetWithAngle(ship, planet, planetAngle)\n  }\n\n  const computePlanetPoint = (planet, angle) => {\n    return [planet.x + (planet.radius + 1.4) * Math.sin(angle),\n      planet.y + (planet.radius + 1.4) * Math.cos(angle)]\n  }\n\n  const latchToPlanetWithAngle = (ship, planet, angle) => {\n    const [x, y] = computePlanetPoint(planet, angle)\n    ship.velX = 0\n    ship.velY = 0\n    ship.posX = x\n    ship.posY = y\n    ship.orient = -angle\n    ship.latched = ship.accel === null\n    handler.onShipLatch(ship)\n  }\n\n  const spawnLone = (ship, radius) => {\n    let baseX = physics.VIEW_DISTANCE * maths.randomSign() * Math.random()\n    let baseY = physics.VIEW_DISTANCE * maths.randomSign() * Math.random()\n    \n    let planets = physics.getPlanets(baseX, baseY)\n    planets = planets.filter(planet =>\n      Math.hypot(planet.x, planet.y) < radius - planet.radius)\n    if (planets.length < 1) {\n      ship.posX = baseX\n      ship.posY = baseY\n      ship.orient = 0\n      return\n    }\n\n    const planet = planets[0 | (planets.length * Math.random())]\n    latchToPlanetWithAngle(ship, planet, Math.random() * 2 * Math.PI)\n  }\n\n  const spawn = (ship, radius, bullets) => {\n    const playerKeys = Object.keys(ships)\n    const playerCount = playerKeys.length\n    let baseX = 0\n    let baseY = 0\n    if (playerCount < 1) {\n      return spawnLone(ship, radius)\n    }\n\n    let tries = 64\n    \n    while (--tries > 0) {\n      const randShip = ships[playerKeys[(playerCount * Math.random()) | 0]]\n      baseX = randShip.posX\n      baseY = randShip.posY\n      baseX += physics.VIEW_DISTANCE * maths.randomSign()\n      baseY += physics.VIEW_DISTANCE * maths.randomSign()\n      if (Math.hypot(baseX, baseY) < radius - physics.PLANET_CHUNK_SIZE / 8) {\n        break\n      }\n      if (tries < 8) {\n        if (Math.hypot(baseX, baseY) < radius) {\n          break\n        }\n      }\n    }\n\n    let planets = physics.getPlanets(baseX, baseY)\n    planets = planets.filter(planet =>\n      Math.hypot(planet.x, planet.y) < radius - (planet.radius - 3))\n    if (planets.length < 1) {\n      ship.posX = baseX + physics.VIEW_DISTANCE * maths.randomSign()\n      ship.posY = baseY + physics.VIEW_DISTANCE * maths.randomSign()\n      ship.orient = 0\n      return\n    }\n    \n    planets.forEach(planet => {\n      planet.playerDist = Math.min.call(null, \n        getShips().map(ship => \n          Math.hypot(ship.posX - planet.x, ship.posY - planet.y)))\n      planet.bulletDist = Math.min.call(null, \n        bullets.getBullets().map(bullet => \n          Math.hypot(bullet.posX - planet.x, bullet.posY - planet.y)))\n    })\n\n    const ideal = planets.find(planet => \n      planet.playerDist > physics.VIEW_DISTANCE \n      && planet.bulletDist > physics.MAX_BULLET_DISTANCE)\n\n    if (ideal) {\n      latchToPlanetWithAngle(ship, ideal, Math.random() * 2 * Math.PI)\n      return\n    }\n\n    const testPlanet = (a, b) => (\n      a.playerDist + a.bulletDist * 1.5 > b.playerDist + b.bulletDist * 1.5\n    )\n    const mostIdeal = planets.reduce((a, b) => \n      (testPlanet(a, b) ? a : b)\n    )\n\n    // pick optimal angle\n    const angleOffset = Math.random() * 2 * Math.PI\n    let minimalScore = 0\n    let angle = 0\n    for (let i = 0; i < 8; ++i) {\n      const testAngle = angleOffset + i * Math.PI / 4\n      const [x, y] = computePlanetPoint(mostIdeal, testAngle)\n      const score = Math.min.call(null, \n        getShips().map(ship => \n          Math.hypot(ship.posX - x, ship.posY - y)))\n        + Math.min.call(null, \n          bullets.getBullets().map(bullet => \n            Math.hypot(bullet.posX - x, bullet.posY - y)))\n      if (minimalScore < score) {\n        minimalScore = score\n        angle = testAngle\n      }\n    }\n\n    latchToPlanetWithAngle(ship, mostIdeal, angle)\n  }\n\n  const doFire = (ship) => {\n    if (!ship || ship.dead !== false) {\n      return false\n    }\n\n    if (ship.fireWaitTicks <= 0) {\n      handler.addProjectile(ship, 'bullet')\n      ship.fireWaitTicks = ship.firingInterval\n      return true\n    }\n    return false\n  }\n\n  const shipAcceleration = (delta, radius, radiusGoal) => {\n    const now = chron.timeMs()\n    const shipList = getShips()\n    for (let i = 0, shipCount = shipList.length; i < shipCount; ++i) {\n      const ship = shipList[i]\n      let doAccel = false\n      let doBrake = false\n  \n      if (ship.accel != null && ship.brake != null) {\n        if (ship.accel > ship.brake) {\n          doAccel = true\n        } else {\n          doBrake = true\n        }\n      } else if (ship.accel != null) {\n        doAccel = true\n      } else if (ship.brake != null) {\n        doBrake = true\n      }\n  \n      if (doAccel) {\n        physics.accel(ship, now - ship.accel)\n        ship.latched = false\n      } else if (doBrake) {\n        physics.brake(ship)\n      }\n      if (ship.firing) {\n        if (doFire(ship) && !ship.latched) {\n          physics.recoil(ship)\n        }\n      }\n  \n      physics.inertia(ship)\n      if (!ship.latched) {\n        physics.rubberband(ship, radius)\n      } else {\n        ship.velX = ship.velY = 0\n        if (Math.hypot(ship.posX, ship.posY) > (radius + 10) \n          && radiusGoal < radius) {\n          ship.latched = false\n          ship.velX += Math.sin(-ship.orient)\n          ship.velY += Math.cos(-ship.orient)\n        }\n      }\n      if (ship.latched && ship.health < 1) {\n        ship.health = Math.min(1, ship.health + ship.healthMul * ship.healRate * 1 / (20 * physics.TICKS_PER_SECOND))\n      }\n      if (physics.hasRegen(ship)) {\n        ship.health = Math.min(1, ship.health + ship.healthMul * ship.healRate * 1.5 / (20 * physics.TICKS_PER_SECOND))\n      }\n      ship.fireWaitTicks = Math.max(0, ship.fireWaitTicks - (physics.hasOverdrive(ship) ? 2 : 1))\n      ship.regen = Math.max(0, ship.regen - physics.MS_PER_TICK)\n      ship.overdrive = Math.max(0, ship.overdrive - physics.MS_PER_TICK)\n      ship.rubbership = Math.max(0, ship.rubbership - physics.MS_PER_TICK)\n      \n      if (!ship.latched) {\n        physics.gravityShip(ship, physics.getPlanets(ship.posX, ship.posY))\n      }\n    }\n  }\n\n  const moveShips = (delta, powerups) => {\n    const shipList = getShips()\n    const powerupList = powerups.getPowerups()\n    const shipCount = shipList.length\n    const powerupCount = powerupList.length\n    const dist = physics.MAX_SHIP_VELOCITY + 1\n\n    for (let i = 0; i < shipCount; ++i) {\n      const ship1 = shipList[i]\n      ship1.posXnew = ship1.posX + delta * ship1.velX\n      ship1.posYnew = ship1.posY + delta * ship1.velY\n\n      for (let j = 0; j < powerupCount; ++j) {\n        const pup = powerupList[j]\n        if (Math.abs(ship1.posX - pup.posX) < 3\n          && Math.abs(ship1.posY - pup.posY) < 3) {\n          const t = geom.lineIntersectCircleFirstDepth(\n            [ship1.posX, ship1.posY],\n            [ship1.posXnew, ship1.posYnew],\n            pup.posX, pup.posY, pup.pickupRadius)\n          if (0 <= t && t <= 1) {\n            powerups.updateClosestPlayer(pup, ship1, t)\n          }\n        }\n      }\n\n      for (let j = 0; j < shipCount; ++j) {\n        const ship2 = shipList[j]\n        if (i == j || ship1.dead || ship2.dead) {\n          continue\n        }\n\n        if (Math.abs(ship1.posX - ship2.posX) < dist &&\n          Math.abs(ship1.posY - ship2.posY) < dist) {\n          const t = geom.closestSynchroDistance(\n            [ship1.posX, ship1.posY],\n            [ship1.posXnew, ship1.posYnew],\n            [ship2.posX, ship2.posY],\n            [ship2.posXnew, ship2.posYnew])\n          if (0 <= t && t <= delta) {\n            ship1.posX = ship1.posX + t * ship1.velX\n            ship1.posY = ship1.posY + t * ship1.velY\n            ship2.posX = ship2.posX + t * ship2.velX\n            ship2.posY = ship2.posY + t * ship2.velY\n            testShipShipCollision(ship1, ship2)\n          }\n        }\n      }\n    }\n\n    for (let i = 0; i < shipCount; ++i) {\n      const ship = shipList[i]\n      ship.posX = ship.posXnew\n      ship.posY = ship.posYnew\n    }\n  }\n\n  const handleShipShipCollision = (ship1, ship2) => {\n    const dx = ship1.velX - ship2.velX\n    const dy = ship1.velY - ship2.velY\n    const damage = 0.4 * Math.sqrt(Math.hypot(dx, dy))\n      / (physics.MAX_SHIP_VELOCITY / 4)\n    const dmg1 = damage * (physics.hasRubbership(ship1) ? 0.5 : 1)\n    const dmg2 = damage * (physics.hasRubbership(ship2) ? 0.5 : 1)\n\n    if (dmg1 >= 0.1) {\n      ship1.health -= dmg1 * ship1.healthMul\n    }\n\n    if (dmg2 >= 0.1) {\n      ship2.health -= dmg2 * ship2.healthMul\n    }\n\n    // elastic collision\n    [ship1.velX, ship2.velX] = [ship2.velX, ship1.velX];\n    [ship1.velY, ship2.velY] = [ship2.velY, ship1.velY]\n    \n    if (ship1.health <= 0) {\n      if (ship2.health > 0 && \n        Math.hypot(ship2.velX, ship2.velY)\n        > Math.hypot(ship1.velX, ship1.velY)) {\n        ++ship2.score\n      }\n      handler.onShipKilledByCrash(ship1, ship2)\n      killShip(ship1)\n    }\n\n    if (ship2.health <= 0) {\n      if (ship1.health > 0 && \n        Math.hypot(ship1.velX, ship1.velY)\n        > Math.hypot(ship2.velX, ship2.velY)) {\n        ++ship1.score\n      }\n      handler.onShipKilledByCrash(ship2, ship1)\n      killShip(ship2)\n    }\n  }\n\n  const testShipShipCollision = (ship1, ship2) => {\n    const [p1, p2, p3] = geom.getCollisionPoints(ship1)\n    if (Math.abs(ship1.posX - ship2.posX) < 2 &&\n        Math.abs(ship1.posY - ship2.posY) < 2) {\n      const [q1, q2,   , q4] = geom.getShipPoints(ship2)\n      if (geom.pointInTriangle(q1, q2, q4, p1)\n        || geom.pointInTriangle(q1, q2, q4, p2)\n        || geom.pointInTriangle(q1, q2, q4, p3)) {\n        handleShipShipCollision(ship1, ship2)\n      }\n    }\n  }\n\n  const handleShipPlanetCollision = (ship, planet) => {\n    const v = Math.hypot(ship.velX, ship.velY)\n    const playerAngle = Math.atan2(ship.velX, ship.velY)\n    const planetAngle = Math.atan2(planet.x - ship.posX,\n      planet.y - ship.posY)\n    const diffAngle = playerAngle - planetAngle + Math.PI\n    const col_mul = geom.getPlanetAngleMultiplier(ship.orient, playerAngle)\n    const col_vel = (physics.MAX_SHIP_VELOCITY / 1.5) * col_mul\n    let damage = v / col_vel * ship.planetDamageMul \n      * (physics.hasRubbership(ship) ? 0 : 1)\n\n    if (!ship.accel \n      && v > 0 \n      && v < physics.LATCH_VELOCITY * (ship.brake !== null ? 1.5 : 1)) {\n      latchToPlanet(ship, planet)\n      return\n    }\n\n    const dist = Math.hypot(ship.posX - planet.x, ship.posY - planet.y)\n    if (dist < (planet.radius - 1.5)) {\n      ship.posX = planet.x + (ship.posX - planet.x) / ((planet.radius + 2) / dist)\n      ship.posY = planet.y + (ship.posY - planet.y) / ((planet.radius + 2) / dist)\n    }\n\n    if (col_mul < 1.2 && ship.accel !== null) {\n      damage *= 0.2\n    }\n\n    if (damage > 0.05) {\n      ship.health -= damage * ship.healthMul\n    }\n\n    if (ship.health <= 0) {\n      handler.onShipKilledByPlanet(ship)\n      killShip(ship)\n      return\n    }\n\n    ship.velX = v * Math.sin(diffAngle)\n    ship.velY = v * Math.cos(diffAngle)\n    ship.posX += (v / 8) * (ship.posX - planet.x)\n    ship.posY += (v / 8) * (ship.posY - planet.y)\n\n    if (!physics.hasRubbership(ship) && damage < 0.4 && col_mul < 1.7) {\n      latchToPlanet(ship, planet)\n    }\n  }\n\n  const findShipPlanetCollisions = () => {\n    getShips().forEach(ship => {\n      const planets = physics.getPlanets(ship.posX, ship.posY)\n      for (const planet of planets)  {\n        const search = planet.radius + 1.35\n        if (Math.abs(ship.posX - planet.x) < search \n          && Math.abs(ship.posY - planet.y) < search) {\n          if (Math.hypot(ship.posX - planet.x, ship.posY - planet.y) \n            < search) {\n            if (!ship.dead) {\n              handleShipPlanetCollision(ship, planet)\n            }\n            break\n          }\n        }\n      }\n    })\n  }\n\n  const deleteShip = (ship) => {\n    ship.dead = true\n    removeShipById(ship._id)\n  }\n\n  const killShip = (ship) => {\n    deleteShip(ship)\n    handler.onShipKilled(ship)\n  }\n\n  return {\n    getShips,\n    getShipById,\n    getShipCount,\n    removeShipById,\n    newPlayerShip,\n    moveShips,\n    killShip,\n    deleteShip,\n    findShipPlanetCollisions,\n    shipAcceleration\n  }\n}\n\nmodule.exports = {\n  system: shipSystemFactory,\n  fields: shipFields,\n}\n","const timeMs = () => new Date().getTime()\n\nmodule.exports = { timeMs }\n","class Counter {\n  constructor() {\n    this.counter = BigInt(0)\n  }\n\n  next() {\n    const val = this.counter.toString(16).padStart(16, '0')\n    this.counter = BigInt.asUintN(64, this.counter + BigInt(1))\n    return val\n  }\n}\n\nmodule.exports = Counter\n","const pointInTriangle = (p1, p2, p3, p) => {\n  const [x1, y1] = p1\n  const [x2, y2] = p2\n  const [x3, y3] = p3\n  const [xp, yp] = p\n\n  const c1 = ((y2 - y3) * (xp - x3) + (x3 - x2) * (yp - y3)) \n           / ((y2 - y3) * (x1 - x3) + (x3 - x2) * (y1 - y3))\n  const c2 = ((y3 - y1) * (xp - x3) + (x1 - x3) * (yp - y3)) \n           / ((y2 - y3) * (x1 - x3) + (x3 - x2) * (y1 - y3))\n  const c3 = 1 - c1 - c2\n  return c1 > 0 && c2 > 0 && c3 > 0\n}\n\nconst getDirectionSign = (a, b) => {\n  let s = Math.sign(b[0] - a[0])\n  if (s == 0) {\n    s = Math.sign(b[1] - a[1])\n  }\n  return s\n}\n\nconst collinearLinesIntersect = (a1, a2, b1, b2) => {\n  let a = 0\n  let b = ((a2[0] - a1[0]) * (a2[0] - a1[0]) \n    + (a2[1] - a1[1]) * (a2[1] - a1[1])) * getDirectionSign(a2, a1)\n  let c = ((b1[0] - a1[0]) * (b1[0] - a1[0]) \n    + (b1[1] - a1[1]) * (b1[1] - a1[1])) * getDirectionSign(b1, a1)\n  let d = ((b2[0] - a1[0]) * (b2[0] - a1[0]) \n    + (b2[1] - a1[1]) * (b2[1] - a1[1])) * getDirectionSign(b2, a1)\n  \n  if (a >= b) [a, b] = [b, a]\n  if (c >= d) [c, d] = [d, c]\n  \n  return b >= c && d >= a\n}\n\nconst lineIntersectsLine = (a1, a2, b1, b2) => {\n  const d = 1 / \n    (((a2[0] - a1[0]) * (b2[1] - b1[1])) \n    - ((a2[1] - a1[1]) * (b2[0] - b1[0])))\n  if (!isFinite(d)) { // collinear\n    return collinearLinesIntersect(a1, a2, b1, b2)\n  }\n\n  const n = d * \n    (((a1[1] - b1[1]) * (b2[0] - b1[0])) \n    - ((a1[0] - b1[0]) * (b2[1] - b1[1])))\n  const m = d * \n    (((a1[1] - b1[1]) * (a2[0] - a1[0])) \n    - ((a1[0] - b1[0]) * (a2[1] - a1[1])))\n\n  return 0 <= n && n <= 1 && 0 <= m && m <= 1\n}\n\nconst lineIntersectsTriangle = (l1, l2, t1, t2, t3) => {\n  return lineIntersectsLine(l1, l2, t1, t2)\n    || lineIntersectsLine(l1, l2, t2, t3)\n    || lineIntersectsLine(l1, l2, t3, t1)\n}\n\nconst lineIntersectCircleFirstDepth = (a1, a2, x, y, radius) => {\n  for (let i = 0; i <= 8; ++i) {\n    const s = i / 8\n    if (Math.hypot(a1[0] + s * a2[0] - x, a1[1] + s * a2[1] - y) < radius) {\n      return s\n    }\n  }\n  return Number.NaN\n}\n\nconst closestSynchroDistance = (a1, a2, b1, b2) => {\n  const A = a1[0] - b1[0]\n  const B = (a2[0] - a1[0]) - (b2[0] - b1[0])\n  const C = a1[1] - b1[1]\n  const D = (a2[1] - a1[1]) - (b2[1] - b1[1])\n  if (B == 0 && D == 0) {\n    return 0\n  }\n  return -(A * B + C * D) / (B * B + D * D)\n}\n\nconst wrapRadianAngle = (angle) => {\n  return (angle + Math.PI) % (2 * Math.PI) - Math.PI\n}\n\nconst getPlanetAngleMultiplier = (orient, vel) => {\n  let diff = Math.abs((orient - vel + Math.PI) % (2 * Math.PI))\n  if (Math.abs(diff) > Math.PI) {\n    diff = (2 * Math.PI) - Math.PI\n  }\n  const sc = diff / Math.PI\n  return 1 + sc\n}\n\nconst withinBoundingSquare = (x, y, center, d) => {\n  return Math.min(Math.abs(x - center), Math.abs(y - center)) <= d\n}\n\nconst rotatePoint = (s, c, x, y) => [x * c - y * s, x * s + y * c]\n\nconst rotatePointOffset = (s, c, x, y, xo, yo) => \n  [xo + x * c - y * s, yo + x * s + y * c]\n\nconst getShipPoints = (ship) => {\n  if (!ship) {\n    return []\n  }\n\n  const s = Math.sin(ship.orient)\n  const c = Math.cos(ship.orient)\n\n  return [\n    rotatePointOffset(s, c,  0   , +2   , ship.posX, ship.posY),\n    rotatePointOffset(s, c, +1.5 , -2   , ship.posX, ship.posY),\n    rotatePointOffset(s, c,  0   , -1.25, ship.posX, ship.posY),\n    rotatePointOffset(s, c, -1.5 , -2   , ship.posX, ship.posY)\n  ]\n}\n\nconst getCollisionPoints = (ship) => {\n  if (!ship) {\n    return []\n  }\n\n  const s = Math.sin(ship.orient)\n  const c = Math.cos(ship.orient)\n  \n  return [\n    rotatePointOffset(s, c,  0   , +2.6, ship.posX, ship.posY),\n    rotatePointOffset(s, c, +1.87, -2.6, ship.posX, ship.posY),\n    rotatePointOffset(s, c, -1.87, -2.6, ship.posX, ship.posY)\n  ]\n}\n\nconst getThrusterPoints = (ship) => {\n  if (!ship) {\n    return []\n  }\n\n  const s = Math.sin(ship.orient)\n  const c = Math.cos(ship.orient)\n\n  return [\n    rotatePointOffset(s, c,  0   , -1.25, ship.posX, ship.posY),\n    rotatePointOffset(s, c, +0.75, -1.75, ship.posX, ship.posY),\n    rotatePointOffset(s, c,  0   , -3.75, ship.posX, ship.posY),\n    rotatePointOffset(s, c, -0.75, -1.75, ship.posX, ship.posY),\n    rotatePointOffset(s, c,  0   , -2.75, ship.posX, ship.posY),\n  ]\n}\n\nmodule.exports = { \n  pointInTriangle,\n  rotatePoint,\n  lineIntersectsLine,\n  lineIntersectCircleFirstDepth,\n  closestSynchroDistance,\n  lineIntersectsTriangle,\n  wrapRadianAngle,\n  withinBoundingSquare,\n  getPlanetAngleMultiplier,\n  getShipPoints,\n  getCollisionPoints,\n  getThrusterPoints }\n","const LCG_A = 535426113\nconst LCG_C = 2258250855\nconst SC = 2.0 ** -30\n\nclass Generator {\n  constructor(seed) {\n    this.seed = seed & 0xFFFFFFFF\n  }\n\n  reseed(seed) {\n    this.seed = seed & 0xFFFFFFFF\n  }\n\n  randomInt() {\n    const val = this.seed\n    this.seed = (LCG_A * val + LCG_C) & 0xFFFFFFFF\n    return val\n  }\n\n  random() {\n    return (this.randomInt() & 0x3FFFFFFF) * SC\n  }\n\n  randomOffset() {\n    return 2 * this.random() - 1\n  }\n\n  randomSign() {\n    return 2 * (this.randomInt() & 1) - 1\n  }\n}\n\nmodule.exports = Generator\n","\nconst randomSign = () => {\n  return 2 * ((2 * Math.random()) | 0) - 1\n}\n\nmodule.exports = {\n  randomSign }\n","const shipFields = require('../game/ship').fields\nconst bulletFields = require('../game/bullet').fields\nconst powerupFields = require('../game/powerup').fields\n\nconst serializeFrom = (object, fields) => fields.map(field => object[field])\nconst deserializeFrom = (array, fields) => {\n  const object = {}\n  for (let i = 0; i < array.length; ++i) {\n    object[fields[i]] = array[i]\n  }\n  return object\n}\n\nconst serializeBullet = (obj) => serializeFrom(obj, bulletFields)\nconst deserializeBullet = (arr) => deserializeFrom(arr, bulletFields)\n\nconst serializePowerup = (obj) => serializeFrom(obj, powerupFields)\nconst deserializePowerup = (arr) => deserializeFrom(arr, powerupFields)\n\nconst serializeShip = (obj) => serializeFrom(obj, shipFields)\nconst deserializeShip = (arr) => deserializeFrom(arr, shipFields)\n\n/*const encode = (data) => pson.encode(data)\nconst decode = (data) => pson.decode(data)\nconst recv = (data) => ByteBuffer.wrap(data)\nconst send = (ws, data) => ws.send(data.buffer)*/\n\n/*\nconst encode = (data) => JSON.stringify(data)\nconst decode = (data) => JSON.parse(data)\nconst recv = (data) => data\nconst send = (ws, data) => ws.send(data)\n*/\n\nconst C_ping = 0\nconst C_join = 1\nconst C_ctrl = 2\nconst C_quit = 3\nconst C_useitem = 4\n\nconst C_pong = 128\nconst C_token = 129\nconst C_data = 130\nconst C_board = 131\nconst C_killship = 132\nconst C_killproj = 133\nconst C_orient = 134\nconst C_unauth = 135\nconst C_addpup = 136\nconst C_delpup = 137\nconst C_minexpl = 138\nconst C_deathk = 139\nconst C_deathc = 140\nconst C_deathp = 141\n\nconst C_crashed = 192\nconst C_killed = 193\nconst C_hitpl = 194\n\nconst keyDictionary = {\n  'cmd': 0,\n  'token': 1,\n  'you': 2,\n  'ships': 3,\n  'projs': 4,\n  'count': 5,\n  'rubber': 6,\n  'seed': 7,\n  'board': 8,\n  'ship': 9,\n  'proj': 10,\n  'orient': 11,\n  'nick': 12,\n  'perk': 13,\n  'time': 14,\n  'angle': 15,\n  'accel': 16,\n  'brake': 17,\n  'firing': 18,\n  'powerup': 19,\n  'by': 20,\n}\n\nconst reverseKeyDictionary = {}\nfor (const key of Object.keys(keyDictionary)) {\n  reverseKeyDictionary[keyDictionary[key]] = key\n}\n\nconst encodeKeys = (data) => {\n  const result = {}\n  for (const key of Object.keys(data)) {\n    const encoded = keyDictionary[key]\n    if (encoded === undefined)\n      result[key] = data[key]\n    else\n      result[encoded] = data[key]\n  }\n  return result\n}\n\nconst decodeKeys = (data) => {\n  const result = {}\n  for (const key of Object.keys(data)) {\n    const decoded = reverseKeyDictionary[key]\n    if (decoded === undefined)\n      result[key] = data[key]\n    else\n      result[decoded] = data[key]\n  }\n  return result\n}\n\nconst encode = (data) => JSON.stringify(encodeKeys(data))\nconst decode = (data) => decodeKeys(JSON.parse(data))\nconst recv = (data) => data\nconst send = (ws, data) => ws.send(data)\n\n// token: string\nconst e_token = (token) => encode({ cmd: C_token, token: token })\n// ship: Ship, nearbyShips: Ship[], addBullets: Bullet[],\n// playerCount: number, rubberRadius: number, planetSeed: number\nconst e_data = \n  (ship, nearbyShips, addBullets, playerCount, rubberRadius, planetSeed) => \n    encode({ cmd: C_data, you: serializeShip(ship),\n      ships: nearbyShips.map(serializeShip),\n      projs: addBullets.map(serializeBullet),\n      count: playerCount, rubber: rubberRadius, seed: planetSeed })\nconst e_unauth = () => encode({ cmd: C_unauth })\n// board: [[name, score], ...]\nconst e_board = (b) => encode({ cmd: C_board, board: b })\n// shipId: string\nconst e_killship = (shipId) => encode({ cmd: C_killship, ship: shipId })\n// projId: string\nconst e_killproj = (projId) => encode({ cmd: C_killproj, proj: projId })\n// name: string\nconst e_crashed = (name) => encode({ cmd: C_crashed, ship: name })\n// name: string\nconst e_killed = (name) => encode({ cmd: C_killed, ship: name })\n// orient: number\nconst e_orient = (orient) => encode({ cmd: C_orient, orient: orient })\nconst e_hitpl = () => encode({ cmd: C_hitpl })\n// join: string, perk: string\nconst e_join = (nick, perk) => encode({ cmd: C_join, nick: nick, perk: perk })\n// time: number\nconst e_ping = (time) => encode({ cmd: C_ping, time: time })\n// time: number\nconst e_pong = (time) => encode({ cmd: C_pong, time: time })\n// token: string\nconst e_quit = (token) => encode({ cmd: C_quit, token: token })\n// token: string, orient: number, accel: boolean, brake: boolean, firing: boolean\nconst e_ctrl = (token, orient, accel, brake, firing) => encode({\n  cmd: C_ctrl, token: token, angle: orient, \n  accel: accel, brake: brake, firing: firing })\n// powerup: Powerup\nconst e_addpup = (powerup) => encode({ cmd: C_addpup, powerup: serializePowerup(powerup) })\n// id: string\nconst e_delpup = (id) => encode({ cmd: C_delpup, powerup: id })\n// token: string\nconst e_useitem = (token) => encode({ cmd: C_useitem, token: token })\n// mine: Bullet\nconst e_minexpl = (mine) => encode({ cmd: C_minexpl, proj: serializeBullet(mine) })\n// ship: string, by: string\nconst e_deathk = (ship, by) => encode({ cmd: C_deathk, ship, by })\n// ship: string, by: string\nconst e_deathc = (ship, by) => encode({ cmd: C_deathc, ship, by })\n// ship: string, by: string\nconst e_deathp = (ship) => encode({ cmd: C_deathp, ship })\n\nconst is_ctrl = (obj) => obj.cmd === C_ctrl\nconst is_join = (obj) => obj.cmd === C_join\nconst is_ping = (obj) => obj.cmd === C_ping\nconst is_pong = (obj) => obj.cmd === C_pong\nconst is_quit = (obj) => obj.cmd === C_quit\nconst is_token = (obj) => obj.cmd === C_token\nconst is_data = (obj) => obj.cmd === C_data\nconst is_board = (obj) => obj.cmd === C_board\nconst is_killship = (obj) => obj.cmd === C_killship\nconst is_killproj = (obj) => obj.cmd === C_killproj\nconst is_crashed = (obj) => obj.cmd == C_crashed\nconst is_killed = (obj) => obj.cmd == C_killed\nconst is_hitpl = (obj) => obj.cmd == C_hitpl\nconst is_orient = (obj) => obj.cmd == C_orient\nconst is_unauth = (obj) => obj.cmd == C_unauth\nconst is_addpup = (obj) => obj.cmd == C_addpup\nconst is_delpup = (obj) => obj.cmd == C_delpup\nconst is_useitem = (obj) => obj.cmd == C_useitem\nconst is_minexpl = (obj) => obj.cmd == C_minexpl\nconst is_deathk = (obj) => obj.cmd == C_deathk\nconst is_deathc = (obj) => obj.cmd == C_deathc\nconst is_deathp = (obj) => obj.cmd == C_deathp\n\nmodule.exports = {\n  encode,\n  decode,\n  recv,\n  send,\n\n  e_token,\n  e_data,\n  e_unauth,\n  e_board,\n  e_killship,\n  e_killproj,\n  e_crashed,\n  e_killed,\n  e_orient,\n  e_hitpl,\n  e_join,\n  e_ping,\n  e_pong,\n  e_ctrl,\n  e_quit,\n  e_addpup,\n  e_delpup,\n  e_useitem,\n  e_minexpl,\n  e_deathk,\n  e_deathc,\n  e_deathp,\n\n  is_ctrl,\n  is_join,\n  is_ping,\n  is_pong,\n  is_quit,\n  is_token,\n  is_data,\n  is_board,\n  is_killship,\n  is_killproj,\n  is_crashed,\n  is_killed,\n  is_hitpl,\n  is_orient,\n  is_unauth,\n  is_addpup,\n  is_delpup,\n  is_useitem,\n  is_minexpl,\n  is_deathk,\n  is_deathc,\n  is_deathp,\n\n  serializeFrom,\n  deserializeFrom,\n\n  deserializeShip,\n  deserializeBullet,\n  deserializePowerup\n}\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","const Cookies = require('js-cookie')\nconst serial = require('../src/utils/serial')\nconst physics = require('../src/game/physics')\nconst chron = require('../src/utils/chron')\nconst here = document.location\nconst tps = physics.TICKS_PER_SECOND\nconst TURN_UNIT = 2 * Math.PI / tps\nconst BASE_SELF = { dead: true, posX: 0, posY: 0, velX: 0, velY: 0, orient: 0, speedMul: 1 }\nconst ZOOM_LEVELS = [1.0, 1.5, 2.0]\nconst canvas = document.getElementById('screen')\n\nconst common = require('./common')\nconst cursor = require('./cursor')\n\nlet inGame = false\nlet ws = null\nlet self = BASE_SELF\nlet connectTimer = null\n\nlet objects = {\n  ships: [],\n  bullets: [],\n  powerups: [],\n  planets: []\n}\nlet state = {\n  dead: false,\n  token: null,\n  mouseLocked: false\n}\nlet tpf = 1\n\nlet count = 1\nlet leaderboard = []\nlet rubber = 150\nlet no_data = 0\nlet pinger = null\nlet seed = 0\nlet zoom = 1\nlet last_partial = null\n\nlet resendCtrl = false\n\nconst draw = require('./draw')(canvas, self, objects, state, cursor)\nconst controls = require('./controls')(canvas, self, state, cursor,\n  {\n    useItem: () => useItem(),\n    resendControls: () => resendCtrl = true,\n    tryLockMouse: (e) => tryLockMouse(e),\n    nextZoom: () => nextZoom(),\n  })\nconst joystick = require('./joystick')(self, state, controls)\nlet ui\n\ndraw.checkSize()\n\nconst updateZoomText = () => {\n  ui.updateZoomText(zoom)\n  draw.checkSize()\n}\n\nconst setZoom = z => {\n  zoom = z\n  draw.setZoom(z)\n  updateZoomText()\n}\n\nconst nextZoom = () => {\n  let indx = (ZOOM_LEVELS.indexOf(zoom) + 1) % ZOOM_LEVELS.length\n  if (indx < 0) {\n    indx += ZOOM_LEVELS.length\n  }\n  Cookies.set('avaruuspeli-zoom', indx, { sameSite: 'strict' })\n  setZoom(ZOOM_LEVELS[indx])\n}\n\nconst disconnect = () => {\n  ui.disconnect()\n  leaveGame()\n}\n\nconst joinGame = () => {\n  if (!inGame) {\n    ui.joiningGame()\n    ui.hideDialog()\n\n    connectTimer = setTimeout(() => disconnect(), 5000)\n\n    let wsproto = here.protocol.replace('http', 'ws')\n    let port = here.port\n    if (port) {\n      port = `:${port}`\n    }\n    ws = new WebSocket(`${wsproto}//${here.hostname}${port}${here.pathname}`)\n    inGame = true\n\n    ws.addEventListener('message', (e) => {\n      const obj = serial.decode(serial.recv(e.data))\n\n      if (serial.is_token(obj)) {\n        ui.updateOnlineStatus('in game')\n        state.token = obj.token\n\n      } else if (serial.is_pong(obj)) {\n        const now = performance.now()\n        ui.updateOnlineStatus(\n          `in game, ping: ${Math.max(now - obj.time, 0).toFixed(1)}ms`)\n\n      } else if (serial.is_data(obj)) {\n        no_data = 0\n        let you = null\n        let ships = []\n        let projs = null\n        let oldHealth = {}\n        for (const ship of objects.ships) {\n          oldHealth[ship._id] = ship.health\n        }\n\n        ({ you, ships, projs, count, rubber, seed } = obj)\n        you = serial.deserializeShip(you)\n        ships = ships.map(serial.deserializeShip)\n        projs = projs.map(serial.deserializeBullet)\n        draw.setRubber(rubber)\n\n        objects.ships = ships\n\n        for (const ship of ships) {\n          if (Object.prototype.hasOwnProperty.call(oldHealth, ship._id) && oldHealth[ship._id] > ship.health) {\n            draw.addBubble({ x: ship.posX, y: ship.posY, alpha: 100, radius: 0.3 * (1 + oldHealth[ship._id] - ship.health) })\n          }\n        }\n\n        if (self.dead) {\n          Object.assign(self, you)\n          state.dead = self.dead = false\n        } else {\n          if (Math.abs(you.posX - self.posX) > 0.3) {\n            self.posX = (self.posX + you.posX) / 2\n            self.velX = (self.velX + you.velX) / 2\n          }\n          if (Math.abs(you.posY - self.posY) > 0.3) {\n            self.posY = (self.posY + you.posY) / 2\n            self.velY = (self.velY + you.velY) / 2\n          }\n          if (Math.abs(you.velX - self.velX) > 0.2) {\n            self.velX = you.velX\n          }\n          if (Math.abs(you.velY - self.velY) > 0.2) {\n            self.posY = you.posY\n          }\n          if (controls.isAccelerating() !== (you.accel !== null)\n              || controls.isBraking() !== (you.brake !== null)) {\n            resendCtrl = true\n          }\n          ui.updateScore(you.score, self.score)\n          self.name = you.name\n          self.score = you.score\n          state.dead = self.dead = you.dead\n          if (you.health < self.health) {\n            draw.gotDamage(self.health - you.health)\n            draw.addBubble({ x: self.posX, y: self.posY, alpha: 100, radius: 0.3 * (1 + self.health - you.health) })\n          }\n          self.health = you.health\n          self.latched = you.latched\n          self.speedMul = you.speedMul\n          self.item = you.item\n          self.regen = you.regen\n          self.overdrive = you.overdrive\n          self.rubbership = you.rubbership\n        }\n        if (physics.getPlanetSeed() != seed) {\n          physics.setPlanetSeed(seed)\n          objects.planets = physics.getPlanets(self.posX, self.posY)\n        }\n        if (projs.length) {\n          objects.bullets = [...objects.bullets, ...projs.filter(x => x)]\n        }\n        ui.updatePowerup(self, state)\n        physics.setPlanetSeed(seed)\n        ui.updatePlayerCount(count)\n        ui.updateHealthBar(self.health)\n\n      } else if (serial.is_board(obj)) {\n        leaderboard = obj.board\n        ui.updateLeaderboard(leaderboard)\n\n      } else if (serial.is_orient(obj)) {\n        self.orient = obj.orient\n\n      } else if (serial.is_unauth(obj)) {\n        disconnect()\n\n      } else if (serial.is_killed(obj)) {\n        draw.explosion(self, tpf)\n        leaveGame()\n        ui.defeatedByPlayer(obj.ship)\n\n      } else if (serial.is_crashed(obj)) {\n        draw.explosion(self, tpf)\n        leaveGame()\n        ui.defeatedByCrash(obj.ship)\n\n      } else if (serial.is_hitpl(obj)) {\n        draw.explosion(self, tpf)\n        leaveGame()\n        ui.defeatedByPlanet(obj.ship)\n\n      } else if (serial.is_killship(obj)) {\n        const matching = objects.ships.find(ship => ship._id === obj.ship)\n        if (matching !== null) {\n          draw.explosion(matching, tpf)\n        }\n        objects.ships = objects.ships.filter(ship => ship._id !== obj.ship)\n\n      } else if (serial.is_killproj(obj)) {\n        objects.bullets = objects.bullets.filter(bullet => bullet._id !== obj.proj)\n\n      } else if (serial.is_minexpl(obj)) {\n        const mine = serial.deserializeBullet(obj.mine)\n        draw.addBubble({ x: mine.posX, y: mine.posY, alpha: 200, radius: 1 })\n\n      } else if (serial.is_addpup(obj)) {\n        objects.powerups.push(serial.deserializePowerup(obj.powerup))\n        ui.showPowerupAnimation()\n\n      } else if (serial.is_delpup(obj)) {\n        objects.powerups = objects.powerups.filter(powerup => powerup._id !== obj.powerup)\n\n      } else if (serial.is_deathk(obj)) {\n        ui.addDeathLog(`${obj.ship} was killed by ${obj.by}`)\n\n      } else if (serial.is_deathc(obj)) {\n        ui.addDeathLog(`${obj.ship} crashed into ${obj.by}`)\n\n      } else if (serial.is_deathp(obj)) {\n        ui.addDeathLog(`${obj.ship} crashed into a planet`)\n      }\n    })\n    \n    ws.addEventListener('open', () => {\n      state.dead = false\n      if (connectTimer !== null) {\n        clearTimeout(connectTimer)\n        connectTimer = null\n      }\n      let nick = document.getElementById('nick').value.trim()\n      const perk = document.getElementById('perkselect').value.trim()\n      if (nick.length < 1) {\n        nick = ((100000000 * Math.random()) | 0).toString()\n      } else {\n        Cookies.set('avaruuspeli-name', nick)\n      }\n      Cookies.set('avaruuspeli-perk', perk)\n      ui.updateOnlineStatus('waiting for spawn')\n      serial.send(ws, serial.e_join(nick, perk))\n      draw.checkSize()\n      ui.updateControls(state)\n      joystick.resetJoystickCenter()\n      pinger = setInterval(() => {\n        if (++no_data > 8 || ws == null) {\n          disconnect()\n          return\n        }\n        serial.send(ws, serial.e_ping(performance.now()))\n      }, 500)\n    })\n    \n    ws.addEventListener('close', () => {\n      if (!state.dead) {\n        disconnect()\n      }\n      state.dead = true\n    })\n  }\n}\n\nconst leaveGame = () => {\n  if (pinger !== null) {\n    clearInterval(pinger)\n    pinger = null\n  }\n  if (ws !== null) {\n    ws.close()\n  }\n  if (state.mouseLocked) {\n    document.exitPointerLock()\n  }\n  state.token = null\n  state.dead = self.dead = true\n  ws = null\n  inGame = false\n\n  objects.ships = []\n  objects.bullets = []\n  objects.powerups = []\n\n  draw.reset()\n  controls.reset()\n  ui.updateOnlineStatus('offline')\n  ui.showDialog()\n  draw.checkSize()\n  ui.updateControls(state)\n}\n\nconst serverTick = () => {\n  if (!ws || !self) {\n    self.velX *= 0.95\n    self.velY *= 0.95\n    return\n  }\n\n  if (!state.token) {\n    return\n  }\n\n  if (resendCtrl) {\n    serial.send(ws, serial.e_ctrl(state.token, self.orient, \n      controls.isAccelerating(), controls.isBraking(), controls.isFiring()))\n    resendCtrl = false\n  }\n  \n  if (controls.isAccelerating()) {\n    physics.accel(self, chron.timeMs() - self.accel)\n  }\n  if (controls.isBraking()) {\n    physics.brake(self)\n  }\n  if (controls.isFiring() \n    && self.fireWaitTicks <= 0\n    && !self.latched) {\n    physics.recoil(self)\n  }\n  physics.inertia(self)\n  if (!self.latched) {\n    physics.rubberband(self, rubber)\n    objects.planets = physics.getPlanets(self.posX, self.posY)\n    physics.gravityShip(self, objects.planets)\n  }\n\n  for (const ship of objects.ships) {\n    if (!ship.latched) {\n      physics.gravityShip(ship, physics.getPlanets(ship.posX, ship.posY))\n    }\n  }\n\n  for (const bullet of objects.bullets) {\n    if (bullet.type !== 'mine') {\n      physics.gravityBullet(bullet, physics.getPlanets(bullet.posX, bullet.posY))\n    }\n  }\n  \n  ui.updateColors(self.health, performance.now())\n}\nsetInterval(serverTick, physics.MS_PER_TICK)\n\nlet turnLeftRamp = 0\nlet turnRightRamp = 0\n\nconst partialTick = (delta) => {\n  tpf = 1.0 * delta / physics.MS_PER_TICK\n\n  if (!self.latched) {\n    // turning\n    const turnLeft = controls.isTurningLeft()\n    const turnRight = controls.isTurningRight()\n    if (turnLeft && !turnRight) {\n      self.orient -= turnLeftRamp * TURN_UNIT * tpf\n      turnLeftRamp = Math.min(1, turnLeftRamp + tpf * 0.1)\n      physics.onTurn(self, chron.timeMs())\n      resendCtrl = true\n    } else if (turnRight && !turnLeft) {\n      self.orient += turnRightRamp * TURN_UNIT * tpf\n      turnRightRamp = Math.min(1, turnRightRamp + tpf * 0.1)\n      physics.onTurn(self, chron.timeMs())\n      resendCtrl = true\n    }\n    if (!turnLeft)\n      turnLeftRamp = 0\n    if (!turnRight)\n      turnRightRamp = 0\n  } else {\n    turnLeftRamp = 0\n    turnRightRamp = 0\n  }\n  \n  // interpolate\n  self.posX += tpf * self.velX\n  self.posY += tpf * self.velY\n\n  for (const ship of objects.ships) {\n    ship.posX += tpf * ship.velX\n    ship.posY += tpf * ship.velY\n  }\n  for (const bullet of objects.bullets) {\n    if (bullet.type == 'bullet' || bullet.type == 'laser') {\n      bullet.posX += tpf * bullet.velX\n      bullet.posY += tpf * bullet.velY\n      bullet.dist += tpf * bullet.velocity\n    } else if (bullet.type == 'mine') {\n      bullet.dist += tpf / (physics.TICKS_PER_SECOND * physics.MINE_LIFETIME)\n    }\n  }\n  objects.bullets = objects.bullets.filter(b => b.dist <= physics.MAX_BULLET_DISTANCE)\n}\n\nconst useItem = () => {\n  if (self.item !== null) {\n    serial.send(ws, serial.e_useitem(state.token))\n    self.item = null\n  }\n}\n\nconst tryLockMouse = (e) => {\n  if (common.isMobile()) {\n    return\n  }\n  cursor.setPosition(e.clientX, e.clientY)\n  canvas.requestPointerLock()\n}\n\nwindow.addEventListener('blur', () => {\n  if (!state.token || state.dead) {\n    return\n  }\n  controls.unpress()\n}, true)\n\nwindow.addEventListener('beforeupload', () => {\n  serial.send(ws, serial.e_quit(state.token))\n}, true)\n\nconst tryReadCookies = () => {\n  const name = Cookies.get('avaruuspeli-name')\n  if (name) {\n    document.getElementById('nick').value = name.substring(0, 20).trim()\n  }\n  const perk = Cookies.get('avaruuspeli-perk')\n  if (perk) {\n    document.getElementById('perkselect').value = ''\n    for (let i = 0; i < document.getElementById('perkselect').options.length; ++i) {\n      const option = document.getElementById('perkselect').options[i]\n      if (option.value == perk) {\n        option.selected = true\n        break\n      }\n    }\n  }\n  const cookieZoom = Cookies.get('avaruuspeli-zoom') | 0\n  if (isFinite(cookieZoom)) {\n    setZoom(ZOOM_LEVELS[cookieZoom % ZOOM_LEVELS.length])\n  }\n}\n\nconst frame = time => {\n  let delta = 0\n  if (last_partial != null) {\n    delta = time - last_partial\n    partialTick(delta)\n    ui.updateOpacity(delta)\n  }\n  last_partial = time\n  draw.frame(time, delta)\n  window.requestAnimationFrame(frame)\n}\n\nwindow.requestAnimationFrame(frame)\n\nui = require('./ui')({ joinGame, tryLockMouse, nextZoom })\nleaveGame()\nupdateZoomText()\nui.hideLose()\ntryReadCookies()\n"],"names":["isMobile","test","navigator","userAgent","module","exports","chron","require","canvas","self","state","cursor","callbacks","firing","accel","brake","turnLeft","turnRight","isAccelerating","isBraking","isFiring","isTurningLeft","isTurningRight","accelerate","flag","resendControls","reset","unpress","handleMouseDown","e","mouseLocked","document","hidden","dead","tryLockMouse","handleMouseMove","handleMouseUp","leftButton","buttons","rightButton","useItem","addPosition","movementX","movementY","mcx","body","clientWidth","mcy","clientHeight","radius","Math","hypot","getX","getY","latched","orient","atan2","addEventListener","pointerLockElement","pointerType","getElementById","pressure","window","PointerEvent","token","code","timeMs","nextZoom","shiftKey","cursorX","cursorY","setPosition","x","y","LCG","geom","physics","fogCanvas","createElement","fogCtx","getContext","SQRT_H","sqrt","GRID_SIZE","PLANET_SPIN_SPEED","MINE_X","MINE_Y","objects","ctx","damageGot","lcg","lines","smokes","bubbles","planetAngle","damageAlpha","lastSmoke","zoom","rubber","cx","cy","unitSize","gotDamage","damage","performance","now","setZoom","z","setRubber","r","checkSize","width","innerWidth","devicePixelRatio","height","innerHeight","min","VIEW_DISTANCE","drawFog","addBubble","bubble","push","clearRect","bgradient","createRadialGradient","addColorStop","beginPath","arc","PI","rect","fillStyle","fill","drawShip","ship","p1","p2","p3","p4","getShipPoints","x1","y1","x2","y2","x3","y3","x4","y4","x0","y0","posX","posY","strokeStyle","moveTo","lineTo","closePath","stroke","tp1","tp2","tp3","tp4","tp5","getThrusterPoints","x5","y5","xo","random","yo","font","textAlign","fillText","name","drawBullet","bullet","lineWidth","type","velX","velY","i","drawLine","line","angle","alpha","cos","sin","drawPowerup","powerup","color","sx","sy","drawSmoke","smoke","drawBubble","max","computePlanetAngle","drawPlanet","planet","reseed","seed","gon","abs","randomInt","randomOffset","randomSign","fac","createLine","xv","yv","tpf","vx","vy","vangle","explosion","x6","y6","frame","time","delta","xm","ym","fillRect","dx","dy","gradient","RUBBERBAND_BUFFER","health","interval","Object","prototype","hasOwnProperty","call","_id","ships","bullets","planets","powerups","length","ctr","alp","powerupColor","filter","shipid","keys","drawImage","jouter","jbase","jstick","controls","applyPosition","hjbw","offsetWidth","hjbh","offsetHeight","offsetLeft","offsetTop","h","willAccel","shouldUpdateAccelStart","resetJoystickCenter","style","top","left","clientX","clientY","stopPropagation","stopImmediatePropagation","common","dialogOpacity","animation","visibility","updateZoomText","textContent","showDialog","opacity","display","position","overflow","hideDialog","hideLose","disconnect","updateOpacity","makeTd","text","td","makeTableRow","lb","tr","appendChild","updateLeaderboard","leaderboard","leaderBoardTable","newBody","replaceChild","childNodes","formatTime","sec","floor","slice","updateControls","updatePowerup","resText","item","rubbership","overdrive","regen","trim","updateOnlineStatus","updateColors","background","t","updateScore","scoreNow","scoreWas","updatePlayerCount","players","updateHealthBar","ceil","addDeathLog","deathLog","childElementCount","removeChild","firstChild","p","setTimeout","parentNode","defeatedByPlayer","innerHTML","defeatedByCrash","defeatedByPlanet","showPowerupAnimation","joiningGame","blur","joinGame","fullscreenElement","exitFullscreen","documentElement","requestFullscreen","global","factory","define","amd","current","Cookies","noConflict","assign","target","arguments","source","key","defaultConverter","read","value","replace","decodeURIComponent","write","encodeURIComponent","init","converter","defaultAttributes","set","attributes","expires","Date","toUTCString","escape","stringifiedAttributes","attributeName","split","cookie","get","cookies","jar","parts","join","foundKey","create","remove","withAttributes","withConverter","freeze","api","path","Counter","bulletCounter","BULLET_DAMAGE_MULTIPLIER","newBullet","dist","velocity","shooter","shooterName","isHit","canPickUp","next","bulletFields","bulletSystemFactory","handler","getBullets","values","getBulletsById","ids","map","id","removeBullet","onBulletDeleted","handleShipBulletCollision","getShipById","healthMul","absorber","score","killShipByBullet","handlePowerupBulletCollision","applyPowerup","removeMinesBy","shipId","projList","projCount","moveBullets","shipList","getShips","powerupList","getPowerups","bulletList","shipCount","powerupCount","bulletCount","MAX_BULLET_DISTANCE","gravityBullet","getPlanets","newX","newY","collisionShip","j","getCollisionPoints","lineIntersectsTriangle","collisionPowerup","pickupRadius","a1","a2","lineIntersectsLine","hitPlanet","primerShip","forEach","onMineExplode","MINE_LIFETIME","TICKS_PER_SECOND","addProjectile","extras","extraDist","orientOffset","speedFactor","damageFactor","rangeSub","typeSpeedMul","BULLET_VELOCITY","bulletSpeedMul","system","fields","GRAV","MS_PER_TICK","MAX_SHIP_VELOCITY","MIN_SHIP_VELOCITY","LATCH_VELOCITY","BRAKE_MUL","INERTIA_MUL","PLANET_CHUNK_SIZE","PLANET_SEED","getAccelMul","accelTimeMs","onTurn","highAgility","checkMinVelocity","v","checkMaxVelocity","maxvel","healthToVelocity","speedMul","getPlanetSeed","setPlanetSeed","newPlanetSeed","getPlanetsForChunk","xb","yb","xu","yu","hasOverdrive","hasRubbership","hasRegen","accelMul","inertia","recoil","d","r2","f","gravityShip","dv","getRubberbandRadius","playerCount","pow","rubberband","distCenter","maxRadius","baseX","baseY","powerupCounter","newPowerup","despawn","pickupDist","pickupPlayer","powerupFields","powerupSystemFactory","nextPowerup","trySpawnPowerup","tries","count","theta","playerDist","apply","inPlanet","tooClose","onPowerupSpawned","setNextPowerupTime","division","getShipCount","maybeSpawnPowerup","ITEM_COUNT","removePowerup","updateClosestPlayer","onPowerupDeleted","updatePowerups","maths","shipCounter","newShip","fireWaitTicks","firingInterval","planetDamageMul","healRate","shipFields","shipSystemFactory","removeShipById","newPlayerShip","spawn","latchToPlanet","latchToPlanetWithAngle","computePlanetPoint","onShipLatch","spawnLone","playerKeys","randShip","bulletDist","ideal","find","testPlanet","a","b","mostIdeal","reduce","angleOffset","minimalScore","testAngle","doFire","shipAcceleration","radiusGoal","doAccel","doBrake","moveShips","ship1","posXnew","posYnew","pup","lineIntersectCircleFirstDepth","ship2","closestSynchroDistance","testShipShipCollision","handleShipShipCollision","dmg1","dmg2","onShipKilledByCrash","killShip","q1","q2","q4","pointInTriangle","handleShipPlanetCollision","playerAngle","diffAngle","col_mul","getPlanetAngleMultiplier","col_vel","onShipKilledByPlanet","findShipPlanetCollisions","search","deleteShip","onShipKilled","getTime","constructor","counter","BigInt","val","toString","padStart","asUintN","xp","yp","c1","c2","c3","getDirectionSign","s","sign","collinearLinesIntersect","b1","b2","c","isFinite","n","m","l1","l2","t1","t2","t3","Number","NaN","A","B","C","D","wrapRadianAngle","vel","diff","sc","withinBoundingSquare","center","rotatePoint","rotatePointOffset","LCG_A","LCG_C","SC","Generator","serializeFrom","object","field","deserializeFrom","array","serializeBullet","obj","deserializeBullet","arr","serializePowerup","deserializePowerup","serializeShip","deserializeShip","C_ping","C_join","C_ctrl","C_quit","C_useitem","C_pong","C_token","C_data","C_board","C_killship","C_killproj","C_orient","C_unauth","C_addpup","C_delpup","C_minexpl","C_deathk","C_deathc","C_deathp","C_crashed","C_killed","C_hitpl","keyDictionary","reverseKeyDictionary","encodeKeys","data","result","encoded","undefined","decodeKeys","decoded","encode","JSON","stringify","decode","parse","recv","send","ws","e_token","cmd","e_data","nearbyShips","addBullets","rubberRadius","planetSeed","you","projs","e_unauth","e_board","board","e_killship","e_killproj","projId","proj","e_crashed","e_killed","e_orient","e_hitpl","e_join","nick","perk","e_ping","e_pong","e_quit","e_ctrl","e_addpup","e_delpup","e_useitem","e_minexpl","mine","e_deathk","by","e_deathc","e_deathp","is_ctrl","is_join","is_ping","is_pong","is_quit","is_token","is_data","is_board","is_killship","is_killproj","is_crashed","is_killed","is_hitpl","is_orient","is_unauth","is_addpup","is_delpup","is_useitem","is_minexpl","is_deathk","is_deathc","is_deathp","serial","here","location","tps","TURN_UNIT","BASE_SELF","ZOOM_LEVELS","inGame","connectTimer","no_data","pinger","last_partial","resendCtrl","draw","joystick","ui","indx","indexOf","sameSite","leaveGame","wsproto","protocol","port","WebSocket","hostname","pathname","toFixed","oldHealth","matching","clearTimeout","setInterval","clearInterval","close","exitPointerLock","serverTick","turnLeftRamp","turnRightRamp","partialTick","requestPointerLock","tryReadCookies","substring","options","option","selected","cookieZoom","requestAnimationFrame"],"sourceRoot":""}