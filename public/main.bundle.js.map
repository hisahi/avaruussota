{"version":3,"file":"main.bundle.js","mappings":"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","sources":["webpack://avaruussota/./js/common.js","webpack://avaruussota/./js/controls.js","webpack://avaruussota/./js/cursor.js","webpack://avaruussota/./js/draw.js","webpack://avaruussota/./js/joystick.js","webpack://avaruussota/./js/tick.js","webpack://avaruussota/./js/ui.js","webpack://avaruussota/./node_modules/js-cookie/dist/js.cookie.js","webpack://avaruussota/./src/game/bullet.js","webpack://avaruussota/./src/game/physics.js","webpack://avaruussota/./src/game/powerup.js","webpack://avaruussota/./src/game/ship.js","webpack://avaruussota/./src/utils/chron.js","webpack://avaruussota/./src/utils/counter.js","webpack://avaruussota/./src/utils/geom.js","webpack://avaruussota/./src/utils/lcg.js","webpack://avaruussota/./src/utils/maths.js","webpack://avaruussota/./src/utils/serial.js","webpack://avaruussota/./node_modules/msgpackr/index.js","webpack://avaruussota/./node_modules/msgpackr/iterators.js","webpack://avaruussota/./node_modules/msgpackr/pack.js","webpack://avaruussota/./node_modules/msgpackr/unpack.js","webpack://avaruussota/webpack/bootstrap","webpack://avaruussota/webpack/runtime/define property getters","webpack://avaruussota/webpack/runtime/hasOwnProperty shorthand","webpack://avaruussota/webpack/runtime/make namespace object","webpack://avaruussota/./js/main.js"],"sourcesContent":["\nconst isMobile = () => {\n  return /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)\n}\n\nmodule.exports = {\n  isMobile\n}\n","const chron = require('../src/utils/chron')\n\nmodule.exports = (canvas, self, state, cursor, callbacks) => {\n  let firing = false\n  let accel = false\n  let brake = false\n  let turnLeft = false\n  let turnRight = false\n\n  const isAccelerating = () => accel\n  const isBraking = () => brake\n  const isFiring = () => firing\n  const isTurningLeft = () => turnLeft\n  const isTurningRight = () => turnRight\n\n  const accelerate = flag => {\n    if (accel !== flag) {\n      accel = flag\n      if (!flag)\n        self.accel = null\n      resendControls()\n    }\n  }\n\n  const reset = () => {\n    accel = false\n    brake = false\n    turnLeft = false\n    turnRight = false\n    firing = false\n  }\n\n  const resendControls = () => callbacks.resendControls()\n\n  const unpress = () => {\n    reset()\n    self.accel = null\n    resendControls()\n  }\n\n  const handleMouseDown = (e) =>{\n    if (!state.mouseLocked && !document.hidden && !state.dead) {\n      callbacks.tryLockMouse(e)\n    }\n    handleMouseMove(e)\n  }\n  \n  const handleMouseUp = (e) => {\n    handleMouseMove(e)\n  }\n  \n  const handleMouseMove = (e) => {\n    const leftButton = (e.buttons & 1) !== 0\n    const rightButton = (e.buttons & 2) !== 0\n  \n    if (leftButton && !firing) {\n      firing = true\n      resendControls()\n    } else if (!leftButton && firing) {\n      firing = false\n      resendControls()\n    }\n  \n    if (rightButton) {\n      callbacks.useItem()\n    }\n  \n    if (state.mouseLocked) {\n      cursor.addPosition(e.movementX, e.movementY)\n      const mcx = document.body.clientWidth / 2\n      const mcy = document.body.clientHeight / 2\n      const radius = Math.hypot(cursor.getX() - mcx, mcy - cursor.getY())\n      if (!self.latched && radius > 2) {\n        self.orient = Math.atan2(cursor.getX() - mcx, mcy - cursor.getY())\n        resendControls()\n      }\n    }\n  }\n  \n  document.addEventListener('pointerlockchange', () => {\n    state.mouseLocked = document.pointerLockElement === canvas\n  })\n  \n  canvas.addEventListener('pointerdown', (e) => {\n    if (e.pointerType == 'mouse') {\n      handleMouseDown(e)\n    }\n  })\n  \n  canvas.addEventListener('pointerup', (e) => {\n    if (e.pointerType == 'mouse') {\n      handleMouseUp(e)\n    }\n  })\n  \n  canvas.addEventListener('pointermove', (e) => {\n    if (e.pointerType == 'mouse') {\n      handleMouseMove(e)\n    }\n  })\n  \n  document.getElementById('btnfire').addEventListener('pointerdown', () => {\n    firing = true\n    resendControls()\n  })\n  document.getElementById('btnfire').addEventListener('pointerover', (e) => {\n    if (e.pressure > 0) {\n      firing = true\n      resendControls()\n    }\n  })\n  \n  document.getElementById('btnfire').addEventListener('pointerout', () => {\n    firing = false\n    resendControls()\n  })\n  document.getElementById('btnfire').addEventListener('pointerup', () => {\n    firing = false\n    resendControls()\n  })\n  \n  document.getElementById('btnbrake').addEventListener('pointerdown', () => {\n    brake = true\n    resendControls()\n  })\n  document.getElementById('btnbrake').addEventListener('pointerover', (e) => {\n    if (e.pressure > 0) {\n      brake = true\n      resendControls()\n    }\n  })\n  \n  document.getElementById('btnbrake').addEventListener('pointerout', () => {\n    brake = false\n    resendControls()\n  })\n  document.getElementById('btnbrake').addEventListener('pointerup', () => {\n    brake = false\n    resendControls()\n  })\n  \n  document.getElementById('btnconsume').addEventListener('pointerdown', () => {\n    callbacks.useItem()\n  })\n  document.getElementById('btnconsume').addEventListener('pointerover', (e) => {\n    if (e.pressure > 0) {\n      callbacks.useItem()\n    }\n  })\n  \n  if (!window.PointerEvent) {\n    canvas.addEventListener('mousedown', (e) => {\n      handleMouseDown(e)\n    })\n    \n    canvas.addEventListener('mouseup', (e) => {\n      handleMouseUp(e)\n    })\n    \n    canvas.addEventListener('mousemove', (e) => {\n      handleMouseMove(e)\n    })\n  }\n  \n  window.addEventListener('keydown', (e) => {\n    if (!state.token || state.dead) {\n      return\n    }\n  \n    if (e.code == 'KeyW') {\n      accel = true\n      self.accel = chron.timeMs()\n      resendControls()\n    } else if (e.code == 'KeyS') {\n      brake = true\n      resendControls()\n    } else if (e.code == 'KeyA') {\n      turnLeft = true\n    } else if (e.code == 'KeyD') {\n      turnRight = true\n    } else if (e.code == 'KeyQ') {\n      callbacks.useItem()\n    } else if (e.code == 'Space') {\n      firing = true\n      resendControls()\n    }\n  }, true)\n  \n  window.addEventListener('keyup', (e) => {\n    if (!state.token || state.dead) {\n      return\n    }\n  \n    if (e.code == 'KeyW') {\n      accel = false\n      self.accel = null\n      resendControls()\n    } else if (e.code == 'KeyS') {\n      brake = false\n      resendControls()\n    } else if (e.code == 'KeyA') {\n      turnLeft = false\n    } else if (e.code == 'KeyD') {\n      turnRight = false\n    } else if (e.code == 'KeyZ') {\n      callbacks.nextZoom(e.shiftKey ? -1 : 1)\n    } else if (e.code == 'Space') {\n      firing = false\n      resendControls()\n    }\n  }, true)\n  \n  return {\n    accelerate,\n    resendControls,\n    isAccelerating,\n    isBraking,\n    isFiring,\n    isTurningLeft,\n    isTurningRight,\n    reset,\n    unpress\n  }\n}\n","let cursorX = -10\nlet cursorY = -10\n\nconst setPosition = (x, y) => (cursorX = x, cursorY = y)\nconst addPosition = (x, y) => (cursorX += x, cursorY += y)\nconst getX = () => cursorX\nconst getY = () => cursorY\n\nmodule.exports = {\n  setPosition,\n  addPosition,\n  getX,\n  getY\n}\n","const LCG = require('../src/utils/lcg')\nconst geom = require('../src/utils/geom')\nconst physics = require('../src/game/physics')\n\nconst fogCanvas = document.createElement('canvas')\nconst fogCtx = fogCanvas.getContext('2d')\nconst SQRT_H = Math.sqrt(0.5)\nconst GRID_SIZE = 10\nconst PLANET_SPIN_SPEED = 0.02\nconst MINE_X = [0, SQRT_H, 1, SQRT_H, 0, -SQRT_H, -1, -SQRT_H]\nconst MINE_Y = [1, SQRT_H, 0, -SQRT_H, -1, -SQRT_H, 0, SQRT_H]\n\nmodule.exports = (canvas, self, objects, state, cursor) => {\n  const ctx = canvas.getContext('2d')\n\n  let damageGot = 0\n  let lcg = new LCG(0)\n  let lines = []\n  let smokes = []\n  let bubbles = []\n  let planetAngle = 0\n  let damageAlpha = 0\n  let lastSmoke = {}\n  let zoom = 1\n  let rubber = 150\n  let cx = 0\n  let cy = 0\n  let unitSize = 1\n\n  const reset = () => {\n    lines = []\n    smokes = []\n    damageGot = 0\n    damageAlpha = 0\n  }\n\n  const gotDamage = (damage) => {\n    damageGot = performance.now() + damage * 700\n    damageAlpha = 0.8 * damage\n  }\n\n  const setZoom = z => zoom = z\n\n  const setRubber = r => rubber = r\n\n  const checkSize = () => {\n    ctx.canvas.width = window.innerWidth * window.devicePixelRatio\n    ctx.canvas.height = window.innerHeight * window.devicePixelRatio\n    cx = ctx.canvas.width / 2\n    cy = ctx.canvas.height / 2\n    unitSize = Math.min(ctx.canvas.width, ctx.canvas.height) \n      / physics.VIEW_DISTANCE * (zoom / 2)\n    \n    drawFog()\n  }\n\n  const addBubble = bubble => bubbles.push(bubble)\n\n  const drawFog = () => {\n    fogCanvas.width = ctx.canvas.width\n    fogCanvas.height = ctx.canvas.height\n\n    fogCtx.clearRect(0, 0, fogCanvas.width, fogCanvas.height)\n    const bgradient = fogCtx.createRadialGradient(cx, cy,\n      (physics.VIEW_DISTANCE - 1) * unitSize,\n      cx, cy,\n      (physics.VIEW_DISTANCE + 10) * unitSize)\n\n    bgradient.addColorStop(0, 'rgba(0,0,0,0)')\n    bgradient.addColorStop(0.5, 'rgba(0,0,0,0.2)')\n    bgradient.addColorStop(1, 'rgba(0,0,0,0.9)')\n    fogCtx.beginPath()\n    fogCtx.arc(cx, cy, \n      (physics.VIEW_DISTANCE - 1) * unitSize, 0, 2 * Math.PI)\n    fogCtx.rect(fogCtx.canvas.width, 0, -fogCtx.canvas.width, fogCtx.canvas.height)\n    fogCtx.fillStyle = bgradient\n    fogCtx.fill()\n  }\n\n  const drawShip = (ship) => {\n    const [p1, p2, p3, p4] = geom.getShipPoints(ship)\n    let [x1, y1] = p1\n    let [x2, y2] = p2\n    let [x3, y3] = p3\n    let [x4, y4] = p4\n    let [x0, y0] = [0, 0]\n\n    x0 = cx + (self.posX - ship.posX) * unitSize\n    x1 = cx + (self.posX - x1) * unitSize\n    x2 = cx + (self.posX - x2) * unitSize\n    x3 = cx + (self.posX - x3) * unitSize\n    x4 = cx + (self.posX - x4) * unitSize\n\n    y0 = cy + (self.posY - ship.posY) * unitSize\n    y1 = cy + (self.posY - y1) * unitSize\n    y2 = cy + (self.posY - y2) * unitSize\n    y3 = cy + (self.posY - y3) * unitSize\n    y4 = cy + (self.posY - y4) * unitSize\n\n    ctx.strokeStyle = '#fff'\n    ctx.beginPath()\n    ctx.moveTo(x1, y1)\n    ctx.lineTo(x2, y2)\n    ctx.lineTo(x3, y3)\n    ctx.lineTo(x4, y4)\n    ctx.closePath()\n    ctx.stroke()\n\n    if (ship.accel !== null) {\n      const [tp1, tp2, tp3, tp4, tp5] = geom.getThrusterPoints(ship)\n      let [x1, y1] = tp1\n      let [x2, y2] = tp2\n      let [x3, y3] = tp3\n      let [x4, y4] = tp4\n      let [x5, y5] = tp5\n\n      let xo = (Math.random() - 0.5) * unitSize / 2\n      let yo = (Math.random() - 0.5) * unitSize / 2\n\n      x1 = cx + (self.posX - x1) * unitSize\n      x2 = cx + (self.posX - x2) * unitSize\n      x3 = cx + (self.posX - x3) * unitSize\n      x4 = cx + (self.posX - x4) * unitSize\n      x5 = cx + (self.posX - x5) * unitSize\n    \n      y1 = cy + (self.posY - y1) * unitSize\n      y2 = cy + (self.posY - y2) * unitSize\n      y3 = cy + (self.posY - y3) * unitSize\n      y4 = cy + (self.posY - y4) * unitSize\n      y5 = cy + (self.posY - y5) * unitSize\n\n      x3 += xo\n      y3 += yo\n      x5 += xo / 2\n      y5 += yo / 2  \n\n      ctx.strokeStyle = '#888'\n      ctx.beginPath()\n      ctx.moveTo(x1, y1)\n      ctx.lineTo(x2, y2)\n      ctx.lineTo(x3, y3)\n      ctx.lineTo(x4, y4)\n      ctx.lineTo(x1, y1)\n      ctx.lineTo(x5, y5)\n      ctx.closePath()\n      ctx.stroke()\n    }\n\n    ctx.font = `${18 * window.devicePixelRatio}px monospace`\n    ctx.fillStyle = 'rgba(255,255,255,0.75)'\n    ctx.textAlign = 'center'\n    ctx.fillText(ship.name, x0, y0 - 3.75 * unitSize)\n  }\n\n  const drawBullet = (bullet) => {\n    const x = cx + (self.posX - bullet.posX) * unitSize\n    const y = cy + (self.posY - bullet.posY) * unitSize\n\n    ctx.lineWidth = 1 * window.devicePixelRatio\n    if (bullet.type === 'bullet') {\n      ctx.moveTo(x, y)\n      ctx.arc(x, y, 0.3 * unitSize, 0, 2 * Math.PI)\n    } else if (bullet.type === 'laser') {\n      const x1 = cx + (self.posX - (bullet.posX + bullet.velX)) * unitSize\n      const y1 = cy + (self.posY - (bullet.posY + bullet.velY)) * unitSize\n      ctx.moveTo(x, y)\n      ctx.lineTo(x1, y1)\n    } else if (bullet.type === 'mine') {\n      ctx.moveTo(x + 1.6 * unitSize, y)\n      ctx.arc(x, y, 1.6 * unitSize, 0, 2 * Math.PI)\n      for (let i = 0; i < 8; ++i) {\n        const xo = unitSize * 0.8 * MINE_X[i]\n        const yo = unitSize * 0.8 * MINE_Y[i]\n        ctx.moveTo(x + 2 * xo, y + 2 * yo)\n        ctx.lineTo(x + 3 * xo, y + 3 * yo)\n      }\n      ctx.moveTo(x, y)\n    }\n  }\n\n  const drawLine = (line) => {\n    const { x, y, angle, r, alpha } = line\n    const x1 = cx + unitSize * (self.posX - x - r * Math.cos(angle))\n    const y1 = cy + unitSize * (self.posY - y - r * Math.sin(angle))\n    const x2 = cx + unitSize * (self.posX - x + r * Math.cos(angle))\n    const y2 = cy + unitSize * (self.posY - y + r * Math.sin(angle))\n\n    ctx.strokeStyle = `rgba(192,192,192,${alpha * 0.01})` \n    ctx.beginPath()\n    ctx.moveTo(x1, y1)\n    ctx.lineTo(x2, y2)\n    ctx.stroke()\n  }\n\n  const drawPowerup = (powerup, color) => {\n    const { posX, posY } = powerup\n\n    const sx = cx + (self.posX - posX) * unitSize\n    const sy = cy + (self.posY - posY) * unitSize\n\n    if (sx < -20 || sy < -20 \n      || sx > ctx.canvas.width + 20 || sy > ctx.canvas.height + 20) {\n      return\n    }\n\n    ctx.fillStyle = color\n    ctx.beginPath()\n    ctx.arc(sx, sy, unitSize, 0, 2 * Math.PI)\n    ctx.fill()\n  }\n\n  const drawSmoke = (smoke) => {\n    const { x, y, radius, alpha } = smoke\n    const sx = cx + (self.posX - x) * unitSize\n    const sy = cy + (self.posY - y) * unitSize\n\n    ctx.fillStyle = `rgba(92,92,92,${alpha * 0.01})` \n    ctx.beginPath()\n    ctx.arc(sx, sy, radius * unitSize, 0, 2 * Math.PI)\n    ctx.fill()\n  }\n\n  const drawBubble = (bubble) => {\n    const { x, y, radius, alpha } = bubble\n    const sx = cx + (self.posX - x) * unitSize\n    const sy = cy + (self.posY - y) * unitSize\n\n    ctx.lineWidth = window.devicePixelRatio * (1 + Math.max(0, alpha - 1))\n    ctx.strokeStyle = `rgba(128,128,128,${Math.min(1, alpha) * 0.01})` \n    ctx.beginPath()\n    ctx.arc(sx, sy, radius * unitSize, 0, 2 * Math.PI)\n    ctx.stroke()\n  }\n\n  const computePlanetAngle = (radius, sx, sy, angle) => {\n    return [sx + Math.sin(angle) * radius * unitSize,\n      sy + Math.cos(angle) * radius * unitSize]\n  }\n\n  const drawPlanet = (planet) => {\n    ctx.strokeStyle = '#fff'\n    ctx.lineWidth = 1 * window.devicePixelRatio\n    \n    const sx = cx + (self.posX - planet.x) * unitSize\n    const sy = cy + (self.posY - planet.y) * unitSize\n\n    if (sx < -planet.radius * unitSize \n      || sy < -planet.radius  * unitSize\n      || sx > ctx.canvas.width + planet.radius * unitSize \n      || sy > ctx.canvas.height + planet.radius * unitSize) {\n      return\n    }\n\n    lcg.reseed(planet.seed)\n    const gon = Math.abs(lcg.randomInt()) % 19 + 12\n\n    let angle = lcg.randomOffset() * Math.PI * 2 + planetAngle * lcg.randomSign()\n    let [x, y] = computePlanetAngle(planet.radius, sx, sy, angle)\n    let fac = 2 * Math.PI / gon\n\n    ctx.moveTo(x, y)\n    for (let i = 0; i <= gon; ++i) {\n      [x, y] = computePlanetAngle(planet.radius, sx, sy, angle + i * fac)\n      ctx.lineTo(x, y)\n    }\n  }\n\n  const createLine = (x1, y1, x2, y2, xv, yv, tpf) => {\n    const [x, y] = [(x1 + x2) / 2, (y1 + y2) / 2]\n    const angle = Math.atan2(x2 - x1, y2 - y1)\n    const r = Math.hypot(x2 - x1, y2 - y1) / 2\n    const vx = -0.05 + 0.1 * Math.random() + xv * tpf\n    const vy = -0.05 + 0.1 * Math.random() + yv * tpf\n    const vangle = -0.1 + 0.2 * Math.random()\n\n    return { x, y, angle, alpha: 100, r, vx, vy, vangle }\n  }\n\n  const explosion = (ship, tpf) => {\n    if (!ship) {\n      return\n    }\n\n    const [p1, p2, p3, p4] = geom.getShipPoints(ship)\n    let [x1, y1] = p1\n    let [x2, y2] = p2\n    let [x3, y3] = p3\n    let [x4, y4] = p4\n\n    let [x5, y5] = [(x1 + x2) / 2, (y1 + y2) / 2]\n    let [x6, y6] = [(x1 + x4) / 2, (y1 + y4) / 2]\n\n    lines.push(createLine(x1, y1, x5, y5, ship.velX, ship.velY, tpf))\n    lines.push(createLine(x5, y5, x2, y2, ship.velX, ship.velY, tpf))\n    lines.push(createLine(x2, y2, x3, y3, ship.velX, ship.velY, tpf))\n    lines.push(createLine(x3, y3, x4, y4, ship.velX, ship.velY, tpf))\n    lines.push(createLine(x4, y4, x6, y6, ship.velX, ship.velY, tpf))\n    lines.push(createLine(x6, y6, x1, y1, ship.velX, ship.velY, tpf))\n  }\n\n  const frame = (time, delta) => {\n    const xm = ((self.posX % GRID_SIZE) + GRID_SIZE) % GRID_SIZE\n    const ym = ((self.posY % GRID_SIZE) + GRID_SIZE) % GRID_SIZE\n\n    ctx.fillStyle = '#000'\n    ctx.fillRect(0, 0, ctx.canvas.width, ctx.canvas.height)\n\n    // draw grid\n    ctx.lineWidth = 1 * window.devicePixelRatio\n    ctx.strokeStyle = '#333'\n    ctx.beginPath()\n    for (let x = xm * unitSize; \n      x < ctx.canvas.width; \n      x += GRID_SIZE * unitSize) {\n      const dx = x | 0 + 0.5\n      ctx.moveTo(dx, 0)\n      ctx.lineTo(dx, ctx.canvas.height)\n    }\n    for (let y = ym * unitSize; \n      y < ctx.canvas.height;\n      y += GRID_SIZE * unitSize) {\n      const dy = y | 0 + 0.5\n      ctx.moveTo(0, dy)\n      ctx.lineTo(ctx.canvas.width, dy)\n    }\n    ctx.stroke()\n    \n    if (!self.dead) {\n      // draw red mask\n      if (rubber > 1) {\n        const gradient = ctx.createRadialGradient(cx + self.posX * unitSize,\n          cy + self.posY * unitSize,\n          (rubber - 1) * unitSize,\n          cx + self.posX * unitSize,\n          cy + self.posY * unitSize,\n          (rubber + physics.RUBBERBAND_BUFFER - 1) * unitSize)\n        gradient.addColorStop(0, 'rgba(192,192,192,0)')\n        gradient.addColorStop(1, 'rgba(192,192,192,0.25)')\n        ctx.beginPath()\n        ctx.arc(cx + self.posX * unitSize, cy + self.posY * unitSize, \n          rubber * unitSize, 0, 2 * Math.PI)\n        ctx.rect(ctx.canvas.width, 0, -ctx.canvas.width, ctx.canvas.height)\n        ctx.fillStyle = gradient\n        ctx.fill()\n      }\n\n      // draw player ship\n      ctx.lineWidth = 1.5 * window.devicePixelRatio\n      drawShip(self)\n      if (self.health < 0.75) {\n        const interval = 320 ** (self.health * 0.35 + 0.9) / 2 / (1 + Math.hypot(self.velX, self.velY) / 4)\n        if (!Object.prototype.hasOwnProperty.call(lastSmoke, self._id) || time - lastSmoke[self._id] > interval) {\n          smokes.push({ \n            x: self.posX + 1.5 * Math.random() - 0.75, \n            y: self.posY + 1.5 * Math.random() - 0.75, \n            radius: 0.15 + (0.75 - self.health) + Math.random() * 0.3, \n            alpha: 100 * Math.min(1, 1.4 - self.health) })\n          lastSmoke[self._id] = time\n        }\n      }\n\n      // draw ships\n      ctx.lineWidth = 1 * window.devicePixelRatio\n      for (const ship of objects.ships) {\n        drawShip(ship)\n        if (ship.health < 0.75) {\n          const interval = 320 ** (ship.health * 0.35 + 0.9) / 2 / (1 + Math.hypot(ship.velX, ship.velY) / 4)\n          if (!Object.prototype.hasOwnProperty.call(lastSmoke, ship._id) || time - lastSmoke[ship._id] > interval) {\n            smokes.push({ \n              x: ship.posX + 1.5 * Math.random() - 0.75, \n              y: ship.posY + 1.5 * Math.random() - 0.75, \n              radius: 0.15 + (0.75 - ship.health) + Math.random() * 0.3, \n              alpha: 100 * Math.min(1, 1.4 - ship.health) })\n            lastSmoke[ship._id] = time\n          }\n        }\n      }\n\n      ctx.fillStyle = '#fff'\n      ctx.strokeStyle = '#fff'\n      ctx.beginPath()\n      // draw bullets\n      for (const bullet of objects.bullets) {\n        drawBullet(bullet)\n      }\n      ctx.stroke()\n    }\n\n    ctx.beginPath()\n    // draw planets\n    for (const planet of objects.planets) {\n      drawPlanet(planet)\n    }\n    ctx.stroke()\n\n    if (objects.powerups.length) {\n      const ctr = 0 | ((time % 300) / 15)\n      const alp = (time / 1000) % 1.0\n      const powerupColor = `rgba(${224+ctr},255,${192+ctr*2},${Math.max(alp, 1 - alp)})`\n      // draw powerups\n      for (const powerup of objects.powerups) {\n        drawPowerup(powerup, powerupColor)\n      }\n    }\n      \n    // draw lines\n    for (const line of lines) {\n      drawLine(line)\n\n      line.x += line.vx\n      line.y += line.vy\n      line.angle += line.vangle\n      line.vx *= 0.99\n      line.vy *= 0.99\n      line.vangle *= 0.99\n      line.alpha -= 1\n    }\n    lines = lines.filter(line => line.alpha > 0)\n\n    // draw smokes\n    for (const smoke of smokes) {\n      drawSmoke(smoke)\n\n      smoke.radius += 0.015\n      smoke.alpha -= 1\n    }\n    smokes = smokes.filter(smoke => smoke.alpha > 0)\n\n    for (const shipid of Object.keys(lastSmoke)) {\n      if (time - lastSmoke[shipid] >= 5000) {\n        delete lastSmoke[shipid]\n      }\n    }\n\n    // draw bubbles\n    for (const bubble of bubbles) {\n      drawBubble(bubble)\n\n      bubble.radius += 0.05\n      bubble.alpha -= 1\n    }\n    bubbles = bubbles.filter(bubble => bubble.alpha > 0)\n\n    if (!self.dead) {\n      ctx.drawImage(fogCanvas, 0, 0)\n\n      if (damageAlpha > 0) {\n        ctx.beginPath()\n        ctx.fillStyle = `rgba(128,0,0,${damageAlpha})`\n        ctx.rect(0, 0, ctx.canvas.width, ctx.canvas.height)\n        ctx.fill()\n        if (time > damageGot && damageAlpha > 0) {\n          damageAlpha = Math.max(0, damageAlpha - delta / 800)\n        }\n      }\n    }\n    \n    if (state.mouseLocked) {\n      const cursorX = cursor.getX()\n      const cursorY = cursor.getY()\n      ctx.beginPath()\n      ctx.strokeStyle = '#fff'\n      ctx.lineWidth = 1 * window.devicePixelRatio\n      ctx.moveTo(cursorX - 8.5, cursorY + 0.5)\n      ctx.lineTo(cursorX + 9.5, cursorY + 0.5)\n      ctx.moveTo(cursorX + 0.5, cursorY - 8.5)\n      ctx.lineTo(cursorX + 0.5, cursorY + 9.5)\n      ctx.stroke()\n    }\n\n    planetAngle += PLANET_SPIN_SPEED\n    planetAngle %= 2 * Math.PI\n  }\n\n  window.addEventListener('resize', () => checkSize())\n\n  return {\n    reset,\n    gotDamage,\n    setZoom,\n    setRubber,\n    checkSize,\n    addBubble,\n    drawFog,\n    drawShip,\n    drawBullet,\n    drawLine,\n    drawPowerup,\n    drawSmoke,\n    drawBubble,\n    drawPlanet,\n    explosion,\n    frame\n  }\n}\n","const chron = require('../src/utils/chron')\nconst jouter = document.getElementById('joystickouter')\nconst jbase = document.getElementById('joystickbase')\nconst jstick = document.getElementById('joystick')\n\nmodule.exports = (self, state, controls) => {\n  const applyPosition = () => {\n    if (state.dead || self === null) {\n      return\n    }\n\n    const hjbw = jbase.offsetWidth / 2\n    const hjbh = jbase.offsetHeight / 2\n    let x = (jstick.offsetLeft + (jstick.offsetWidth / 2) - (jbase.offsetLeft + hjbw)) / hjbw * Math.sqrt(2)\n    let y = (jstick.offsetTop + (jstick.offsetHeight / 2) - (jbase.offsetTop + hjbh)) / hjbh * Math.sqrt(2)\n    if (x > 1) x = 1\n    if (x < -1) x = -1\n    if (y > 1) y = 1\n    if (y < -1) y = -1\n\n    const h = Math.hypot(x, y)\n    \n    const willAccel = h > 0.8\n    let shouldUpdateAccelStart = willAccel != controls.isAccelerating()\n\n    if (!self.latched && h > 0.01) {\n      const angle = Math.atan2(x, -y)\n      shouldUpdateAccelStart |= self.orient != angle\n      self.orient = angle \n    }\n\n    controls.accelerate(willAccel)\n    if (shouldUpdateAccelStart) {\n      if (willAccel) {\n        self.accel = chron.timeMs()\n      } else {\n        self.accel = null\n      }\n      controls.resendControls()\n    }\n  }\n\n  const resetJoystickCenter = () => {\n    jstick.style.top = jbase.offsetTop + (jbase.offsetHeight / 2) - (jstick.offsetHeight / 2) + 'px'\n    jstick.style.left = jbase.offsetLeft + (jbase.offsetWidth / 2) - (jstick.offsetWidth / 2) + 'px'\n    applyPosition()\n  }\n\n  jbase.addEventListener('pointerdown', (e) => {\n    jstick.style.left = e.clientX - (jstick.offsetWidth / 2) + 'px'\n    jstick.style.top = e.clientY - (jstick.offsetHeight / 2) + 'px'\n    applyPosition()\n  })\n\n  jbase.addEventListener('pointermove', (e) => {\n    if (e.pressure > 0 || e.buttons & 1) {\n      jstick.style.left = e.clientX - (jstick.offsetWidth / 2) + 'px'\n      jstick.style.top = e.clientY - (jstick.offsetHeight / 2) + 'px'\n      applyPosition()\n    }\n  })\n\n  jbase.addEventListener('pointerout', (e) => {\n    e.stopPropagation()\n    e.stopImmediatePropagation()\n  })\n\n  jstick.addEventListener('pointerout', (e) => {\n    e.stopPropagation()\n    e.stopImmediatePropagation()\n  })\n\n  jouter.addEventListener('pointerout', () => {\n    resetJoystickCenter()\n  })\n\n  jouter.addEventListener('pointerup', () => {\n    resetJoystickCenter()\n  })\n\n  return {\n    applyPosition,\n    resetJoystickCenter\n  }\n}\n","const physics = require('../src/game/physics')\nconst chron = require('../src/utils/chron')\n\nmodule.exports = (self, objects, controls) => {\n  const serverTick = (rubber) => {\n    if (controls.isAccelerating()) {\n      physics.accel(self, chron.timeMs() - self.accel)\n    }\n    if (controls.isBraking()) {\n      physics.brake(self)\n    }\n    if (controls.isFiring() \n      && self.fireWaitTicks <= 0\n      && !self.latched) {\n      physics.recoil(self)\n    }\n    physics.inertia(self)\n    if (!self.latched) {\n      physics.rubberband(self, rubber)\n      objects.planets = physics.getPlanets(self.posX, self.posY)\n      physics.gravityShip(self, objects.planets)\n    }\n\n    for (const ship of objects.ships) {\n      if (!ship.latched) {\n        physics.gravityShip(ship, physics.getPlanets(ship.posX, ship.posY))\n      }\n    }\n\n    for (const bullet of objects.bullets) {\n      if (bullet.type !== 'mine') {\n        physics.gravityBullet(bullet, physics.getPlanets(bullet.posX, bullet.posY))\n      }\n    }\n  }\n\n  return {\n    serverTick\n  }\n}\n","const common = require('./common')\n\nmodule.exports = (callbacks) => {\n  let dialogOpacity = 0\n  const DEBUG = false\n\n  document.getElementById('scoreanimation').style.animation = 'none'\n  document.getElementById('scoreanimation').style.visibility = 'hidden'\n  document.getElementById('powerupanimation').style.animation = 'none'\n  document.getElementById('powerupanimation').style.visibility = 'hidden'\n\n  const updateZoomText = zoom => {\n    document.getElementById('btnzoom').textContent = `zoom: ${(zoom * 100) | 0}%`\n  }\n\n  const showDialog = () => {\n    dialogOpacity = 0\n    document.getElementById('dialogbox').style.opacity = '0'\n    document.getElementById('dialog').style.display = 'flex'\n    document.getElementById('stats').style.display = 'none'\n    document.getElementById('finalscore').style.display = 'block'\n    document.body.style.position = 'absolute'\n    document.body.style.overflow = ''\n  }\n\n  const hideDialog = () => {\n    document.getElementById('dialog').style.display = 'none'\n    document.getElementById('stats').style.display = 'block'\n    document.body.style.position = 'relative'\n    document.body.style.overflow = 'hidden'\n  }\n\n  const hideLose = () => {\n    document.getElementById('defeat').style.display = 'none'\n    document.getElementById('defeatcrash').style.display = 'none'\n    document.getElementById('defeatplanet').style.display = 'none'\n    document.getElementById('defeatname').style.display = 'none'\n    document.getElementById('disconnected').style.display = 'none'\n    document.getElementById('finalscore').style.display = 'none'\n  }\n\n  const disconnect = () => {\n    hideLose()\n    document.getElementById('disconnected').style.display = 'inline'\n  }\n\n  const updateOpacity = (delta) => {\n    if (dialogOpacity < 1) {\n      dialogOpacity = Math.min(1, dialogOpacity + delta / 250)\n      document.getElementById('dialogbox').style.opacity = dialogOpacity\n    }\n  }\n\n  const makeTd = (text) => {\n    const td = document.createElement('td')\n    td.textContent = text\n    return td\n  }\n  \n  const makeTableRow = (lb) => {\n    const tr = document.createElement('tr')\n    tr.appendChild(makeTd(lb[0]))\n    tr.appendChild(makeTd(lb[1]))\n    return tr\n  }\n  \n  const updateLeaderboard = (leaderboard) => {\n    const leaderBoardTable = document.getElementById('leaderboard')\n    const newBody = document.createElement('tbody')\n    \n    for (let i = 0; i < Math.min(10, leaderboard.length); ++i) {\n      newBody.appendChild(makeTableRow(leaderboard[i]))\n    }\n  \n    leaderBoardTable.replaceChild(newBody, leaderBoardTable.childNodes[0])\n  }\n    \n  const formatTime = (sec) => {\n    sec = Math.floor(sec)\n    return `${0 | (sec / 60)}:${('0' + (sec % 60)).slice(-2)}`\n  }\n\n  const updateControls = (state) => {\n    if (state.dead) {\n      document.getElementById('mobilecontrols').style.display = 'none'\n    } else {\n      document.getElementById('mobilecontrols').style.display = common.isMobile() ? 'block' : 'none'\n    }\n  }\n\n  const updatePowerup = (self, state) => {\n    let resText = ''\n    if (!state.dead) {\n      if (self.item !== null) {\n        if (common.isMobile()) {\n          resText += `item: ${self.item} ([USE] to use)\\n`\n        } else {\n          resText += `item: ${self.item} ([Q] to use)\\n`\n        }\n      }\n      if (self.rubbership > 0) {\n        resText += `[${formatTime(self.rubbership / 1000)}] rubber ship\\n`\n      }\n      if (self.overdrive > 0) {\n        resText += `[${formatTime(self.overdrive / 1000)}] overdrive\\n`\n      }\n      if (self.regen > 0) {\n        resText += `[${formatTime(self.regen / 1000)}] regen\\n`\n      }\n    }\n    document.getElementById('powerupstatus').textContent = resText.trim()\n    document.getElementById('btnconsume').style.display = self.item !== null ? 'block' : 'none'\n  }\n\n  const updateOnlineStatus = (text) => {\n    document.getElementById('onlinestatus').textContent = text\n  }\n\n  const updateDebugInfo = (text) => {\n    if (!DEBUG) return\n    document.getElementById('debuginfo').textContent = text\n  }\n\n  const updateColors = (health, time) => {\n    if (health < 0.3) {\n      document.getElementById('yourscore').style.color = (time % 1000) >= 500 ? '#f88' : '#fff'\n      document.getElementById('healthbarhealth').style.background = ((time + 100) % 800) >= 400 ? '#800' : '#c00'\n    } else if (health < 0.7) {\n      const t = (health - 0.3) / 0.4 * 204\n      document.getElementById('yourscore').style.color = '#fff'\n      document.getElementById('healthbarhealth').style.background = `rgba(204,${t},${t})`\n    } else {\n      document.getElementById('yourscore').style.color = '#fff'\n      document.getElementById('healthbarhealth').style.background = '#ccc'\n    }\n  }\n\n  const updateScore = (scoreNow, scoreWas) => {\n    document.getElementById('yourscore').textContent \n      = document.getElementById('scoreanimation').textContent \n      = document.getElementById('finalscorenum').textContent \n      = scoreNow\n    if (scoreNow > scoreWas) {\n      document.getElementById('scoreanimation').style.visibility = 'visible'\n      document.getElementById('scoreanimation').style.animation = 'none'\n      document.getElementById('scoreanimation').style.animation = ''\n    }\n  }\n\n  const updatePlayerCount = (players) => {\n    document.getElementById('playerCountNum').textContent = players\n  }\n\n  const updateHealthBar = (health) => {\n    document.getElementById('healthbarhealth').style.width = `${Math.ceil(health * 200)}px`\n  }\n\n  const addDeathLog = (text) => {\n    const deathLog = document.getElementById('deathlog')\n    if (deathLog.childElementCount > 5)\n      deathLog.removeChild(deathLog.firstChild)\n    const p = document.createElement('p')\n    p.textContent = text\n    setTimeout(() => {\n      if (p.parentNode) p.parentNode.removeChild(p)\n    }, 5000)\n    deathLog.appendChild(p)\n  }\n\n  const defeatedByPlayer = (name) => {\n    hideLose()\n    document.getElementById('defeat').style.display = 'inline'\n    document.getElementById('defeatname').style.display = 'inline'\n    document.getElementById('defeatname').innerHTML = name\n  }\n\n  const defeatedByCrash = (name) => {\n    hideLose()\n    document.getElementById('defeatcrash').style.display = 'inline'\n    document.getElementById('defeatname').style.display = 'inline'\n    document.getElementById('defeatname').innerHTML = name\n  }\n\n  const defeatedByPlanet = () => {\n    hideLose()\n    document.getElementById('defeatplanet').style.display = 'inline'\n  }\n\n  const showPowerupAnimation = () => {\n    // document.getElementById('powerupanimation').style.visibility = 'visible'\n    document.getElementById('powerupanimation').style.animation = 'none'\n    document.getElementById('powerupanimation').style.animation = ''\n  }\n\n  const joiningGame = () => {\n    document.getElementById('scoreanimation').style.animation = 'none'\n    document.getElementById('scoreanimation').style.visibility = 'hidden'\n    document.getElementById('powerupanimation').style.animation = 'none'\n    document.getElementById('powerupanimation').style.visibility = 'hidden'\n    document.getElementById('btnplay').blur()\n    updateOnlineStatus('connecting')\n  }\n\n  document.getElementById('btnplay').addEventListener('click', (e) => {\n    callbacks.tryLockMouse(e)\n    callbacks.joinGame()\n  })\n  document.getElementById('btnhelp').addEventListener('click', () => {\n    document.getElementById('gamehelp').style.display = 'block'\n  })\n  document.getElementById('btnclosehelp').addEventListener('click', () => {\n    document.getElementById('gamehelp').style.display = 'none'\n  })\n  document.getElementById('btnfs').addEventListener('click', () => {\n    if (document.fullscreenElement) {\n      document.exitFullscreen()\n    } else {\n      document.documentElement.requestFullscreen()\n    }\n  })\n  document.getElementById('btnzoom').addEventListener('click', () => {\n    callbacks.nextZoom(1)\n  })\n\n  if (!DEBUG)\n    document.getElementById('debuginfo').style.display = 'none'\n\n  return {\n    updateZoomText,\n    updatePowerup,\n    showDialog,\n    hideDialog,\n    hideLose,\n    disconnect,\n    updateControls,\n    updateOpacity,\n    updateLeaderboard,\n    updateOnlineStatus,\n    updateDebugInfo,\n    updateColors,\n    updateScore,\n    updatePlayerCount,\n    updateHealthBar,\n    showPowerupAnimation,\n    defeatedByPlayer,\n    defeatedByCrash,\n    defeatedByPlanet,\n    joiningGame,\n    addDeathLog,\n  }\n}\n","/*! js-cookie v3.0.1 | MIT */\n;\n(function (global, factory) {\n  typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\n  typeof define === 'function' && define.amd ? define(factory) :\n  (global = global || self, (function () {\n    var current = global.Cookies;\n    var exports = global.Cookies = factory();\n    exports.noConflict = function () { global.Cookies = current; return exports; };\n  }()));\n}(this, (function () { 'use strict';\n\n  /* eslint-disable no-var */\n  function assign (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n      for (var key in source) {\n        target[key] = source[key];\n      }\n    }\n    return target\n  }\n  /* eslint-enable no-var */\n\n  /* eslint-disable no-var */\n  var defaultConverter = {\n    read: function (value) {\n      if (value[0] === '\"') {\n        value = value.slice(1, -1);\n      }\n      return value.replace(/(%[\\dA-F]{2})+/gi, decodeURIComponent)\n    },\n    write: function (value) {\n      return encodeURIComponent(value).replace(\n        /%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,\n        decodeURIComponent\n      )\n    }\n  };\n  /* eslint-enable no-var */\n\n  /* eslint-disable no-var */\n\n  function init (converter, defaultAttributes) {\n    function set (key, value, attributes) {\n      if (typeof document === 'undefined') {\n        return\n      }\n\n      attributes = assign({}, defaultAttributes, attributes);\n\n      if (typeof attributes.expires === 'number') {\n        attributes.expires = new Date(Date.now() + attributes.expires * 864e5);\n      }\n      if (attributes.expires) {\n        attributes.expires = attributes.expires.toUTCString();\n      }\n\n      key = encodeURIComponent(key)\n        .replace(/%(2[346B]|5E|60|7C)/g, decodeURIComponent)\n        .replace(/[()]/g, escape);\n\n      var stringifiedAttributes = '';\n      for (var attributeName in attributes) {\n        if (!attributes[attributeName]) {\n          continue\n        }\n\n        stringifiedAttributes += '; ' + attributeName;\n\n        if (attributes[attributeName] === true) {\n          continue\n        }\n\n        // Considers RFC 6265 section 5.2:\n        // ...\n        // 3.  If the remaining unparsed-attributes contains a %x3B (\";\")\n        //     character:\n        // Consume the characters of the unparsed-attributes up to,\n        // not including, the first %x3B (\";\") character.\n        // ...\n        stringifiedAttributes += '=' + attributes[attributeName].split(';')[0];\n      }\n\n      return (document.cookie =\n        key + '=' + converter.write(value, key) + stringifiedAttributes)\n    }\n\n    function get (key) {\n      if (typeof document === 'undefined' || (arguments.length && !key)) {\n        return\n      }\n\n      // To prevent the for loop in the first place assign an empty array\n      // in case there are no cookies at all.\n      var cookies = document.cookie ? document.cookie.split('; ') : [];\n      var jar = {};\n      for (var i = 0; i < cookies.length; i++) {\n        var parts = cookies[i].split('=');\n        var value = parts.slice(1).join('=');\n\n        try {\n          var foundKey = decodeURIComponent(parts[0]);\n          jar[foundKey] = converter.read(value, foundKey);\n\n          if (key === foundKey) {\n            break\n          }\n        } catch (e) {}\n      }\n\n      return key ? jar[key] : jar\n    }\n\n    return Object.create(\n      {\n        set: set,\n        get: get,\n        remove: function (key, attributes) {\n          set(\n            key,\n            '',\n            assign({}, attributes, {\n              expires: -1\n            })\n          );\n        },\n        withAttributes: function (attributes) {\n          return init(this.converter, assign({}, this.attributes, attributes))\n        },\n        withConverter: function (converter) {\n          return init(assign({}, this.converter, converter), this.attributes)\n        }\n      },\n      {\n        attributes: { value: Object.freeze(defaultAttributes) },\n        converter: { value: Object.freeze(converter) }\n      }\n    )\n  }\n\n  var api = init(defaultConverter, { path: '/' });\n  /* eslint-enable no-var */\n\n  return api;\n\n})));\n","const geom = require('../utils/geom')\nconst physics = require('./physics')\nconst Counter = require('../utils/counter')\nconst bulletCounter = new Counter()\n\nconst BULLET_DAMAGE_MULTIPLIER = 0.115\n\nconst newBullet = () => ({\n  posX: 0, posY: 0,           // position X, Y\n  velX: 0, velY: 0,           // velocity X, Y\n  dist: 0,                    // distance taken\n  velocity: 0,\n  shooter: null,\n  shooterName: '',\n  isHit: false,\n  canPickUp: true,\n  type: 'bullet',\n  damage: 1,\n\n  dead: false,\n  _id: bulletCounter.next()\n})\n\nconst bulletFields = [\n  '_id', 'dead', 'posX', 'posY', 'velX', 'velY', 'dist', 'velocity',\n  'shooter', 'shooterName', 'isHit', 'canPickUp', 'type', 'damage'\n]\n\nconst bulletSystemFactory = handler => {\n  let bullets = {}\n\n  const getBullets = () => Object.values(bullets)\n\n  const getBulletsById = (ids) => ids.map(id => bullets[id])\n\n  const removeBullet = (bullet) => {\n    bullet.dead = true\n    delete bullets[bullet._id]\n    handler.onBulletDeleted(bullet)\n  }\n\n  const handleShipBulletCollision = (ships, ship, bullet) => {\n    if (bullet.dead) {\n      return\n    }\n    const shooter = ships.getShipById(bullet.shooter)\n    if (shooter && shooter.absorber) {\n      shooter.health += 0.01 * shooter.healthMul\n    }\n    ships.damageShip(ship, BULLET_DAMAGE_MULTIPLIER * bullet.damage, bullet, shooter, handler.killShipByBullet)\n    if (bullet.type !== 'laser') {\n      removeBullet(bullet)\n    }\n  }\n\n  const handlePowerupBulletCollision = (ships, powerup, bullet, powerups) => {\n    if (bullet.dead) {\n      return\n    }\n    const shooter = ships.getShipById(bullet.shooter)\n    if (shooter) {\n      powerups.applyPowerup(shooter, powerup)\n    }\n    if (bullet.type !== 'laser') {\n      removeBullet(bullet)\n    }\n  }\n\n  const removeMinesBy = ship => {\n    const shipId = ship._id\n    const projList = getBullets()\n    const projCount = projList.length\n    for (let i = 0; i < projCount; ++i) {\n      const bullet = projList[i]\n      if (bullet.type === 'mine' && bullet.shooter === shipId) {\n        removeBullet(bullet)\n      }\n    }\n  }\n\n  const moveBullets = (delta, ships, powerups) => {\n    const shipList = ships.getShips()\n    const powerupList = powerups.getPowerups()\n    const bulletList = getBullets()\n    const shipCount = shipList.length\n    const powerupCount = powerupList.length\n    const bulletCount = bulletList.length\n\n    for (let i = 0; i < bulletCount; ++i) {\n      const bullet = bulletList[i]\n      if (bullet.dist > physics.MAX_BULLET_DISTANCE) {\n        removeBullet(bullet)\n        continue\n      }\n\n      if (bullet.type == 'bullet' || bullet.type == 'laser') {\n        physics.gravityBullet(bullet, physics.getPlanets(bullet.posX, bullet.posY))\n\n        const newX = bullet.posX + delta * bullet.velX\n        const newY = bullet.posY + delta * bullet.velY\n\n        let collisionShip = null\n        for (let j = 0; j < shipCount; ++j) {\n          const ship = shipList[j]\n          if (ship._id !== bullet.shooter\n            && Math.abs(ship.posX - bullet.posX) < bullet.velocity\n            && Math.abs(ship.posY - bullet.posY) < bullet.velocity) {\n            const t = geom.closestSynchroDistance(\n              [ship.posX, ship.posY],\n              [ship.posXnew, ship.posYnew],\n              [bullet.posX, bullet.posY],\n              [newX, newY])\n            if (0 <= t && t <= 1) {\n              ship.posX = geom.lerp1D(ship.posX, t, ship.posXnew)\n              ship.posY = geom.lerp1D(ship.posY, t, ship.posYnew)\n              const [p1, p2, p3] = geom.getCollisionPoints(ship)\n              if (geom.lineIntersectsTriangle([bullet.posX, bullet.posY],\n                [newX, newY], p1, p2, p3)) {\n                collisionShip = ship\n                break\n              }\n            }\n          }\n        }\n\n        if (collisionShip) {\n          handleShipBulletCollision(ships, collisionShip, bullet)\n        }\n\n        let collisionPowerup = null\n        if (bullet.canPickUp) {\n          for (let j = 0; j < powerupCount; ++j) {\n            const powerup = powerupList[j]\n            if (Math.abs(powerup.posX - bullet.posX) < bullet.velocity &&\n                Math.abs(powerup.posY - bullet.posY) < bullet.velocity) {\n              const r = powerup.pickupRadius * 0.35\n              const a1 = [\n                powerup.posX - (bullet.posY - powerup.posY) * r,\n                powerup.posY - (powerup.posX - bullet.posX) * r\n              ]\n              const a2 = [\n                powerup.posX + (bullet.posY - powerup.posY) * r,\n                powerup.posY + (powerup.posX - bullet.posX) * r\n              ]\n              if (geom.lineIntersectsLine([bullet.posX, bullet.posY],\n                [newX, newY], a1, a2)) {\n                collisionPowerup = powerup\n                break\n              }\n            }\n          }\n        }\n\n        if (collisionPowerup) {\n          handlePowerupBulletCollision(ships, collisionPowerup, bullet, powerups)\n        }\n        \n        let hitPlanet = false\n        const planets = physics.getPlanets(newX, newY)\n        for (const planet of planets) {\n          if (Math.hypot(planet.x - newX, planet.y - newY) < planet.radius) {\n            hitPlanet = true\n            break\n          }\n        }\n\n        if (hitPlanet) {\n          removeBullet(bullet)\n          continue\n        }\n\n        bullet.posX = newX\n        bullet.posY = newY\n        bullet.dist += delta * bullet.velocity\n      } else if (bullet.type == 'mine') {\n        const r = 3 + 7 * Math.random() ** 3\n        let primerShip = null\n        \n        for (let j = 0; j < shipCount; ++j) {\n          const ship = shipList[j]\n          if (!ship.dead && bullet.shooter !== ship._id &&\n              Math.hypot(ship.posX - bullet.posX,\n                ship.posY - bullet.posY) < r) {\n            primerShip = ship\n            break\n          }\n        }\n\n        if (primerShip || bullet.isHit) {\n          // blow up the mine\n          shipList.forEach(ship => {\n            if (bullet.shooter === ship._id) return\n            if (Math.abs(ship.posX - bullet.posX) > 15 ||\n              Math.abs(ship.posY - bullet.posY) > 15) {\n              return\n            }\n\n            let damage = 2 / Math.sqrt(Math.hypot(\n              ship.posX - bullet.posX, ship.posY - bullet.posY))\n\n            if (damage < 0.05) {\n              damage = 0\n            }\n\n            const shooter = ships.getShipById(bullet.shooter)\n            ships.damageShip(ship, damage, bullet, shooter, handler.killShipByBullet)\n          })\n\n          handler.onMineExplode(bullet)\n          removeBullet(bullet)\n          continue\n        }\n\n        bullet.dist += physics.MAX_BULLET_DISTANCE / (physics.MINE_LIFETIME * physics.TICKS_PER_SECOND)\n      }\n    }\n  }\n\n  const addProjectile = (ship, type, extras) => {\n    const [p1, , , ] = geom.getShipPoints(ship)\n    const { \n      extraDist, \n      orientOffset, \n      speedFactor,\n      damageFactor, \n      rangeSub,\n      canPickUp } = { \n      extraDist: 0,\n      orientOffset: 0,\n      speedFactor: 1,\n      damageFactor: 1,\n      rangeSub: 0,\n      canPickUp: true,\n      ...(extras || {}) }\n\n    let typeSpeedMul = 1\n    if (type == 'mine') {\n      typeSpeedMul = 0\n    }\n\n    let bullet = newBullet()\n    bullet = {\n      ...bullet,\n      posX: p1[0] + Math.sin(-ship.orient + orientOffset) * extraDist,\n      posY: p1[1] + Math.cos(-ship.orient + orientOffset) * extraDist,\n      type: type,\n      velocity: physics.BULLET_VELOCITY * ship.bulletSpeedMul * speedFactor + Math.hypot(ship.velX, ship.velY),\n      velX: typeSpeedMul * physics.BULLET_VELOCITY * Math.sin(-ship.orient + orientOffset) * ship.bulletSpeedMul + ship.velX,\n      velY: typeSpeedMul * physics.BULLET_VELOCITY * Math.cos(-ship.orient + orientOffset) * ship.bulletSpeedMul + ship.velY,\n      dist: rangeSub,\n      damage: damageFactor,\n      canPickUp: canPickUp,\n      shooter: ship._id,\n      shooterName: ship.name\n    }\n    bullets[bullet._id] = bullet\n    return bullet\n  }\n\n  return {\n    getBullets,\n    getBulletsById,\n    moveBullets,\n    addProjectile,\n    removeBullet,\n    removeMinesBy\n  }\n}\n\nmodule.exports = {\n  system: bulletSystemFactory,\n  fields: bulletFields,\n}\n","const GRAV = 6.67e-11\nconst TICKS_PER_SECOND = 25\nconst MS_PER_TICK = 1000 / TICKS_PER_SECOND\nconst MAX_SHIP_VELOCITY = 64 / TICKS_PER_SECOND\nconst ACTUAL_MAX_SHIP_VELOCITY = MAX_SHIP_VELOCITY * 2.5\nconst MIN_SHIP_VELOCITY = 0.01\nconst LATCH_VELOCITY = 0.33\nconst BULLET_VELOCITY = MAX_SHIP_VELOCITY * 1.75\nconst BRAKE_MUL = (MIN_SHIP_VELOCITY / MAX_SHIP_VELOCITY) ** (1 / (TICKS_PER_SECOND * 1.5))\nconst VIEW_DISTANCE = 55\nconst MAX_BULLET_DISTANCE = 75\nconst RUBBERBAND_BUFFER = 80\nconst RUBBERBAND_RADIUS_MUL = 80\nconst MINE_LIFETIME = 60\nconst INERTIA_MUL = 1\n// (MIN_SHIP_VELOCITY / MAX_SHIP_VELOCITY) ** (1 / (TICKS_PER_SECOND * 90))\n\nconst LCG = require('../utils/lcg')\nconst geom = require('../utils/geom')\nconst PLANET_CHUNK_SIZE = VIEW_DISTANCE * 1.6 + 1\nconst lcg = new LCG(0)\n\nlet PLANET_SEED = 1340985553\n\nconst getAccelMul = (accelTimeMs) => { // time in milliseconds\n  return 0.0875 + 0.000025 * Math.min(accelTimeMs, 2500)\n}\n\nconst checkMinVelocity = (ship) => {\n  const v = Math.hypot(ship.velX, ship.velY)\n  if (v <= MIN_SHIP_VELOCITY) {\n    ship.velX = 0\n    ship.velY = 0\n  }\n}\n\nconst checkMaxVelocity = (ship) => {\n  const maxvel = ACTUAL_MAX_SHIP_VELOCITY * healthToVelocity(ship.health) * ship.speedMul\n  const v = Math.hypot(ship.velX, ship.velY)\n  if (v > maxvel) {\n    ship.velX *= maxvel / v\n    ship.velY *= maxvel / v\n  }\n}\n\nconst getPlanetSeed = () => {\n  return PLANET_SEED\n}\n\nconst setPlanetSeed = (seed) => {\n  PLANET_SEED = seed\n}\n\nconst newPlanetSeed = () => {\n  PLANET_SEED = Math.floor(Math.random() * 2147483647)\n}\n\n// planet: x, y, radius, seed\nconst getPlanetsForChunk = (cx, cy) => {\n  const r = PLANET_CHUNK_SIZE\n  const xb = (cx + 0.5) * r\n  const yb = (cy + 0.5) * r\n\n  lcg.reseed((PLANET_SEED ^ (cx * 1173320513) ^ (cy * 891693747)) & 0xFFFFFFFF)\n  \n  const xo = lcg.randomOffset() * (r / 4)\n  const yo = lcg.randomOffset() * (r / 4)\n  const radius = (r / 20) + (r / 12) * lcg.random()\n  const seed = lcg.randomInt()\n  return [ { x: xb + xo, y: yb + yo, radius, seed } ]\n}\n\nconst getPlanets = (x, y) => {\n  const x0 = Math.floor(x / PLANET_CHUNK_SIZE)\n  const y0 = Math.floor(y / PLANET_CHUNK_SIZE)\n\n  const xu = [x0 - 2, x0 - 1, x0, x0 + 1, x0 + 2]\n  const yu = [y0 - 2, y0 - 1, y0, y0 + 1, y0 + 2]\n  let planets = []\n\n  for (const x of xu) {\n    for (const y of yu) {\n      planets = [...planets, ...getPlanetsForChunk(x, y)]\n    }\n  }\n  \n  return planets\n}\n\nconst hasOverdrive = (ship) => {\n  return ship.overdrive > 0\n}\n\nconst hasRubbership = (ship) => {\n  return ship.rubbership > 0\n}\n\nconst hasRegen = (ship) => {\n  return ship.regen > 0\n}\n\nconst accel = (ship, accelTimeMs) => {\n  let accelMul = getAccelMul(accelTimeMs) * healthToVelocity(ship.health)\n    * ship.thrustBoost\n    * (hasOverdrive(ship) ? 2 : 1) * (ship.highAgility ? 1.33 : 1)\n  if (ship.speedMul !== 1) {\n    accelMul *= Math.sqrt(ship.speedMul)\n  }\n  ship.velX += accelMul * Math.sin(-ship.orient)\n  ship.velY += accelMul * Math.cos(-ship.orient)\n  checkMaxVelocity(ship)\n}\n\nconst inertia = (ship) => {\n  ship.velX *= INERTIA_MUL\n  ship.velY *= INERTIA_MUL\n  checkMinVelocity(ship)\n}\n\nconst brake = (ship) => {\n  ship.velX *= BRAKE_MUL\n  ship.velY *= BRAKE_MUL\n  checkMinVelocity(ship)\n}\n\nconst recoil = (ship) => {\n  ship.velX -= 0.017 * Math.sin(-ship.orient)\n  ship.velY -= 0.017 * Math.cos(-ship.orient)\n  checkMaxVelocity(ship)\n}\n\nconst gravityBullet = (bullet, planets) => {\n  if (bullet.type == 'mine') {\n    return\n  }\n\n  for (const planet of planets) {\n    const d = Math.hypot(bullet.posX - planet.x, bullet.posY - planet.y)\n    if (d > (planet.radius + 1) && d < 10 + planet.radius * 4) {\n      const dx = planet.x - bullet.posX\n      const dy = planet.y - bullet.posY\n      const r2 = Math.hypot(dx, dy) ** 2\n      const f = GRAV * 1.5e+10 / r2 * planet.radius\n      bullet.velX += f * dx\n      bullet.velY += f * dy\n    }\n  }\n  const d = Math.hypot(bullet.velX, bullet.velY)\n  bullet.velX *= bullet.velocity / d\n  bullet.velY *= bullet.velocity / d\n}\n\nconst gravityShip = (ship, planets) => {\n  let thrust = 1\n  const vector = [Math.sin(-ship.orient), Math.cos(-ship.orient)]\n  const dv = Math.hypot(ship.velX, ship.velY)\n  for (const planet of planets) {\n    const d = Math.hypot(ship.posX - planet.x, ship.posY - planet.y)\n    if (d > (planet.radius + 1.5 + dv * 0.3) && d < 10 + planet.radius * 4) {\n      const dx = planet.x - ship.posX\n      const dy = planet.y - ship.posY\n      const r2 = Math.hypot(dx, dy) ** 2\n      const f = GRAV * 1e+9 * planet.radius / r2 / (\n        (ship.accel !== null || ship.brake !== null) ? 5 : 1)\n      ship.velX += f * dx\n      ship.velY += f * dy\n      if (ship.accel !== null) {\n        const direction = geom.normalize(dx, dy)\n        thrust += 3 * (Math.min(1, dv / MAX_SHIP_VELOCITY) ** 0.5) *\n          (1000 * Math.max(0, f * (direction[0] * vector[0]\n                                 + direction[1] * vector[1]))) ** 1.5\n      }\n    }\n  }\n  ship.thrustBoost = thrust\n  checkMaxVelocity(ship)\n}\n\nconst getRubberbandRadius = (playerCount) => {\n  return RUBBERBAND_RADIUS_MUL * Math.pow(Math.max(playerCount, 1), 0.75)\n}\n\nconst rubberband = (ship, radius) => {\n  const distCenter = Math.hypot(ship.posX, ship.posY)\n  if (distCenter > radius) {\n    const maxRadius = radius + RUBBERBAND_BUFFER\n    const baseX = -ship.posX / Math.hypot(ship.posX, ship.posY)\n    const baseY = -ship.posY / Math.hypot(ship.posX, ship.posY)\n    const d = (distCenter - radius) / (maxRadius - radius)\n    ship.velX += baseX * 0.3 * MAX_SHIP_VELOCITY * (1.1 * d) ** 8\n    ship.velY += baseY * 0.3 * MAX_SHIP_VELOCITY * (1.1 * d) ** 8\n    const v = Math.hypot(ship.velX, ship.velY)\n    if (v > MAX_SHIP_VELOCITY) {\n      const nv = geom.lerp1D(v, 0.05, MAX_SHIP_VELOCITY)\n      ship.velX *= nv / v\n      ship.velY *= nv / v\n    }\n    checkMaxVelocity(ship)\n  }\n}\n\nconst healthToVelocity = (health) => {\n  return 0.7 + 0.3 * health\n}\n\nmodule.exports = {\n  TICKS_PER_SECOND,\n  MAX_SHIP_VELOCITY,\n  ACTUAL_MAX_SHIP_VELOCITY,\n  MS_PER_TICK,\n  BULLET_VELOCITY,\n  LATCH_VELOCITY,\n  VIEW_DISTANCE,\n  MAX_BULLET_DISTANCE,\n  PLANET_CHUNK_SIZE,\n  RUBBERBAND_BUFFER,\n  MINE_LIFETIME,\n  hasOverdrive,\n  hasRubbership,\n  hasRegen,\n  accel,\n  inertia,\n  brake,\n  recoil,\n  gravityBullet,\n  gravityShip,\n  rubberband,\n  getPlanets,\n  getPlanetSeed,\n  setPlanetSeed,\n  newPlanetSeed,\n  getRubberbandRadius,\n  healthToVelocity }\n","const chron = require('../utils/chron')\nconst physics = require('./physics')\nconst Counter = require('../utils/counter')\nconst powerupCounter = new Counter()\n\nconst newPowerup = () => ({\n  posX: 0, posY: 0,           // position X, Y\n  despawn: chron.timeMs() + 15000,\n  pickupRadius: 3.5,\n  pickupDist: 100,\n  pickupPlayer: null,\n  \n  dead: false,\n  _id: powerupCounter.next()\n})\n\nconst powerupFields = [\n  '_id', 'dead', 'posX', 'posY', 'despawn',\n  'pickupRadius', 'pickupDist', 'pickupPlayer'\n]\n\nconst powerupSystemFactory = handler => {\n  let powerups = {}\n  let nextPowerup = null\n\n  const getPowerups = () => Object.values(powerups)\n\n  const clear = () => powerups = {}\n\n  const trySpawnPowerup = (playerCount, ships, radius) => {\n    let tries = playerCount * 4\n    let count = 0\n    while (tries > 0) {\n      const r = Math.sqrt(Math.random()) * (radius + 5)\n      const theta = Math.random() * 2 * Math.PI\n\n      const x = Math.sin(theta) * r\n      const y = Math.cos(theta) * r\n      \n      const playerDist = Math.min.apply(null, ships.getShips().map(\n        ship => Math.hypot(ship.posX - x, ship.posY - y)\n      ))\n      const inPlanet = Math.min.apply(null, physics.getPlanets(x, y).map(\n        planet => Math.hypot(planet.x - x, planet.y - y) - planet.radius\n      )) <= 2\n      const tooClose = Math.min.apply(null, getPowerups().map(\n        powerup => Math.hypot(powerup.x - x, powerup.y - y) - 4\n      )) <= 0\n\n      if (Math.random() < 0.2 && playerDist >= 30 && !inPlanet && !tooClose) {\n        let powerup = newPowerup()\n        powerup = {\n          ...powerup,\n          posX: x,\n          posY: y\n        }\n        powerups[powerup._id] = powerup\n        handler.onPowerupSpawned(powerup)\n        ++count\n      }\n      --tries\n    }\n    return count\n  }\n\n  const setNextPowerupTime = (ships, division) => {\n    const playerCount = Math.max(1, ships.getShipCount())\n    nextPowerup = chron.timeMs() + (1000 * (10 + 18 * Math.random()) / Math.pow(playerCount, 0.125) / division)\n  }\n\n  const maybeSpawnPowerup = (ships, radius) => {\n    const playerCount = Math.max(1, ships.getShipCount())\n    let division = 1\n    if (nextPowerup != null && chron.timeMs() >= nextPowerup) {\n      division = trySpawnPowerup(playerCount, ships, radius) > 0 ? 1 : 8\n      setNextPowerupTime(ships, division)\n    } else if (nextPowerup == null) {\n      setNextPowerupTime(ships, division)\n    }\n  }\n\n  const applyPowerup = (ship, powerup) => {\n    const ITEM_COUNT = 9\n    const item = 0 | (ITEM_COUNT * Math.random())\n    switch (item) {\n    case 0:\n      if (ship.item === null) {\n        ship.item = 'laser'\n      }\n      break\n    case 1:\n      if (ship.item === null) {\n        ship.item = 'reheal'\n      }\n      break\n    case 2:\n      if (ship.item === null) {\n        ship.item = 'bomb'\n      }\n      break\n    case 3:\n      if (ship.item === null) {\n        ship.item = 'mine'\n      }\n      break\n    case 4:\n      if (ship.item === null) {\n        ship.item = 'orion'\n      }\n      break\n    case 5:\n      ship.rubbership = 30 * 1000\n      break\n    case 6:\n      ship.regen = 10 * 1000\n      break\n    case 7:\n      ship.overdrive = 10 * 1000\n      break\n    case 8:\n      if (ship.item === null) {\n        ship.item = 'spread'\n      }\n      break\n    }\n    removePowerup(powerup)\n  }\n\n  const updateClosestPlayer = (powerup, ship, t) => {\n    if (powerup.pickupDist > t) {\n      powerups[powerup._id].pickupDist = t\n      powerups[powerup._id].pickupPlayer = ship._id\n    }\n  }\n\n  const removePowerup = (powerup) => {\n    delete powerups[powerup._id]\n    handler.onPowerupDeleted(powerup)\n  }\n\n  const updatePowerups = (ships) => {\n    const now = chron.timeMs()\n    getPowerups().forEach((powerup) => {\n      if (now >= powerup.despawn) {\n        removePowerup(powerup)\n        return\n      }\n\n      if (powerup.pickupPlayer !== null) {\n        const ship = ships.getShipById(powerup.pickupPlayer)\n        if (ship !== null && !ship.dead) {\n          applyPowerup(ship, powerup)\n          return\n        } else {\n          powerup.pickupDist = 10000\n          powerup.pickupPlayer = null\n        }\n      }\n    })\n  }\n\n  return {\n    getPowerups,\n    clear,\n    applyPowerup,\n    updateClosestPlayer,\n    maybeSpawnPowerup,\n    removePowerup,\n    updatePowerups\n  }\n}\n\nmodule.exports = {\n  system: powerupSystemFactory,\n  fields: powerupFields,\n}\n","const geom = require('../utils/geom')\nconst chron = require('../utils/chron')\nconst physics = require('./physics')\nconst maths = require('../utils/maths')\nconst Counter = require('../utils/counter')\nconst shipCounter = new Counter()\n\nconst SHIP_RECT_RADIUS = 2\nconst SHIP_RADIUS = 1.35\n\nconst newShip = () => ({\n  posX: 0, posY: 0,           // position X, Y\n  velX: 0, velY: 0,           // velocity X, Y\n  orient: 0,                  // radians, clockwise from 0 = up\n  health: 1,                  // 0 = no health, 1 = max health\n\n  name: '',\n  score: 0,\n  accel: null,\n  brake: null,\n  firing: false,\n  latched: false,\n  fireWaitTicks: 0,\n  thrustBoost: 1,\n\n  // perks\n  firingInterval: 4,\n  bulletSpeedMul: 1.0,\n  healthMul: 1.0,\n  speedMul: 1.0,\n  planetDamageMul: 1.0,\n  highAgility: false,\n  absorber: false,\n  healRate: 1,\n\n  // powerups\n  item: null,\n  rubbership: 0,\n  regen: 0,\n  overdrive: 0,\n\n  lastDamageAt: null,\n  lastDamageBy: null,\n\n  dead: false,\n  _id: shipCounter.next()\n})\n\nconst shipFields = [\n  '_id', 'dead', 'posX', 'posY', 'velX', 'velY', 'orient', 'health',\n  'name', 'score', 'accel', 'brake', 'firing', 'latched', 'fireWaitTicks',\n  'thrustBoost',\n  'firingInterval', 'bulletSpeedMul', 'healthMul', 'speedMul', 'planetDamageMul',\n  'highAgility', 'absorber', 'healRate', 'item', 'rubbership', 'regen', 'overdrive'\n]\n\nconst shipSystemFactory = handler => {\n  let ships = {}\n\n  const getShips = () => Object.values(ships)\n  const getShipById = id => ships[id]\n  const getShipCount = () => Object.keys(ships).length\n  const removeShipById = id => delete ships[id]\n\n  const newPlayerShip = (radius, bullets) => {\n    const ship = newShip()\n    spawn(ship, radius, bullets)\n    ships[ship._id] = ship\n    return ship\n  }\n\n  const latchToPlanet = (ship, planet) => {\n    const planetAngle = Math.atan2(planet.x - ship.posX,\n      planet.y - ship.posY) + Math.PI\n    latchToPlanetWithAngle(ship, planet, planetAngle)\n  }\n\n  const computePlanetPoint = (planet, angle) => {\n    return [planet.x + (planet.radius + 1.4) * Math.sin(angle),\n      planet.y + (planet.radius + 1.4) * Math.cos(angle)]\n  }\n\n  const latchToPlanetWithAngle = (ship, planet, angle) => {\n    const [x, y] = computePlanetPoint(planet, angle)\n    ship.velX = 0\n    ship.velY = 0\n    ship.posX = x\n    ship.posY = y\n    ship.orient = -angle\n    ship.latched = ship.accel === null\n    handler.onShipLatch(ship)\n  }\n\n  const spawnLone = (ship, radius) => {\n    let baseX = physics.VIEW_DISTANCE * maths.randomSign() * Math.random()\n    let baseY = physics.VIEW_DISTANCE * maths.randomSign() * Math.random()\n    \n    let planets = physics.getPlanets(baseX, baseY)\n    planets = planets.filter(planet =>\n      Math.hypot(planet.x, planet.y) < radius - planet.radius)\n    if (planets.length < 1) {\n      ship.posX = baseX\n      ship.posY = baseY\n      ship.orient = 0\n      return\n    }\n\n    const planet = planets[0 | (planets.length * Math.random())]\n    latchToPlanetWithAngle(ship, planet, Math.random() * 2 * Math.PI)\n  }\n\n  const spawn = (ship, radius, bullets) => {\n    const playerKeys = Object.keys(ships)\n    const playerCount = playerKeys.length\n    let baseX = 0\n    let baseY = 0\n    if (playerCount < 1) {\n      return spawnLone(ship, radius)\n    }\n\n    let tries = 64\n    \n    while (--tries > 0) {\n      const randShip = ships[playerKeys[(playerCount * Math.random()) | 0]]\n      baseX = randShip.posX\n      baseY = randShip.posY\n      baseX += physics.VIEW_DISTANCE * maths.randomSign()\n      baseY += physics.VIEW_DISTANCE * maths.randomSign()\n      if (Math.hypot(baseX, baseY) < radius - physics.PLANET_CHUNK_SIZE / 8) {\n        break\n      }\n      if (tries < 8) {\n        if (Math.hypot(baseX, baseY) < radius) {\n          break\n        }\n      }\n    }\n\n    let planets = physics.getPlanets(baseX, baseY)\n    planets = planets.filter(planet =>\n      Math.hypot(planet.x, planet.y) < radius - (planet.radius - 3))\n    if (planets.length < 1) {\n      ship.posX = baseX + physics.VIEW_DISTANCE * maths.randomSign()\n      ship.posY = baseY + physics.VIEW_DISTANCE * maths.randomSign()\n      ship.orient = 0\n      return\n    }\n    \n    planets.forEach(planet => {\n      planet.playerDist = Math.min.call(null, \n        getShips().map(ship => \n          Math.hypot(ship.posX - planet.x, ship.posY - planet.y)))\n      planet.bulletDist = Math.min.call(null, \n        bullets.getBullets().map(bullet => \n          Math.hypot(bullet.posX - planet.x, bullet.posY - planet.y)))\n    })\n\n    const ideal = planets.find(planet => \n      planet.playerDist > physics.VIEW_DISTANCE \n      && planet.bulletDist > physics.MAX_BULLET_DISTANCE)\n\n    if (ideal) {\n      latchToPlanetWithAngle(ship, ideal, Math.random() * 2 * Math.PI)\n      return\n    }\n\n    const testPlanet = (a, b) => (\n      a.playerDist + a.bulletDist * 1.5 > b.playerDist + b.bulletDist * 1.5\n    )\n    const mostIdeal = planets.reduce((a, b) => \n      (testPlanet(a, b) ? a : b)\n    )\n\n    // pick optimal angle\n    const angleOffset = Math.random() * 2 * Math.PI\n    let minimalScore = 0\n    let angle = 0\n    for (let i = 0; i < 8; ++i) {\n      const testAngle = angleOffset + i * Math.PI / 4\n      const [x, y] = computePlanetPoint(mostIdeal, testAngle)\n      const score = Math.min.call(null, \n        getShips().map(ship => \n          Math.hypot(ship.posX - x, ship.posY - y)))\n        + Math.min.call(null, \n          bullets.getBullets().map(bullet => \n            Math.hypot(bullet.posX - x, bullet.posY - y)))\n      if (minimalScore < score) {\n        minimalScore = score\n        angle = testAngle\n      }\n    }\n\n    latchToPlanetWithAngle(ship, mostIdeal, angle)\n  }\n\n  const doFire = (ship) => {\n    if (!ship || ship.dead !== false) {\n      return false\n    }\n\n    if (ship.fireWaitTicks <= 0) {\n      handler.addProjectile(ship, 'bullet')\n      ship.fireWaitTicks = ship.firingInterval\n      return true\n    }\n    return false\n  }\n\n  const shipAcceleration = (delta, radius, radiusGoal) => {\n    const now = chron.timeMs()\n    const shipList = getShips()\n    for (let i = 0, shipCount = shipList.length; i < shipCount; ++i) {\n      const ship = shipList[i]\n      let doAccel = false\n      let doBrake = false\n  \n      if (ship.accel != null && ship.brake != null) {\n        if (ship.accel > ship.brake) {\n          doAccel = true\n        } else {\n          doBrake = true\n        }\n      } else if (ship.accel != null) {\n        doAccel = true\n      } else if (ship.brake != null) {\n        doBrake = true\n      }\n  \n      if (doAccel) {\n        physics.accel(ship, now - ship.accel)\n        ship.latched = false\n      } else if (doBrake) {\n        physics.brake(ship)\n      }\n      if (ship.firing) {\n        if (doFire(ship) && !ship.latched) {\n          physics.recoil(ship)\n        }\n      }\n  \n      physics.inertia(ship)\n      if (!ship.latched) {\n        physics.rubberband(ship, radius)\n      } else {\n        ship.velX = ship.velY = 0\n        if (Math.hypot(ship.posX, ship.posY) > (radius + 10) \n          && radiusGoal < radius) {\n          ship.latched = false\n          ship.velX += Math.sin(-ship.orient)\n          ship.velY += Math.cos(-ship.orient)\n        }\n      }\n      if (ship.latched && ship.health < 1) {\n        ship.health = Math.min(1, ship.health + ship.healthMul * ship.healRate * 1 / (20 * physics.TICKS_PER_SECOND))\n      }\n      if (physics.hasRegen(ship)) {\n        ship.health = Math.min(1, ship.health + ship.healthMul * ship.healRate * 1.5 / (20 * physics.TICKS_PER_SECOND))\n      }\n      ship.fireWaitTicks = Math.max(0, ship.fireWaitTicks - (physics.hasOverdrive(ship) ? 2 : 1))\n      ship.regen = Math.max(0, ship.regen - physics.MS_PER_TICK)\n      ship.overdrive = Math.max(0, ship.overdrive - physics.MS_PER_TICK)\n      ship.rubbership = Math.max(0, ship.rubbership - physics.MS_PER_TICK)\n      \n      if (!ship.latched) {\n        physics.gravityShip(ship, physics.getPlanets(ship.posX, ship.posY))\n      }\n    }\n  }\n\n  const premoveShips = (delta) => {\n    const shipList = getShips()\n    const shipCount = shipList.length\n\n    for (let i = 0; i < shipCount; ++i) {\n      const ship1 = shipList[i]\n      ship1.posXnew = ship1.posX + delta * ship1.velX\n      ship1.posYnew = ship1.posY + delta * ship1.velY\n    }\n  }\n\n  const moveShips = (delta, powerups) => {\n    const shipList = getShips()\n    const powerupList = powerups.getPowerups()\n    const shipCount = shipList.length\n    const powerupCount = powerupList.length\n    const dist = physics.ACTUAL_MAX_SHIP_VELOCITY + 1\n\n    for (let i = 0; i < shipCount; ++i) {\n      const ship1 = shipList[i]\n\n      for (let j = 0; j < powerupCount; ++j) {\n        const pup = powerupList[j]\n        if (Math.abs(ship1.posX - pup.posX) < 3\n          && Math.abs(ship1.posY - pup.posY) < 3) {\n          const t = geom.lineIntersectCircleFirstDepth(\n            [ship1.posX, ship1.posY],\n            [ship1.posXnew, ship1.posYnew],\n            pup.posX, pup.posY, pup.pickupRadius)\n          if (0 <= t && t <= 1) {\n            powerups.updateClosestPlayer(pup, ship1, t)\n          }\n        }\n      }\n\n      for (let j = 0; j < shipCount; ++j) {\n        const ship2 = shipList[j]\n        if (i == j || ship1.dead || ship2.dead) {\n          continue\n        }\n\n        if (Math.abs(ship1.posX - ship2.posX) < dist &&\n          Math.abs(ship1.posY - ship2.posY) < dist) {\n          const t = geom.closestSynchroDistance(\n            [ship1.posX, ship1.posY],\n            [ship1.posXnew, ship1.posYnew],\n            [ship2.posX, ship2.posY],\n            [ship2.posXnew, ship2.posYnew])\n          if (0 <= t && t <= 1) {\n            ship1.posX = ship1.posX + t * delta * ship1.velX\n            ship1.posY = ship1.posY + t * delta * ship1.velY\n            ship2.posX = ship2.posX + t * delta * ship2.velX\n            ship2.posY = ship2.posY + t * delta * ship2.velY\n            testShipShipCollision(ship1, ship2)\n          }\n        }\n      }\n\n      const planets = physics.getPlanets(ship1.posX, ship1.posY)\n      for (let j = 0; j < planets.length; ++j)  {\n        const planet = planets[j]\n        const search = planet.radius + SHIP_RADIUS\n        const searchSquare = search ** 2;\n        [ship1.posX, ship1.posY] = geom.lineClosestPointToPoint(\n          ship1.posX, ship1.posY, ship1.posXnew, ship1.posYnew,\n          planet.x, planet.y\n        )\n\n        if (Math.abs(ship1.posX - planet.x) < search \n          && Math.abs(ship1.posY - planet.y) < search) {\n          if (maths.squarePair(ship1.posX - planet.x, ship1.posY - planet.y) \n            < searchSquare) {\n            if (!ship1.dead) {\n              handleShipPlanetCollision(ship1, planet)\n            }\n            break\n          }\n        }\n      }\n    }\n\n    for (let i = 0; i < shipCount; ++i) {\n      const ship = shipList[i]\n      ship.posX = ship.posXnew\n      ship.posY = ship.posYnew\n    }\n  }\n\n  const handleShipShipCollision = (ship1, ship2) => {\n    const dx = ship1.velX - ship2.velX\n    const dy = ship1.velY - ship2.velY\n    const damage = 0.4 * Math.sqrt(Math.hypot(dx, dy))\n      / (physics.ACTUAL_MAX_SHIP_VELOCITY / 4)\n    const dmg1 = damage * (physics.hasRubbership(ship1) ? 0.5 : 1)\n    const dmg2 = damage * (physics.hasRubbership(ship2) ? 0.5 : 1)\n\n    if (dmg1 >= 0.1) {\n      ship1.health -= dmg1 * ship1.healthMul\n    }\n\n    if (dmg2 >= 0.1) {\n      ship2.health -= dmg2 * ship2.healthMul\n    }\n\n    // elastic collision\n    [ship1.velX, ship2.velX] = [ship2.velX, ship1.velX];\n    [ship1.velY, ship2.velY] = [ship2.velY, ship1.velY]\n    \n    if (ship1.health <= 0) {\n      if (ship2.health > 0) {\n        ++ship2.score\n      }\n      handler.onShipKilledByCrash(ship1, ship2)\n      killShip(ship1)\n    }\n\n    if (ship2.health <= 0) {\n      if (ship1.health > 0) {\n        ++ship1.score\n      }\n      handler.onShipKilledByCrash(ship2, ship1)\n      killShip(ship2)\n    }\n  }\n\n  const testShipShipCollision = (ship1, ship2) => {\n    if (Math.abs(ship1.posX - ship2.posX) < SHIP_RECT_RADIUS &&\n        Math.abs(ship1.posY - ship2.posY) < SHIP_RECT_RADIUS) {\n      const [p1, p2, p3] = geom.getCollisionPoints(ship1)\n      const [q1, q2,   , q4] = geom.getShipPoints(ship2)\n      if (geom.testTriangleCollision(p1, p2, p3, q1, q2, q4)) {\n        handleShipShipCollision(ship1, ship2)\n      }\n    }\n  }\n\n  const handleShipPlanetCollision = (ship, planet) => {\n    const v = Math.hypot(ship.velX, ship.velY)\n    let dist = Math.hypot(planet.x - ship.posX, planet.y - ship.posY)\n    const d = 1 - (dist / (planet.radius - 1))\n    const col_mul = geom.getPlanetDamageMultiplier(\n      Math.sin(-ship.orient), Math.cos(-ship.orient),\n      ship.posX - planet.x, ship.posY - planet.y)\n    if (!col_mul) return\n    const col_vmul = geom.getPlanetDamageSpeedMultiplier(ship.velX, ship.velY,\n      ship.posX - planet.x, ship.posY - planet.y)\n    let damage = Math.max(v * col_mul * col_vmul, d) / physics.MAX_SHIP_VELOCITY * ship.planetDamageMul \n      * (physics.hasRubbership(ship) ? 0 : 1)\n\n    if (!ship.accel \n      && v > 0 \n      && v * col_mul < physics.LATCH_VELOCITY * (ship.brake !== null ? 1.75 : 1)) {\n      latchToPlanet(ship, planet)\n      return\n    }\n\n    if (col_mul < 0.2 && ship.accel !== null) {\n      damage *= 0.2\n    }\n\n    let offx = ship.posX - planet.x\n    let offy = ship.posY - planet.y;\n    [offx, offy] = geom.normalize(offx, offy)\n    const radius = planet.radius + SHIP_RADIUS\n\n    ship.posX = planet.x + offx * (radius + 0.5)\n    ship.posY = planet.y + offy * (radius + 0.5)\n\n    ship.velX = -ship.velX + offx * v * 2\n    ship.velY = -ship.velY + offy * v * 2\n    if (v > 0)\n      ([ship.velX, ship.velY] = geom.normalize(ship.velX, ship.velY, v))\n\n    if (damage >= 0.05) {\n      damageShip(ship, damage, null, null, (ship) => {\n        if (ship.lastDamageAt && chron.timeMs() - ship.lastDamageAt < 2500) {\n          const by = getShipById(ship.lastDamageBy)\n          if (by) ++by.score\n        }\n        handler.onShipKilledByPlanet(ship)\n        killShip(ship)\n      })\n    }\n\n    if (ship.dead) {\n      return\n    }\n  \n    dist = Math.hypot(planet.x - ship.posX, planet.y - ship.posY)\n    if (planet.radius - dist > 0.25)\n      latchToPlanet(ship, planet)\n\n    /*if (!physics.hasRubbership(ship) && damage < 0.4 && col_mul < 1.7) {\n      latchToPlanet(ship, planet)\n    }*/\n  }\n\n  const deleteShip = (ship) => {\n    ship.dead = true\n    removeShipById(ship._id)\n  }\n\n  const damageShip = (ship, damage, bullet, shooter, onDeath) => {\n    if (ship.dead) return\n    ship.health -= damage * ship.healthMul\n    if (shooter) {\n      ship.lastDamageAt = chron.timeMs()\n      ship.lastDamageBy = shooter._id\n    }\n    if (ship.health <= 0) {\n      if (shooter) {\n        ++shooter.score\n      }\n      onDeath(ship, bullet)\n    }\n  }\n\n  const killShip = (ship) => {\n    deleteShip(ship)\n    handler.onShipKilled(ship)\n  }\n\n  return {\n    getShips,\n    getShipById,\n    getShipCount,\n    damageShip,\n    removeShipById,\n    newPlayerShip,\n    premoveShips,\n    moveShips,\n    killShip,\n    deleteShip,\n    shipAcceleration\n  }\n}\n\nmodule.exports = {\n  system: shipSystemFactory,\n  fields: shipFields,\n}\n","const timeMs = () => new Date().getTime()\n\nmodule.exports = { timeMs }\n","class Counter {\n  constructor() {\n    this.counter = BigInt(0)\n  }\n\n  next() {\n    const val = this.counter.toString(16).padStart(16, '0')\n    this.counter = BigInt.asUintN(64, this.counter + BigInt(1))\n    return val\n  }\n}\n\nmodule.exports = Counter\n","const maths = require('../utils/maths')\n\nconst SHIP_SCALE = 1.1\n\nconst lerp1D = (a, t, b) => {\n  return a + t * (b - a)\n}\n\nconst lerp2D = (a, t, b) => {\n  return [lerp1D(a[0], t, b[0]), lerp1D(a[1], t, b[1])]\n}\n\nconst normalize = (x, y, m) => {\n  const d = Math.hypot(x, y)\n  m = m || 1\n  return [m * x / d, m * y / d]\n}\n\nconst pointInTriangle = (p1, p2, p3, p) => {\n  const [x1, y1] = p1\n  const [x2, y2] = p2\n  const [x3, y3] = p3\n  const [xp, yp] = p\n\n  const c1 = ((y2 - y3) * (xp - x3) + (x3 - x2) * (yp - y3)) \n           / ((y2 - y3) * (x1 - x3) + (x3 - x2) * (y1 - y3))\n  const c2 = ((y3 - y1) * (xp - x3) + (x1 - x3) * (yp - y3)) \n           / ((y2 - y3) * (x1 - x3) + (x3 - x2) * (y1 - y3))\n  const c3 = 1 - c1 - c2\n  return c1 > 0 && c2 > 0 && c3 > 0\n}\n\nconst testTriangleCollisionSub = (a1, a2, a3, b1, b2, b3) => {\n  const dax = a1[0] - b3[0], day = a1[1] - b3[1]\n  const dbx = a2[0] - b3[0], dby = a2[1] - b3[1]\n  const dcx = a3[0] - b3[0], dcy = a3[1] - b3[1]\n  const b32x = b3[0] - b2[0]\n  const b23y = b2[1] - b3[1]\n  const D = b23y * (b1[0] - b3[0]) + b32x * (b1[1] - b3[1])\n  const sa = b23y * dax + b32x * day\n  const sb = b23y * dbx + b32x * dby\n  const sc = b23y * dcx + b32x * dcy\n  const ta = (b3[1] - b1[1]) * dax + (b1[0] - b3[0]) * day\n  const tb = (b3[1] - b1[1]) * dbx + (b1[0] - b3[0]) * dby\n  const tc = (b3[1] - b1[1]) * dcx + (b1[0] - b3[0]) * dcy\n  if (D < 0) return ((sa >= 0 && sb >= 0 && sc >= 0) ||\n                     (ta >= 0 && tb >= 0 && tc >= 0) ||\n                     (sa + ta <= D && sb + tb <= D && sc + tc <= D))\n  return ((sa <= 0 && sb <= 0 && sc <= 0) ||\n          (ta <= 0 && tb <= 0 && tc <= 0) ||\n          (sa + ta >= D && sb + tb >= D && sc + tc >= D))\n}\n\nconst testTriangleCollision = (a1, a2, a3, b1, b2, b3) => {\n  return !(testTriangleCollisionSub(a1, a2, a3, b1, b2, b3)\n        || testTriangleCollisionSub(b1, b2, b3, a1, a2, a3))\n}\n\nconst getDirectionSign = (a, b) => {\n  let s = Math.sign(b[0] - a[0])\n  if (s == 0) {\n    s = Math.sign(b[1] - a[1])\n  }\n  return s\n}\n\nconst collinearLinesIntersect = (a1, a2, b1, b2) => {\n  let a = 0\n  let b = ((a2[0] - a1[0]) * (a2[0] - a1[0]) \n    + (a2[1] - a1[1]) * (a2[1] - a1[1])) * getDirectionSign(a2, a1)\n  let c = ((b1[0] - a1[0]) * (b1[0] - a1[0]) \n    + (b1[1] - a1[1]) * (b1[1] - a1[1])) * getDirectionSign(b1, a1)\n  let d = ((b2[0] - a1[0]) * (b2[0] - a1[0]) \n    + (b2[1] - a1[1]) * (b2[1] - a1[1])) * getDirectionSign(b2, a1)\n  \n  if (a >= b) [a, b] = [b, a]\n  if (c >= d) [c, d] = [d, c]\n  \n  return b >= c && d >= a\n}\n\nconst lineIntersectsLine = (a1, a2, b1, b2) => {\n  const d = 1 / \n    (((a2[0] - a1[0]) * (b2[1] - b1[1])) \n    - ((a2[1] - a1[1]) * (b2[0] - b1[0])))\n  if (!isFinite(d)) { // collinear\n    return collinearLinesIntersect(a1, a2, b1, b2)\n  }\n\n  const n = d * \n    (((a1[1] - b1[1]) * (b2[0] - b1[0])) \n    - ((a1[0] - b1[0]) * (b2[1] - b1[1])))\n  const m = d * \n    (((a1[1] - b1[1]) * (a2[0] - a1[0])) \n    - ((a1[0] - b1[0]) * (a2[1] - a1[1])))\n\n  return 0 <= n && n <= 1 && 0 <= m && m <= 1\n}\n\nconst lineIntersectsTriangle = (l1, l2, t1, t2, t3) => {\n  return lineIntersectsLine(l1, l2, t1, t2)\n    || lineIntersectsLine(l1, l2, t2, t3)\n    || lineIntersectsLine(l1, l2, t3, t1)\n}\n\nconst lineIntersectCircleFirstDepth = (a1, a2, x, y, radius) => {\n  for (let i = 0; i <= 8; ++i) {\n    const s = i / 8\n    if (Math.hypot(a1[0] + s * a2[0] - x, a1[1] + s * a2[1] - y) < radius) {\n      return s\n    }\n  }\n  return Number.NaN\n}\n\nconst lineClosestPointToPoint = (a1, a2, b1, b2, p1, p2) => {\n  const v1 = b1 - a1\n  const v2 = b2 - a2\n  const u1 = a1 - p1\n  const u2 = a2 - p2\n  const vu = v1 * u1 + v2 * u2\n  const vv = v1 * v1 + v2 * v2\n  if (vv === 0) return [a1, a2]\n  let t = -vu / vv\n  if (t < 0) t = 0\n  if (t > 1) t = 1\n  return lerp2D([a1, a2], t, [b1, b2])\n}\n\nconst closestSynchroDistance = (a1, a2, b1, b2) => {\n  const A = a1[0] - b1[0]\n  const B = (a2[0] - a1[0]) - (b2[0] - b1[0])\n  const C = a1[1] - b1[1]\n  const D = (a2[1] - a1[1]) - (b2[1] - b1[1])\n  if (B == 0 && D == 0) {\n    return 0\n  }\n  return -(A * B + C * D) / (B * B + D * D)\n}\n\nconst wrapRadianAngle = (angle) => {\n  return (angle + Math.PI) % (2 * Math.PI) - Math.PI\n}\n\nconst getPlanetDamageMultiplier = (ox, oy, px, py) => {\n  [ox, oy] = normalize(ox, oy);\n  [px, py] = normalize(px, py)\n  return maths.padFromBelow(0.5, (1 - (ox * px + oy * py)) * 0.5)\n}\n\nconst getPlanetDamageSpeedMultiplier = (vx, vy, px, py) => {\n  if (!(vx || vy)) return 0;\n  [vx, vy] = normalize(vx, vy);\n  [px, py] = normalize(px, py)\n  return maths.padFromBelow(0.5, Math.abs(vx * px + vy * py))\n}\n\nconst withinBoundingSquare = (x, y, center, d) => {\n  return Math.min(Math.abs(x - center), Math.abs(y - center)) <= d\n}\n\nconst rotatePoint = (s, c, x, y) => [x * c - y * s, x * s + y * c]\n\nconst rotatePointOffset = (s, c, x, y, xo, yo) => \n  [xo + x * c - y * s, yo + x * s + y * c]\n\nconst getShipPoints = (ship) => {\n  const S = SHIP_SCALE\n  if (!ship) {\n    return []\n  }\n\n  const s = Math.sin(ship.orient)\n  const c = Math.cos(ship.orient)\n\n  return [\n    rotatePointOffset(s, c,  0   *S, +2   *S, ship.posX, ship.posY),\n    rotatePointOffset(s, c, +1.5 *S, -2   *S, ship.posX, ship.posY),\n    rotatePointOffset(s, c,  0   *S, -1.25*S, ship.posX, ship.posY),\n    rotatePointOffset(s, c, -1.5 *S, -2   *S, ship.posX, ship.posY)\n  ]\n}\n\nconst getCollisionPoints = (ship) => {\n  const S = SHIP_SCALE\n  if (!ship) {\n    return []\n  }\n\n  const s = Math.sin(ship.orient)\n  const c = Math.cos(ship.orient)\n  \n  return [\n    rotatePointOffset(s, c,  0   *S, +2.6*S, ship.posX, ship.posY),\n    rotatePointOffset(s, c, +1.87*S, -2.6*S, ship.posX, ship.posY),\n    rotatePointOffset(s, c, -1.87*S, -2.6*S, ship.posX, ship.posY)\n  ]\n}\n\nconst getThrusterPoints = (ship) => {\n  const S = SHIP_SCALE\n  if (!ship) {\n    return []\n  }\n\n  const s = Math.sin(ship.orient)\n  const c = Math.cos(ship.orient)\n\n  return [\n    rotatePointOffset(s, c,  0   *S, -1.25*S, ship.posX, ship.posY),\n    rotatePointOffset(s, c, +0.75*S, -1.75*S, ship.posX, ship.posY),\n    rotatePointOffset(s, c,  0   *S, -3.75*S, ship.posX, ship.posY),\n    rotatePointOffset(s, c, -0.75*S, -1.75*S, ship.posX, ship.posY),\n    rotatePointOffset(s, c,  0   *S, -2.75*S, ship.posX, ship.posY),\n  ]\n}\n\nmodule.exports = {\n  lerp1D,\n  lerp2D,\n  normalize,\n  pointInTriangle,\n  rotatePoint,\n  testTriangleCollision,\n  lineIntersectsLine,\n  lineIntersectCircleFirstDepth,\n  lineClosestPointToPoint,\n  closestSynchroDistance,\n  lineIntersectsTriangle,\n  wrapRadianAngle,\n  withinBoundingSquare,\n  getPlanetDamageMultiplier,\n  getPlanetDamageSpeedMultiplier,\n  getShipPoints,\n  getCollisionPoints,\n  getThrusterPoints }\n","const LCG_A = 535426113\nconst LCG_C = 2258250855\nconst SC = 2.0 ** -30\n\nclass Generator {\n  constructor(seed) {\n    this.seed = seed & 0xFFFFFFFF\n  }\n\n  reseed(seed) {\n    this.seed = seed & 0xFFFFFFFF\n  }\n\n  randomInt() {\n    const val = this.seed\n    this.seed = (LCG_A * val + LCG_C) & 0xFFFFFFFF\n    return val\n  }\n\n  random() {\n    return (this.randomInt() & 0x3FFFFFFF) * SC\n  }\n\n  randomOffset() {\n    return 2 * this.random() - 1\n  }\n\n  randomSign() {\n    return 2 * (this.randomInt() & 1) - 1\n  }\n}\n\nmodule.exports = Generator\n","\nconst randomSign = () => {\n  return 2 * ((2 * Math.random()) | 0) - 1\n}\n\nconst squarePair = (x, y) => x ** 2 + y ** 2\n\nconst padFromBelow = (p, v) => p + (1 - p) * v\n\nmodule.exports = {\n  randomSign,\n  squarePair,\n  padFromBelow }\n","const msgpackr = require('msgpackr')\n\nconst shipFields = require('../game/ship').fields\nconst bulletFields = require('../game/bullet').fields\nconst powerupFields = require('../game/powerup').fields\n\nconst serializeFrom = (object, fields) => fields.map(field => object[field])\nconst deserializeFrom = (array, fields) => {\n  const object = {}\n  for (let i = 0; i < array.length; ++i) {\n    object[fields[i]] = array[i]\n  }\n  return object\n}\n\nconst serializeBullet = (obj) => serializeFrom(obj, bulletFields)\nconst deserializeBullet = (arr) => deserializeFrom(arr, bulletFields)\n\nconst serializePowerup = (obj) => serializeFrom(obj, powerupFields)\nconst deserializePowerup = (arr) => deserializeFrom(arr, powerupFields)\n\nconst serializeShip = (obj) => serializeFrom(obj, shipFields)\nconst deserializeShip = (arr) => deserializeFrom(arr, shipFields)\n\n/*const encode = (data) => pson.encode(data)\nconst decode = (data) => pson.decode(data)\nconst recv = (data) => ByteBuffer.wrap(data)\nconst send = (ws, data) => ws.send(data.buffer)*/\n\n/*\nconst encode = (data) => JSON.stringify(data)\nconst decode = (data) => JSON.parse(data)\nconst recv = (data) => data\nconst send = (ws, data) => ws.send(data)\n*/\n\nconst C_ping = 0\nconst C_join = 1\nconst C_ctrl = 2\nconst C_quit = 3\nconst C_useitem = 4\n\nconst C_pong = 128\nconst C_token = 129\nconst C_data = 130\nconst C_board = 131\nconst C_killship = 132\nconst C_killproj = 133\nconst C_orient = 134\nconst C_unauth = 135\nconst C_addpup = 136\nconst C_delpup = 137\nconst C_minexpl = 138\nconst C_deathk = 139\nconst C_deathc = 140\nconst C_deathp = 141\nconst C_addpups = 142\n\nconst C_crashed = 192\nconst C_killed = 193\nconst C_hitpl = 194\n\nconst encode = (cmd, data) => {\n  return msgpackr.pack([cmd, ...messageKeys[cmd].map(key => data[key])])\n}\n\nconst decode = (data) => {\n  const array = msgpackr.unpack(data)\n  const cmd = array[0]\n  return [ cmd, Object.fromEntries(messageKeys[cmd].map((key, index) => [key, array[index + 1]])) ]\n}\n\nconst recv = (data) => data\nconst send = (ws, data) => ws.send(data)\n\nconst messageKeys = {\n  [C_token]: ['token'],\n  [C_data]: ['you', 'ships', 'projs', 'count', 'rubber', 'seed'],\n  [C_unauth]: [],\n  [C_board]: ['board'],\n  [C_killship]: ['ship'],\n  [C_killproj]: ['proj'],\n  [C_crashed]: ['ship'],\n  [C_killed]: ['ship'],\n  [C_orient]: ['orient'],\n  [C_hitpl]: [],\n  [C_join]: ['nick', 'perk'],\n  [C_ping]: ['time'],\n  [C_pong]: ['time'],\n  [C_quit]: ['token'],\n  [C_ctrl]: ['token', 'orient', 'accel', 'brake', 'firing'],\n  [C_addpup]: ['powerup'],\n  [C_delpup]: ['powerup'],\n  [C_useitem]: ['token'],\n  [C_minexpl]: ['proj'],\n  [C_deathk]: ['ship', 'by'],\n  [C_deathc]: ['ship', 'by'],\n  [C_deathp]: ['ship'],\n  [C_addpups]: ['powerups'],\n}\n\n// token: string\nconst e_token = (token) => encode(C_token, { token })\n// you: Ship, ship: Ship[], projs: Bullet[],\n// count: number, rubber: number, seed: number\nconst e_data = (you, ships, projs, count, rubber, seed) => \n  encode(C_data, { you: serializeShip(you),\n    ships: ships.map(serializeShip),\n    projs: projs.map(serializeBullet),\n    count, rubber, seed })\nconst e_unauth = () => encode(C_unauth)\n// board: [[name, score], ...]\nconst e_board = (board) => encode(C_board, { board })\n// ship: ship\nconst e_killship = (ship) => encode(C_killship, { ship: serializeShip(ship) })\n// proj: string (id)\nconst e_killproj = (proj) => encode(C_killproj, { proj })\n// name: string (name)\nconst e_crashed = (ship) => encode(C_crashed, { ship })\n// name: string (name)\nconst e_killed = (ship) => encode(C_killed, { ship })\n// orient: number\nconst e_orient = (orient) => encode(C_orient, { orient })\nconst e_hitpl = () => encode(C_hitpl)\n// join: string, perk: string\nconst e_join = (nick, perk) => encode(C_join, { nick, perk })\n// time: number\nconst e_ping = (time) => encode(C_ping, { time })\n// time: number\nconst e_pong = (time) => encode(C_pong, { time })\n// token: string\nconst e_quit = (token) => encode(C_quit, { token })\n// token: string, orient: number, accel: boolean, brake: boolean, firing: boolean\nconst e_ctrl = (token, orient, accel, brake, firing) => encode(C_ctrl, {\n  token, orient, accel, brake, firing })\n// powerup: Powerup\nconst e_addpup = (powerup) => encode(C_addpup, { powerup: serializePowerup(powerup) })\n// powerup: (ID) string\nconst e_delpup = (powerup) => encode(C_delpup, { powerup })\n// token: string\nconst e_useitem = (token) => encode(C_useitem, { token })\n// proj: Bullet\nconst e_minexpl = (proj) => encode(C_minexpl, { proj: serializeBullet(proj) })\n// ship: string, by: string\nconst e_deathk = (ship, by) => encode(C_deathk, { ship, by })\n// ship: string, by: string\nconst e_deathc = (ship, by) => encode(C_deathc, { ship, by })\n// ship: string, by: string\nconst e_deathp = (ship) => encode(C_deathp, { ship })\n// powerups: Powerup[]\nconst e_addpups = (powerups) => encode(C_addpups, { powerups: powerups.map(serializePowerup) })\n\nmodule.exports = {\n  encode,\n  decode,\n  recv,\n  send,\n\n  e_token,\n  e_data,\n  e_unauth,\n  e_board,\n  e_killship,\n  e_killproj,\n  e_crashed,\n  e_killed,\n  e_orient,\n  e_hitpl,\n  e_join,\n  e_ping,\n  e_pong,\n  e_ctrl,\n  e_quit,\n  e_addpup,\n  e_delpup,\n  e_useitem,\n  e_minexpl,\n  e_deathk,\n  e_deathc,\n  e_deathp,\n  e_addpups,\n\n  C_ctrl,\n  C_join,\n  C_ping,\n  C_pong,\n  C_quit,\n  C_token,\n  C_data,\n  C_board,\n  C_killship,\n  C_killproj,\n  C_crashed,\n  C_killed,\n  C_hitpl,\n  C_orient,\n  C_unauth,\n  C_addpup,\n  C_delpup,\n  C_useitem,\n  C_minexpl,\n  C_deathk,\n  C_deathc,\n  C_deathp,\n  C_addpups,\n\n  serializeFrom,\n  deserializeFrom,\n\n  deserializeShip,\n  deserializeBullet,\n  deserializePowerup\n}\n","export { Packr, Encoder, addExtension, pack, encode, NEVER, ALWAYS, DECIMAL_ROUND, DECIMAL_FIT, REUSE_BUFFER_MODE } from './pack.js'\r\nexport { Unpackr, Decoder, C1, unpack, unpackMultiple, decode, FLOAT32_OPTIONS, clearSource, roundFloat32, isNativeAccelerationEnabled } from './unpack.js'\r\nexport { decodeIter, encodeIter } from './iterators.js'\r\nexport const useRecords = false\r\nexport const mapsAsObjects = true\r\n","import { Packr } from './pack.js'\r\nimport { Unpackr } from './unpack.js'\r\n\r\n/**\r\n * Given an Iterable first argument, returns an Iterable where each value is packed as a Buffer\r\n * If the argument is only Async Iterable, the return value will be an Async Iterable.\r\n * @param {Iterable|Iterator|AsyncIterable|AsyncIterator} objectIterator - iterable source, like a Readable object stream, an array, Set, or custom object\r\n * @param {options} [options] - msgpackr pack options\r\n * @returns {IterableIterator|Promise.<AsyncIterableIterator>}\r\n */\r\nexport function packIter (objectIterator, options = {}) {\r\n  if (!objectIterator || typeof objectIterator !== 'object') {\r\n    throw new Error('first argument must be an Iterable, Async Iterable, or a Promise for an Async Iterable')\r\n  } else if (typeof objectIterator[Symbol.iterator] === 'function') {\r\n    return packIterSync(objectIterator, options)\r\n  } else if (typeof objectIterator.then === 'function' || typeof objectIterator[Symbol.asyncIterator] === 'function') {\r\n    return packIterAsync(objectIterator, options)\r\n  } else {\r\n    throw new Error('first argument must be an Iterable, Async Iterable, Iterator, Async Iterator, or a Promise')\r\n  }\r\n}\r\n\r\nfunction * packIterSync (objectIterator, options) {\r\n  const packr = new Packr(options)\r\n  for (const value of objectIterator) {\r\n    yield packr.pack(value)\r\n  }\r\n}\r\n\r\nasync function * packIterAsync (objectIterator, options) {\r\n  const packr = new Packr(options)\r\n  for await (const value of objectIterator) {\r\n    yield packr.pack(value)\r\n  }\r\n}\r\n\r\n/**\r\n * Given an Iterable/Iterator input which yields buffers, returns an IterableIterator which yields sync decoded objects\r\n * Or, given an Async Iterable/Iterator which yields promises resolving in buffers, returns an AsyncIterableIterator.\r\n * @param {Iterable|Iterator|AsyncIterable|AsyncIterableIterator} bufferIterator\r\n * @param {object} [options] - unpackr options\r\n * @returns {IterableIterator|Promise.<AsyncIterableIterator}\r\n */\r\nexport function unpackIter (bufferIterator, options = {}) {\r\n  if (!bufferIterator || typeof bufferIterator !== 'object') {\r\n    throw new Error('first argument must be an Iterable, Async Iterable, Iterator, Async Iterator, or a promise')\r\n  }\r\n\r\n  const unpackr = new Unpackr(options)\r\n  let incomplete\r\n  const parser = (chunk) => {\r\n    let yields\r\n    // if there's incomplete data from previous chunk, concatinate and try again\r\n    if (incomplete) {\r\n      chunk = Buffer.concat([incomplete, chunk])\r\n      incomplete = undefined\r\n    }\r\n\r\n    try {\r\n      yields = unpackr.unpackMultiple(chunk)\r\n    } catch (err) {\r\n      if (err.incomplete) {\r\n        incomplete = chunk.slice(err.lastPosition)\r\n        yields = err.values\r\n      } else {\r\n        throw err\r\n      }\r\n    }\r\n    return yields\r\n  }\r\n\r\n  if (typeof bufferIterator[Symbol.iterator] === 'function') {\r\n    return (function * iter () {\r\n      for (const value of bufferIterator) {\r\n        yield * parser(value)\r\n      }\r\n    })()\r\n  } else if (typeof bufferIterator[Symbol.asyncIterator] === 'function') {\r\n    return (async function * iter () {\r\n      for await (const value of bufferIterator) {\r\n        yield * parser(value)\r\n      }\r\n    })()\r\n  }\r\n}\r\nexport const decodeIter = unpackIter\r\nexport const encodeIter = packIter","\"use strict\"\r\nimport { Unpackr, mult10, C1Type, typedArrays, addExtension as unpackAddExtension } from './unpack.js'\r\nlet textEncoder\r\ntry {\r\n\ttextEncoder = new TextEncoder()\r\n} catch (error) {}\r\nlet extensions, extensionClasses\r\nconst hasNodeBuffer = typeof Buffer !== 'undefined'\r\nconst ByteArrayAllocate = hasNodeBuffer ? Buffer.allocUnsafeSlow : Uint8Array\r\nconst ByteArray = hasNodeBuffer ? Buffer : Uint8Array\r\nconst MAX_BUFFER_SIZE = hasNodeBuffer ? 0x100000000 : 0x7fd00000\r\nlet target, keysTarget\r\nlet targetView\r\nlet position = 0\r\nlet safeEnd\r\nlet bundledStrings = null\r\nconst MAX_BUNDLE_SIZE = 0xf000\r\nconst hasNonLatin = /[\\u0080-\\uFFFF]/\r\nconst RECORD_SYMBOL = Symbol('record-id')\r\nexport class Packr extends Unpackr {\r\n\tconstructor(options) {\r\n\t\tsuper(options)\r\n\t\tthis.offset = 0\r\n\t\tlet typeBuffer\r\n\t\tlet start\r\n\t\tlet hasSharedUpdate\r\n\t\tlet structures\r\n\t\tlet referenceMap\r\n\t\tlet lastSharedStructuresLength = 0\r\n\t\tlet encodeUtf8 = ByteArray.prototype.utf8Write ? function(string, position, maxBytes) {\r\n\t\t\treturn target.utf8Write(string, position, maxBytes)\r\n\t\t} : (textEncoder && textEncoder.encodeInto) ?\r\n\t\t\tfunction(string, position) {\r\n\t\t\t\treturn textEncoder.encodeInto(string, target.subarray(position)).written\r\n\t\t\t} : false\r\n\r\n\t\tlet packr = this\r\n\t\tif (!options)\r\n\t\t\toptions = {}\r\n\t\tlet isSequential = options && options.sequential\r\n\t\tlet hasSharedStructures = options.structures || options.saveStructures\r\n\t\tlet maxSharedStructures = options.maxSharedStructures\r\n\t\tif (maxSharedStructures == null)\r\n\t\t\tmaxSharedStructures = hasSharedStructures ? 32 : 0\r\n\t\tif (maxSharedStructures > 8160)\r\n\t\t\tthrow new Error('Maximum maxSharedStructure is 8160')\r\n\t\tif (options.structuredClone && options.moreTypes == undefined) {\r\n\t\t\toptions.moreTypes = true\r\n\t\t}\r\n\t\tlet maxOwnStructures = options.maxOwnStructures\r\n\t\tif (maxOwnStructures == null)\r\n\t\t\tmaxOwnStructures = hasSharedStructures ? 32 : 64\r\n\t\tif (!this.structures && options.useRecords != false)\r\n\t\t\tthis.structures = []\r\n\t\t// two byte record ids for shared structures\r\n\t\tlet useTwoByteRecords = maxSharedStructures > 32 || (maxOwnStructures + maxSharedStructures > 64)\t\t\r\n\t\tlet sharedLimitId = maxSharedStructures + 0x40\r\n\t\tlet maxStructureId = maxSharedStructures + maxOwnStructures + 0x40\r\n\t\tif (maxStructureId > 8256) {\r\n\t\t\tthrow new Error('Maximum maxSharedStructure + maxOwnStructure is 8192')\r\n\t\t}\r\n\t\tlet recordIdsToRemove = []\r\n\t\tlet transitionsCount = 0\r\n\t\tlet serializationsSinceTransitionRebuild = 0\r\n\r\n\t\tthis.pack = this.encode = function(value, encodeOptions) {\r\n\t\t\tif (!target) {\r\n\t\t\t\ttarget = new ByteArrayAllocate(8192)\r\n\t\t\t\ttargetView = new DataView(target.buffer, 0, 8192)\r\n\t\t\t\tposition = 0\r\n\t\t\t}\r\n\t\t\tsafeEnd = target.length - 10\r\n\t\t\tif (safeEnd - position < 0x800) {\r\n\t\t\t\t// don't start too close to the end, \r\n\t\t\t\ttarget = new ByteArrayAllocate(target.length)\r\n\t\t\t\ttargetView = new DataView(target.buffer, 0, target.length)\r\n\t\t\t\tsafeEnd = target.length - 10\r\n\t\t\t\tposition = 0\r\n\t\t\t} else\r\n\t\t\t\tposition = (position + 7) & 0x7ffffff8 // Word align to make any future copying of this buffer faster\r\n\t\t\tstart = position\r\n\t\t\treferenceMap = packr.structuredClone ? new Map() : null\r\n\t\t\tif (packr.bundleStrings && typeof value !== 'string') {\r\n\t\t\t\tbundledStrings = []\r\n\t\t\t\tbundledStrings.size = Infinity // force a new bundle start on first string\r\n\t\t\t} else\r\n\t\t\t\tbundledStrings = null\r\n\t\t\tstructures = packr.structures\r\n\t\t\tif (structures) {\r\n\t\t\t\tif (structures.uninitialized)\r\n\t\t\t\t\tstructures = packr._mergeStructures(packr.getStructures())\r\n\t\t\t\tlet sharedLength = structures.sharedLength || 0\r\n\t\t\t\tif (sharedLength > maxSharedStructures) {\r\n\t\t\t\t\t//if (maxSharedStructures <= 32 && structures.sharedLength > 32) // TODO: could support this, but would need to update the limit ids\r\n\t\t\t\t\tthrow new Error('Shared structures is larger than maximum shared structures, try increasing maxSharedStructures to ' + structures.sharedLength)\r\n\t\t\t\t}\r\n\t\t\t\tif (!structures.transitions) {\r\n\t\t\t\t\t// rebuild our structure transitions\r\n\t\t\t\t\tstructures.transitions = Object.create(null)\r\n\t\t\t\t\tfor (let i = 0; i < sharedLength; i++) {\r\n\t\t\t\t\t\tlet keys = structures[i]\r\n\t\t\t\t\t\tif (!keys)\r\n\t\t\t\t\t\t\tcontinue\r\n\t\t\t\t\t\tlet nextTransition, transition = structures.transitions\r\n\t\t\t\t\t\tfor (let j = 0, l = keys.length; j < l; j++) {\r\n\t\t\t\t\t\t\tlet key = keys[j]\r\n\t\t\t\t\t\t\tnextTransition = transition[key]\r\n\t\t\t\t\t\t\tif (!nextTransition) {\r\n\t\t\t\t\t\t\t\tnextTransition = transition[key] = Object.create(null)\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\ttransition = nextTransition\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\ttransition[RECORD_SYMBOL] = i + 0x40\r\n\t\t\t\t\t}\r\n\t\t\t\t\tlastSharedStructuresLength = sharedLength\r\n\t\t\t\t}\r\n\t\t\t\tif (!isSequential) {\r\n\t\t\t\t\tstructures.nextId = sharedLength + 0x40\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (hasSharedUpdate)\r\n\t\t\t\thasSharedUpdate = false\r\n\t\t\ttry {\r\n\t\t\t\tpack(value)\r\n\t\t\t\tif (bundledStrings) {\r\n\t\t\t\t\twriteBundles(start, pack)\r\n\t\t\t\t}\r\n\t\t\t\tpackr.offset = position // update the offset so next serialization doesn't write over our buffer, but can continue writing to same buffer sequentially\r\n\t\t\t\tif (referenceMap && referenceMap.idsToInsert) {\r\n\t\t\t\t\tposition += referenceMap.idsToInsert.length * 6\r\n\t\t\t\t\tif (position > safeEnd)\r\n\t\t\t\t\t\tmakeRoom(position)\r\n\t\t\t\t\tpackr.offset = position\r\n\t\t\t\t\tlet serialized = insertIds(target.subarray(start, position), referenceMap.idsToInsert)\r\n\t\t\t\t\treferenceMap = null\r\n\t\t\t\t\treturn serialized\r\n\t\t\t\t}\r\n\t\t\t\tif (encodeOptions & REUSE_BUFFER_MODE) {\r\n\t\t\t\t\ttarget.start = start\r\n\t\t\t\t\ttarget.end = position\r\n\t\t\t\t\treturn target\r\n\t\t\t\t}\r\n\t\t\t\treturn target.subarray(start, position) // position can change if we call pack again in saveStructures, so we get the buffer now\r\n\t\t\t} finally {\r\n\t\t\t\tif (structures) {\r\n\t\t\t\t\tif (serializationsSinceTransitionRebuild < 10)\r\n\t\t\t\t\t\tserializationsSinceTransitionRebuild++\r\n\t\t\t\t\tlet sharedLength = structures.sharedLength || maxSharedStructures\r\n\t\t\t\t\tif (structures.length > sharedLength)\r\n\t\t\t\t\t\tstructures.length = sharedLength\r\n\t\t\t\t\tif (transitionsCount > 10000) {\r\n\t\t\t\t\t\t// force a rebuild occasionally after a lot of transitions so it can get cleaned up\r\n\t\t\t\t\t\tstructures.transitions = null\r\n\t\t\t\t\t\tserializationsSinceTransitionRebuild = 0\r\n\t\t\t\t\t\ttransitionsCount = 0\r\n\t\t\t\t\t\tif (recordIdsToRemove.length > 0)\r\n\t\t\t\t\t\t\trecordIdsToRemove = []\r\n\t\t\t\t\t} else if (recordIdsToRemove.length > 0 && !isSequential) {\r\n\t\t\t\t\t\tfor (let i = 0, l = recordIdsToRemove.length; i < l; i++) {\r\n\t\t\t\t\t\t\trecordIdsToRemove[i][RECORD_SYMBOL] = 0\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\trecordIdsToRemove = []\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (hasSharedUpdate && packr.saveStructures) {\r\n\t\t\t\t\t\t// we can't rely on start/end with REUSE_BUFFER_MODE since they will (probably) change when we save\r\n\t\t\t\t\t\tlet returnBuffer = target.subarray(start, position)\r\n\t\t\t\t\t\tif (packr.saveStructures(structures, lastSharedStructuresLength) === false) {\r\n\t\t\t\t\t\t\t// get updated structures and try again if the update failed\r\n\t\t\t\t\t\t\tpackr._mergeStructures(packr.getStructures())\r\n\t\t\t\t\t\t\treturn packr.pack(value)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tlastSharedStructuresLength = sharedLength\r\n\t\t\t\t\t\treturn returnBuffer\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif (encodeOptions & RESET_BUFFER_MODE)\r\n\t\t\t\t\tposition = start\r\n\t\t\t}\r\n\t\t}\r\n\t\tconst pack = (value) => {\r\n\t\t\tif (position > safeEnd)\r\n\t\t\t\ttarget = makeRoom(position)\r\n\r\n\t\t\tvar type = typeof value\r\n\t\t\tvar length\r\n\t\t\tif (type === 'string') {\r\n\t\t\t\tlet strLength = value.length\r\n\t\t\t\tif (bundledStrings && strLength >= 4 && strLength < 0x1000) {\r\n\t\t\t\t\tif ((bundledStrings.size += strLength) > MAX_BUNDLE_SIZE) {\r\n\t\t\t\t\t\tlet extStart\r\n\t\t\t\t\t\tlet maxBytes = (bundledStrings[0] ? bundledStrings[0].length * 3 + bundledStrings[1].length : 0) + 10\r\n\t\t\t\t\t\tif (position + maxBytes > safeEnd)\r\n\t\t\t\t\t\t\ttarget = makeRoom(position + maxBytes)\r\n\t\t\t\t\t\tif (bundledStrings.position) { // here we use the 0x62 extension to write the last bundle and reserve sapce for the reference pointer to the next/current bundle\r\n\t\t\t\t\t\t\ttarget[position] = 0xc8 // ext 16\r\n\t\t\t\t\t\t\tposition += 3 // reserve for the writing bundle size\r\n\t\t\t\t\t\t\ttarget[position++] = 0x62 // 'b'\r\n\t\t\t\t\t\t\textStart = position - start\r\n\t\t\t\t\t\t\tposition += 4 // reserve for writing bundle reference\r\n\t\t\t\t\t\t\twriteBundles(start, pack) // write the last bundles\r\n\t\t\t\t\t\t\ttargetView.setUint16(extStart + start - 3, position - start - extStart)\r\n\t\t\t\t\t\t} else { // here we use the 0x62 extension just to reserve the space for the reference pointer to the bundle (will be updated once the bundle is written)\r\n\t\t\t\t\t\t\ttarget[position++] = 0xd6 // fixext 4\r\n\t\t\t\t\t\t\ttarget[position++] = 0x62 // 'b'\r\n\t\t\t\t\t\t\textStart = position - start\r\n\t\t\t\t\t\t\tposition += 4 // reserve for writing bundle reference\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbundledStrings = ['', ''] // create new ones\r\n\t\t\t\t\t\tbundledStrings.size = 0\r\n\t\t\t\t\t\tbundledStrings.position = extStart\r\n\t\t\t\t\t}\r\n\t\t\t\t\tlet twoByte = hasNonLatin.test(value)\r\n\t\t\t\t\tbundledStrings[twoByte ? 0 : 1] += value\r\n\t\t\t\t\ttarget[position++] = 0xc1\r\n\t\t\t\t\tpack(twoByte ? -strLength : strLength);\r\n\t\t\t\t\treturn\r\n\t\t\t\t}\r\n\t\t\t\tlet headerSize\r\n\t\t\t\t// first we estimate the header size, so we can write to the correct location\r\n\t\t\t\tif (strLength < 0x20) {\r\n\t\t\t\t\theaderSize = 1\r\n\t\t\t\t} else if (strLength < 0x100) {\r\n\t\t\t\t\theaderSize = 2\r\n\t\t\t\t} else if (strLength < 0x10000) {\r\n\t\t\t\t\theaderSize = 3\r\n\t\t\t\t} else {\r\n\t\t\t\t\theaderSize = 5\r\n\t\t\t\t}\r\n\t\t\t\tlet maxBytes = strLength * 3\r\n\t\t\t\tif (position + maxBytes > safeEnd)\r\n\t\t\t\t\ttarget = makeRoom(position + maxBytes)\r\n\r\n\t\t\t\tif (strLength < 0x40 || !encodeUtf8) {\r\n\t\t\t\t\tlet i, c1, c2, strPosition = position + headerSize\r\n\t\t\t\t\tfor (i = 0; i < strLength; i++) {\r\n\t\t\t\t\t\tc1 = value.charCodeAt(i)\r\n\t\t\t\t\t\tif (c1 < 0x80) {\r\n\t\t\t\t\t\t\ttarget[strPosition++] = c1\r\n\t\t\t\t\t\t} else if (c1 < 0x800) {\r\n\t\t\t\t\t\t\ttarget[strPosition++] = c1 >> 6 | 0xc0\r\n\t\t\t\t\t\t\ttarget[strPosition++] = c1 & 0x3f | 0x80\r\n\t\t\t\t\t\t} else if (\r\n\t\t\t\t\t\t\t(c1 & 0xfc00) === 0xd800 &&\r\n\t\t\t\t\t\t\t((c2 = value.charCodeAt(i + 1)) & 0xfc00) === 0xdc00\r\n\t\t\t\t\t\t) {\r\n\t\t\t\t\t\t\tc1 = 0x10000 + ((c1 & 0x03ff) << 10) + (c2 & 0x03ff)\r\n\t\t\t\t\t\t\ti++\r\n\t\t\t\t\t\t\ttarget[strPosition++] = c1 >> 18 | 0xf0\r\n\t\t\t\t\t\t\ttarget[strPosition++] = c1 >> 12 & 0x3f | 0x80\r\n\t\t\t\t\t\t\ttarget[strPosition++] = c1 >> 6 & 0x3f | 0x80\r\n\t\t\t\t\t\t\ttarget[strPosition++] = c1 & 0x3f | 0x80\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\ttarget[strPosition++] = c1 >> 12 | 0xe0\r\n\t\t\t\t\t\t\ttarget[strPosition++] = c1 >> 6 & 0x3f | 0x80\r\n\t\t\t\t\t\t\ttarget[strPosition++] = c1 & 0x3f | 0x80\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tlength = strPosition - position - headerSize\r\n\t\t\t\t} else {\r\n\t\t\t\t\tlength = encodeUtf8(value, position + headerSize, maxBytes)\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (length < 0x20) {\r\n\t\t\t\t\ttarget[position++] = 0xa0 | length\r\n\t\t\t\t} else if (length < 0x100) {\r\n\t\t\t\t\tif (headerSize < 2) {\r\n\t\t\t\t\t\ttarget.copyWithin(position + 2, position + 1, position + 1 + length)\r\n\t\t\t\t\t}\r\n\t\t\t\t\ttarget[position++] = 0xd9\r\n\t\t\t\t\ttarget[position++] = length\r\n\t\t\t\t} else if (length < 0x10000) {\r\n\t\t\t\t\tif (headerSize < 3) {\r\n\t\t\t\t\t\ttarget.copyWithin(position + 3, position + 2, position + 2 + length)\r\n\t\t\t\t\t}\r\n\t\t\t\t\ttarget[position++] = 0xda\r\n\t\t\t\t\ttarget[position++] = length >> 8\r\n\t\t\t\t\ttarget[position++] = length & 0xff\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif (headerSize < 5) {\r\n\t\t\t\t\t\ttarget.copyWithin(position + 5, position + 3, position + 3 + length)\r\n\t\t\t\t\t}\r\n\t\t\t\t\ttarget[position++] = 0xdb\r\n\t\t\t\t\ttargetView.setUint32(position, length)\r\n\t\t\t\t\tposition += 4\r\n\t\t\t\t}\r\n\t\t\t\tposition += length\r\n\t\t\t} else if (type === 'number') {\r\n\t\t\t\tif (value >>> 0 === value) {// positive integer, 32-bit or less\r\n\t\t\t\t\t// positive uint\r\n\t\t\t\t\tif (value < 0x40) {\r\n\t\t\t\t\t\ttarget[position++] = value\r\n\t\t\t\t\t} else if (value < 0x100) {\r\n\t\t\t\t\t\ttarget[position++] = 0xcc\r\n\t\t\t\t\t\ttarget[position++] = value\r\n\t\t\t\t\t} else if (value < 0x10000) {\r\n\t\t\t\t\t\ttarget[position++] = 0xcd\r\n\t\t\t\t\t\ttarget[position++] = value >> 8\r\n\t\t\t\t\t\ttarget[position++] = value & 0xff\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\ttarget[position++] = 0xce\r\n\t\t\t\t\t\ttargetView.setUint32(position, value)\r\n\t\t\t\t\t\tposition += 4\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if (value >> 0 === value) { // negative integer\r\n\t\t\t\t\tif (value >= -0x20) {\r\n\t\t\t\t\t\ttarget[position++] = 0x100 + value\r\n\t\t\t\t\t} else if (value >= -0x80) {\r\n\t\t\t\t\t\ttarget[position++] = 0xd0\r\n\t\t\t\t\t\ttarget[position++] = value + 0x100\r\n\t\t\t\t\t} else if (value >= -0x8000) {\r\n\t\t\t\t\t\ttarget[position++] = 0xd1\r\n\t\t\t\t\t\ttargetView.setInt16(position, value)\r\n\t\t\t\t\t\tposition += 2\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\ttarget[position++] = 0xd2\r\n\t\t\t\t\t\ttargetView.setInt32(position, value)\r\n\t\t\t\t\t\tposition += 4\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tlet useFloat32\r\n\t\t\t\t\tif ((useFloat32 = this.useFloat32) > 0 && value < 0x100000000 && value >= -0x80000000) {\r\n\t\t\t\t\t\ttarget[position++] = 0xca\r\n\t\t\t\t\t\ttargetView.setFloat32(position, value)\r\n\t\t\t\t\t\tlet xShifted\r\n\t\t\t\t\t\tif (useFloat32 < 4 ||\r\n\t\t\t\t\t\t\t\t// this checks for rounding of numbers that were encoded in 32-bit float to nearest significant decimal digit that could be preserved\r\n\t\t\t\t\t\t\t\t((xShifted = value * mult10[((target[position] & 0x7f) << 1) | (target[position + 1] >> 7)]) >> 0) === xShifted) {\r\n\t\t\t\t\t\t\tposition += 4\r\n\t\t\t\t\t\t\treturn\r\n\t\t\t\t\t\t} else\r\n\t\t\t\t\t\t\tposition-- // move back into position for writing a double\r\n\t\t\t\t\t}\r\n\t\t\t\t\ttarget[position++] = 0xcb\r\n\t\t\t\t\ttargetView.setFloat64(position, value)\r\n\t\t\t\t\tposition += 8\r\n\t\t\t\t}\r\n\t\t\t} else if (type === 'object') {\r\n\t\t\t\tif (!value)\r\n\t\t\t\t\ttarget[position++] = 0xc0\r\n\t\t\t\telse {\r\n\t\t\t\t\tif (referenceMap) {\r\n\t\t\t\t\t\tlet referee = referenceMap.get(value)\r\n\t\t\t\t\t\tif (referee) {\r\n\t\t\t\t\t\t\tif (!referee.id) {\r\n\t\t\t\t\t\t\t\tlet idsToInsert = referenceMap.idsToInsert || (referenceMap.idsToInsert = [])\r\n\t\t\t\t\t\t\t\treferee.id = idsToInsert.push(referee)\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\ttarget[position++] = 0xd6 // fixext 4\r\n\t\t\t\t\t\t\ttarget[position++] = 0x70 // \"p\" for pointer\r\n\t\t\t\t\t\t\ttargetView.setUint32(position, referee.id)\r\n\t\t\t\t\t\t\tposition += 4\r\n\t\t\t\t\t\t\treturn\r\n\t\t\t\t\t\t} else \r\n\t\t\t\t\t\t\treferenceMap.set(value, { offset: position - start })\r\n\t\t\t\t\t}\r\n\t\t\t\t\tlet constructor = value.constructor\r\n\t\t\t\t\tif (constructor === Object) {\r\n\t\t\t\t\t\twriteObject(value, true)\r\n\t\t\t\t\t} else if (constructor === Array) {\r\n\t\t\t\t\t\tlength = value.length\r\n\t\t\t\t\t\tif (length < 0x10) {\r\n\t\t\t\t\t\t\ttarget[position++] = 0x90 | length\r\n\t\t\t\t\t\t} else if (length < 0x10000) {\r\n\t\t\t\t\t\t\ttarget[position++] = 0xdc\r\n\t\t\t\t\t\t\ttarget[position++] = length >> 8\r\n\t\t\t\t\t\t\ttarget[position++] = length & 0xff\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\ttarget[position++] = 0xdd\r\n\t\t\t\t\t\t\ttargetView.setUint32(position, length)\r\n\t\t\t\t\t\t\tposition += 4\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tfor (let i = 0; i < length; i++) {\r\n\t\t\t\t\t\t\tpack(value[i])\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else if (constructor === Map) {\r\n\t\t\t\t\t\tlength = value.size\r\n\t\t\t\t\t\tif (length < 0x10) {\r\n\t\t\t\t\t\t\ttarget[position++] = 0x80 | length\r\n\t\t\t\t\t\t} else if (length < 0x10000) {\r\n\t\t\t\t\t\t\ttarget[position++] = 0xde\r\n\t\t\t\t\t\t\ttarget[position++] = length >> 8\r\n\t\t\t\t\t\t\ttarget[position++] = length & 0xff\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\ttarget[position++] = 0xdf\r\n\t\t\t\t\t\t\ttargetView.setUint32(position, length)\r\n\t\t\t\t\t\t\tposition += 4\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tfor (let [ key, entryValue ] of value) {\r\n\t\t\t\t\t\t\tpack(key)\r\n\t\t\t\t\t\t\tpack(entryValue)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\t\r\n\t\t\t\t\t\tfor (let i = 0, l = extensions.length; i < l; i++) {\r\n\t\t\t\t\t\t\tlet extensionClass = extensionClasses[i]\r\n\t\t\t\t\t\t\tif (value instanceof extensionClass) {\r\n\t\t\t\t\t\t\t\tlet extension = extensions[i]\r\n\t\t\t\t\t\t\t\tif (extension.write) {\r\n\t\t\t\t\t\t\t\t\tif (extension.type) {\r\n\t\t\t\t\t\t\t\t\t\ttarget[position++] = 0xd4 // one byte \"tag\" extension\r\n\t\t\t\t\t\t\t\t\t\ttarget[position++] = extension.type\r\n\t\t\t\t\t\t\t\t\t\ttarget[position++] = 0\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tpack(extension.write.call(this, value))\r\n\t\t\t\t\t\t\t\t\treturn\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tlet currentTarget = target\r\n\t\t\t\t\t\t\t\tlet currentTargetView = targetView\r\n\t\t\t\t\t\t\t\tlet currentPosition = position\r\n\t\t\t\t\t\t\t\ttarget = null\r\n\t\t\t\t\t\t\t\tlet result\r\n\t\t\t\t\t\t\t\ttry {\r\n\t\t\t\t\t\t\t\t\tresult = extension.pack.call(this, value, (size) => {\r\n\t\t\t\t\t\t\t\t\t\t// restore target and use it\r\n\t\t\t\t\t\t\t\t\t\ttarget = currentTarget\r\n\t\t\t\t\t\t\t\t\t\tcurrentTarget = null\r\n\t\t\t\t\t\t\t\t\t\tposition += size\r\n\t\t\t\t\t\t\t\t\t\tif (position > safeEnd)\r\n\t\t\t\t\t\t\t\t\t\t\tmakeRoom(position)\r\n\t\t\t\t\t\t\t\t\t\treturn {\r\n\t\t\t\t\t\t\t\t\t\t\ttarget, targetView, position: position - size\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}, pack)\r\n\t\t\t\t\t\t\t\t} finally {\r\n\t\t\t\t\t\t\t\t\t// restore current target information (unless already restored)\r\n\t\t\t\t\t\t\t\t\tif (currentTarget) {\r\n\t\t\t\t\t\t\t\t\t\ttarget = currentTarget\r\n\t\t\t\t\t\t\t\t\t\ttargetView = currentTargetView\r\n\t\t\t\t\t\t\t\t\t\tposition = currentPosition\r\n\t\t\t\t\t\t\t\t\t\tsafeEnd = target.length - 10\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tif (result) {\r\n\t\t\t\t\t\t\t\t\tif (result.length + position > safeEnd)\r\n\t\t\t\t\t\t\t\t\t\tmakeRoom(result.length + position)\r\n\t\t\t\t\t\t\t\t\tposition = writeExtensionData(result, target, position, extension.type)\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\treturn\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t// no extension found, write as object\r\n\t\t\t\t\t\twriteObject(value, !value.hasOwnProperty) // if it doesn't have hasOwnProperty, don't do hasOwnProperty checks\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t} else if (type === 'boolean') {\r\n\t\t\t\ttarget[position++] = value ? 0xc3 : 0xc2\r\n\t\t\t} else if (type === 'bigint') {\r\n\t\t\t\tif (value < (BigInt(1)<<BigInt(63)) && value >= -(BigInt(1)<<BigInt(63))) {\r\n\t\t\t\t\t// use a signed int as long as it fits\r\n\t\t\t\t\ttarget[position++] = 0xd3\r\n\t\t\t\t\ttargetView.setBigInt64(position, value)\r\n\t\t\t\t} else if (value < (BigInt(1)<<BigInt(64)) && value > 0) {\r\n\t\t\t\t\t// if we can fit an unsigned int, use that\r\n\t\t\t\t\ttarget[position++] = 0xcf\r\n\t\t\t\t\ttargetView.setBigUint64(position, value)\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// overflow\r\n\t\t\t\t\tif (this.largeBigIntToFloat) {\r\n\t\t\t\t\t\ttarget[position++] = 0xcb\r\n\t\t\t\t\t\ttargetView.setFloat64(position, Number(value))\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthrow new RangeError(value + ' was too large to fit in MessagePack 64-bit integer format, set largeBigIntToFloat to convert to float-64')\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tposition += 8\r\n\t\t\t} else if (type === 'undefined') {\r\n\t\t\t\tif (this.encodeUndefinedAsNil)\r\n\t\t\t\t\ttarget[position++] = 0xc0\r\n\t\t\t\telse {\r\n\t\t\t\t\ttarget[position++] = 0xd4 // a number of implementations use fixext1 with type 0, data 0 to denote undefined, so we follow suite\r\n\t\t\t\t\ttarget[position++] = 0\r\n\t\t\t\t\ttarget[position++] = 0\r\n\t\t\t\t}\r\n\t\t\t} else if (type === 'function') {\r\n\t\t\t\tpack(this.writeFunction && this.writeFunction()) // if there is a writeFunction, use it, otherwise just encode as undefined\r\n\t\t\t} else {\r\n\t\t\t\tthrow new Error('Unknown type: ' + type)\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tconst writeObject = this.useRecords === false ? this.variableMapSize ? (object) => {\r\n\t\t\t// this method is slightly slower, but generates \"preferred serialization\" (optimally small for smaller objects)\r\n\t\t\tlet keys = Object.keys(object)\r\n\t\t\tlet length = keys.length\r\n\t\t\tif (length < 0x10) {\r\n\t\t\t\ttarget[position++] = 0x80 | length\r\n\t\t\t} else if (length < 0x10000) {\r\n\t\t\t\ttarget[position++] = 0xde\r\n\t\t\t\ttarget[position++] = length >> 8\r\n\t\t\t\ttarget[position++] = length & 0xff\r\n\t\t\t} else {\r\n\t\t\t\ttarget[position++] = 0xdf\r\n\t\t\t\ttargetView.setUint32(position, length)\r\n\t\t\t\tposition += 4\r\n\t\t\t}\r\n\t\t\tlet key\r\n\t\t\tfor (let i = 0; i < length; i++) {\r\n\t\t\t\tpack(key = keys[i])\r\n\t\t\t\tpack(object[key])\r\n\t\t\t}\r\n\t\t} :\r\n\t\t(object, safePrototype) => {\r\n\t\t\ttarget[position++] = 0xde // always using map 16, so we can preallocate and set the length afterwards\r\n\t\t\tlet objectOffset = position - start\r\n\t\t\tposition += 2\r\n\t\t\tlet size = 0\r\n\t\t\tfor (let key in object) {\r\n\t\t\t\tif (safePrototype || object.hasOwnProperty(key)) {\r\n\t\t\t\t\tpack(key)\r\n\t\t\t\t\tpack(object[key])\r\n\t\t\t\t\tsize++\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\ttarget[objectOffset++ + start] = size >> 8\r\n\t\t\ttarget[objectOffset + start] = size & 0xff\r\n\t\t} :\r\n\t\t(options.progressiveRecords && !useTwoByteRecords) ?  // this is about 2% faster for highly stable structures, since it only requires one for-in loop (but much more expensive when new structure needs to be written)\r\n\t\t(object, safePrototype) => {\r\n\t\t\tlet nextTransition, transition = structures.transitions || (structures.transitions = Object.create(null))\r\n\t\t\tlet objectOffset = position++ - start\r\n\t\t\tlet wroteKeys\r\n\t\t\tfor (let key in object) {\r\n\t\t\t\tif (safePrototype || object.hasOwnProperty(key)) {\r\n\t\t\t\t\tnextTransition = transition[key]\r\n\t\t\t\t\tif (nextTransition)\r\n\t\t\t\t\t\ttransition = nextTransition\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\t// record doesn't exist, create full new record and insert it\r\n\t\t\t\t\t\tlet keys = Object.keys(object)\r\n\t\t\t\t\t\tlet lastTransition = transition\r\n\t\t\t\t\t\ttransition = structures.transitions\r\n\t\t\t\t\t\tlet newTransitions = 0\r\n\t\t\t\t\t\tfor (let i = 0, l = keys.length; i < l; i++) {\r\n\t\t\t\t\t\t\tlet key = keys[i]\r\n\t\t\t\t\t\t\tnextTransition = transition[key]\r\n\t\t\t\t\t\t\tif (!nextTransition) {\r\n\t\t\t\t\t\t\t\tnextTransition = transition[key] = Object.create(null)\r\n\t\t\t\t\t\t\t\tnewTransitions++\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\ttransition = nextTransition\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (objectOffset + start + 1 == position) {\r\n\t\t\t\t\t\t\t// first key, so we don't need to insert, we can just write record directly\r\n\t\t\t\t\t\t\tposition--\r\n\t\t\t\t\t\t\tnewRecord(transition, keys, newTransitions)\r\n\t\t\t\t\t\t} else // otherwise we need to insert the record, moving existing data after the record\r\n\t\t\t\t\t\t\tinsertNewRecord(transition, keys, objectOffset, newTransitions)\r\n\t\t\t\t\t\twroteKeys = true\r\n\t\t\t\t\t\ttransition = lastTransition[key]\r\n\t\t\t\t\t}\r\n\t\t\t\t\tpack(object[key])\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (!wroteKeys) {\r\n\t\t\t\tlet recordId = transition[RECORD_SYMBOL]\r\n\t\t\t\tif (recordId)\r\n\t\t\t\t\ttarget[objectOffset + start] = recordId\r\n\t\t\t\telse\r\n\t\t\t\t\tinsertNewRecord(transition, Object.keys(object), objectOffset, 0)\r\n\t\t\t}\r\n\t\t} :\r\n\t\t(object, safePrototype) => {\r\n\t\t\tlet nextTransition, transition = structures.transitions || (structures.transitions = Object.create(null))\r\n\t\t\tlet newTransitions = 0\r\n\t\t\tfor (let key in object) if (safePrototype || object.hasOwnProperty(key)) {\r\n\t\t\t\tnextTransition = transition[key]\r\n\t\t\t\tif (!nextTransition) {\r\n\t\t\t\t\tnextTransition = transition[key] = Object.create(null)\r\n\t\t\t\t\tnewTransitions++\r\n\t\t\t\t}\r\n\t\t\t\ttransition = nextTransition\r\n\t\t\t}\r\n\t\t\tlet recordId = transition[RECORD_SYMBOL]\r\n\t\t\tif (recordId) {\r\n\t\t\t\tif (recordId >= 0x60 && useTwoByteRecords) {\r\n\t\t\t\t\ttarget[position++] = ((recordId -= 0x60) & 0x1f) + 0x60\r\n\t\t\t\t\ttarget[position++] = recordId >> 5\r\n\t\t\t\t} else\r\n\t\t\t\t\ttarget[position++] = recordId\r\n\t\t\t} else {\r\n\t\t\t\tnewRecord(transition, transition.__keys__ || Object.keys(object), newTransitions)\r\n\t\t\t}\r\n\t\t\t// now write the values\r\n\t\t\tfor (let key in object)\r\n\t\t\t\tif (safePrototype || object.hasOwnProperty(key))\r\n\t\t\t\t\tpack(object[key])\r\n\t\t}\r\n\t\tconst makeRoom = (end) => {\r\n\t\t\tlet newSize\r\n\t\t\tif (end > 0x1000000) {\r\n\t\t\t\t// special handling for really large buffers\r\n\t\t\t\tif ((end - start) > MAX_BUFFER_SIZE)\r\n\t\t\t\t\tthrow new Error('Packed buffer would be larger than maximum buffer size')\r\n\t\t\t\tnewSize = Math.min(MAX_BUFFER_SIZE,\r\n\t\t\t\t\tMath.round(Math.max((end - start) * (end > 0x4000000 ? 1.25 : 2), 0x400000) / 0x1000) * 0x1000)\r\n\t\t\t} else // faster handling for smaller buffers\r\n\t\t\t\tnewSize = ((Math.max((end - start) << 2, target.length - 1) >> 12) + 1) << 12\r\n\t\t\tlet newBuffer = new ByteArrayAllocate(newSize)\r\n\t\t\ttargetView = new DataView(newBuffer.buffer, 0, newSize)\r\n\t\t\tif (target.copy)\r\n\t\t\t\ttarget.copy(newBuffer, 0, start, end)\r\n\t\t\telse\r\n\t\t\t\tnewBuffer.set(target.slice(start, end))\r\n\t\t\tposition -= start\r\n\t\t\tstart = 0\r\n\t\t\tsafeEnd = newBuffer.length - 10\r\n\t\t\treturn target = newBuffer\r\n\t\t}\r\n\t\tconst newRecord = (transition, keys, newTransitions) => {\r\n\t\t\tlet recordId = structures.nextId\r\n\t\t\tif (!recordId)\r\n\t\t\t\trecordId = 0x40\r\n\t\t\tif (recordId < sharedLimitId && this.shouldShareStructure && !this.shouldShareStructure(keys)) {\r\n\t\t\t\trecordId = structures.nextOwnId\r\n\t\t\t\tif (!(recordId < maxStructureId))\r\n\t\t\t\t\trecordId = sharedLimitId\r\n\t\t\t\tstructures.nextOwnId = recordId + 1\r\n\t\t\t} else {\r\n\t\t\t\tif (recordId >= maxStructureId)// cycle back around\r\n\t\t\t\t\trecordId = sharedLimitId\r\n\t\t\t\tstructures.nextId = recordId + 1\r\n\t\t\t}\r\n\t\t\tlet highByte = keys.highByte = recordId >= 0x60 && useTwoByteRecords ? (recordId - 0x60) >> 5 : -1\r\n\t\t\ttransition[RECORD_SYMBOL] = recordId\r\n\t\t\ttransition.__keys__ = keys\r\n\t\t\tstructures[recordId - 0x40] = keys\r\n\r\n\t\t\tif (recordId < sharedLimitId) {\r\n\t\t\t\tkeys.isShared = true\r\n\t\t\t\tstructures.sharedLength = recordId - 0x3f\r\n\t\t\t\thasSharedUpdate = true\r\n\t\t\t\tif (highByte >= 0) {\r\n\t\t\t\t\ttarget[position++] = (recordId & 0x1f) + 0x60\r\n\t\t\t\t\ttarget[position++] = highByte\r\n\t\t\t\t} else {\r\n\t\t\t\t\ttarget[position++] = recordId\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tif (highByte >= 0) {\r\n\t\t\t\t\ttarget[position++] = 0xd5 // fixext 2\r\n\t\t\t\t\ttarget[position++] = 0x72 // \"r\" record defintion extension type\r\n\t\t\t\t\ttarget[position++] = (recordId & 0x1f) + 0x60\r\n\t\t\t\t\ttarget[position++] = highByte\r\n\t\t\t\t} else {\r\n\t\t\t\t\ttarget[position++] = 0xd4 // fixext 1\r\n\t\t\t\t\ttarget[position++] = 0x72 // \"r\" record defintion extension type\r\n\t\t\t\t\ttarget[position++] = recordId\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (newTransitions)\r\n\t\t\t\t\ttransitionsCount += serializationsSinceTransitionRebuild * newTransitions\r\n\t\t\t\t// record the removal of the id, we can maintain our shared structure\r\n\t\t\t\tif (recordIdsToRemove.length >= maxOwnStructures)\r\n\t\t\t\t\trecordIdsToRemove.shift()[RECORD_SYMBOL] = 0 // we are cycling back through, and have to remove old ones\r\n\t\t\t\trecordIdsToRemove.push(transition)\r\n\t\t\t\tpack(keys)\r\n\t\t\t}\r\n\t\t}\r\n\t\tconst insertNewRecord = (transition, keys, insertionOffset, newTransitions) => {\r\n\t\t\tlet mainTarget = target\r\n\t\t\tlet mainPosition = position\r\n\t\t\tlet mainSafeEnd = safeEnd\r\n\t\t\tlet mainStart = start\r\n\t\t\ttarget = keysTarget\r\n\t\t\tposition = 0\r\n\t\t\tstart = 0\r\n\t\t\tif (!target)\r\n\t\t\t\tkeysTarget = target = new ByteArrayAllocate(8192)\r\n\t\t\tsafeEnd = target.length - 10\r\n\t\t\tnewRecord(transition, keys, newTransitions)\r\n\t\t\tkeysTarget = target\r\n\t\t\tlet keysPosition = position\r\n\t\t\ttarget = mainTarget\r\n\t\t\tposition = mainPosition\r\n\t\t\tsafeEnd = mainSafeEnd\r\n\t\t\tstart = mainStart\r\n\t\t\tif (keysPosition > 1) {\r\n\t\t\t\tlet newEnd = position + keysPosition - 1\r\n\t\t\t\tif (newEnd > safeEnd)\r\n\t\t\t\t\tmakeRoom(newEnd)\r\n\t\t\t\tlet insertionPosition = insertionOffset + start\r\n\t\t\t\ttarget.copyWithin(insertionPosition + keysPosition, insertionPosition + 1, position)\r\n\t\t\t\ttarget.set(keysTarget.slice(0, keysPosition), insertionPosition)\r\n\t\t\t\tposition = newEnd\r\n\t\t\t} else {\r\n\t\t\t\ttarget[insertionOffset + start] = keysTarget[0]\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tuseBuffer(buffer) {\r\n\t\t// this means we are finished using our own buffer and we can write over it safely\r\n\t\ttarget = buffer\r\n\t\ttargetView = new DataView(target.buffer, target.byteOffset, target.byteLength)\r\n\t\tposition = 0\r\n\t}\r\n\tclearSharedData() {\r\n\t\tif (this.structures)\r\n\t\t\tthis.structures = []\r\n\t}\r\n}\r\n\r\nfunction copyBinary(source, target, targetOffset, offset, endOffset) {\r\n\twhile (offset < endOffset) {\r\n\t\ttarget[targetOffset++] = source[offset++]\r\n\t}\r\n}\r\n\r\nextensionClasses = [ Date, Set, Error, RegExp, ArrayBuffer, Object.getPrototypeOf(Uint8Array.prototype).constructor /*TypedArray*/, C1Type ]\r\nextensions = [{\r\n\tpack(date, allocateForWrite, pack) {\r\n\t\tlet seconds = date.getTime() / 1000\r\n\t\tif ((this.useTimestamp32 || date.getMilliseconds() === 0) && seconds >= 0 && seconds < 0x100000000) {\r\n\t\t\t// Timestamp 32\r\n\t\t\tlet { target, targetView, position} = allocateForWrite(6)\r\n\t\t\ttarget[position++] = 0xd6\r\n\t\t\ttarget[position++] = 0xff\r\n\t\t\ttargetView.setUint32(position, seconds)\r\n\t\t} else if (seconds > 0 && seconds < 0x100000000) {\r\n\t\t\t// Timestamp 64\r\n\t\t\tlet { target, targetView, position} = allocateForWrite(10)\r\n\t\t\ttarget[position++] = 0xd7\r\n\t\t\ttarget[position++] = 0xff\r\n\t\t\ttargetView.setUint32(position, date.getMilliseconds() * 4000000 + ((seconds / 1000 / 0x100000000) >> 0))\r\n\t\t\ttargetView.setUint32(position + 4, seconds)\r\n\t\t} else if (isNaN(seconds)) {\r\n\t\t\tif (this.onInvalidDate) {\r\n\t\t\t\tallocateForWrite(0)\r\n\t\t\t\treturn pack(this.onInvalidDate())\r\n\t\t\t}\r\n\t\t\t// Intentionally invalid timestamp\r\n\t\t\tlet { target, targetView, position} = allocateForWrite(3)\r\n\t\t\ttarget[position++] = 0xd4\r\n\t\t\ttarget[position++] = 0xff\r\n\t\t\ttarget[position++] = 0xff\r\n\t\t} else {\r\n\t\t\t// Timestamp 96\r\n\t\t\tlet { target, targetView, position} = allocateForWrite(15)\r\n\t\t\ttarget[position++] = 0xc7\r\n\t\t\ttarget[position++] = 12\r\n\t\t\ttarget[position++] = 0xff\r\n\t\t\ttargetView.setUint32(position, date.getMilliseconds() * 1000000)\r\n\t\t\ttargetView.setBigInt64(position + 4, BigInt(Math.floor(seconds)))\r\n\t\t}\r\n\t}\r\n}, {\r\n\tpack(set, allocateForWrite, pack) {\r\n\t\tlet array = Array.from(set)\r\n\t\tlet { target, position} = allocateForWrite(this.moreTypes ? 3 : 0)\r\n\t\tif (this.moreTypes) {\r\n\t\t\ttarget[position++] = 0xd4\r\n\t\t\ttarget[position++] = 0x73 // 's' for Set\r\n\t\t\ttarget[position++] = 0\r\n\t\t}\r\n\t\tpack(array)\r\n\t}\r\n}, {\r\n\tpack(error, allocateForWrite, pack) {\r\n\t\tlet { target, position} = allocateForWrite(this.moreTypes ? 3 : 0)\r\n\t\tif (this.moreTypes) {\r\n\t\t\ttarget[position++] = 0xd4\r\n\t\t\ttarget[position++] = 0x65 // 'e' for error\r\n\t\t\ttarget[position++] = 0\r\n\t\t}\r\n\t\tpack([ error.name, error.message ])\r\n\t}\r\n}, {\r\n\tpack(regex, allocateForWrite, pack) {\r\n\t\tlet { target, position} = allocateForWrite(this.moreTypes ? 3 : 0)\r\n\t\tif (this.moreTypes) {\r\n\t\t\ttarget[position++] = 0xd4\r\n\t\t\ttarget[position++] = 0x78 // 'x' for regeXp\r\n\t\t\ttarget[position++] = 0\r\n\t\t}\r\n\t\tpack([ regex.source, regex.flags ])\r\n\t}\r\n}, {\r\n\tpack(arrayBuffer, allocateForWrite) {\r\n\t\tif (this.moreTypes)\r\n\t\t\twriteExtBuffer(arrayBuffer, 0x10, allocateForWrite)\r\n\t\telse\r\n\t\t\twriteBuffer(hasNodeBuffer ? Buffer.from(arrayBuffer) : new Uint8Array(arrayBuffer), allocateForWrite)\r\n\t}\r\n}, {\r\n\tpack(typedArray, allocateForWrite) {\r\n\t\tlet constructor = typedArray.constructor\r\n\t\tif (constructor !== ByteArray && this.moreTypes)\r\n\t\t\twriteExtBuffer(typedArray, typedArrays.indexOf(constructor.name), allocateForWrite)\r\n\t\telse\r\n\t\t\twriteBuffer(typedArray, allocateForWrite)\r\n\t}\r\n}, {\r\n\tpack(c1, allocateForWrite) { // specific 0xC1 object\r\n\t\tlet { target, position} = allocateForWrite(1)\r\n\t\ttarget[position] = 0xc1\r\n\t}\r\n}]\r\n\r\nfunction writeExtBuffer(typedArray, type, allocateForWrite, encode) {\r\n\tlet length = typedArray.byteLength\r\n\tif (length + 1 < 0x100) {\r\n\t\tvar { target, position } = allocateForWrite(4 + length)\r\n\t\ttarget[position++] = 0xc7\r\n\t\ttarget[position++] = length + 1\r\n\t} else if (length + 1 < 0x10000) {\r\n\t\tvar { target, position } = allocateForWrite(5 + length)\r\n\t\ttarget[position++] = 0xc8\r\n\t\ttarget[position++] = (length + 1) >> 8\r\n\t\ttarget[position++] = (length + 1) & 0xff\r\n\t} else {\r\n\t\tvar { target, position, targetView } = allocateForWrite(7 + length)\r\n\t\ttarget[position++] = 0xc9\r\n\t\ttargetView.setUint32(position, length + 1) // plus one for the type byte\r\n\t\tposition += 4\r\n\t}\r\n\ttarget[position++] = 0x74 // \"t\" for typed array\r\n\ttarget[position++] = type\r\n\ttarget.set(new Uint8Array(typedArray.buffer, typedArray.byteOffset, typedArray.byteLength), position)\r\n}\r\nfunction writeBuffer(buffer, allocateForWrite) {\r\n\tlet length = buffer.byteLength\r\n\tvar target, position\r\n\tif (length < 0x100) {\r\n\t\tvar { target, position } = allocateForWrite(length + 2)\r\n\t\ttarget[position++] = 0xc4\r\n\t\ttarget[position++] = length\r\n\t} else if (length < 0x10000) {\r\n\t\tvar { target, position } = allocateForWrite(length + 3)\r\n\t\ttarget[position++] = 0xc5\r\n\t\ttarget[position++] = length >> 8\r\n\t\ttarget[position++] = length & 0xff\r\n\t} else {\r\n\t\tvar { target, position, targetView } = allocateForWrite(length + 5)\r\n\t\ttarget[position++] = 0xc6\r\n\t\ttargetView.setUint32(position, length)\r\n\t\tposition += 4\r\n\t}\r\n\ttarget.set(buffer, position)\r\n}\r\n\r\nfunction writeExtensionData(result, target, position, type) {\r\n\tlet length = result.length\r\n\tswitch (length) {\r\n\t\tcase 1:\r\n\t\t\ttarget[position++] = 0xd4\r\n\t\t\tbreak\r\n\t\tcase 2:\r\n\t\t\ttarget[position++] = 0xd5\r\n\t\t\tbreak\r\n\t\tcase 4:\r\n\t\t\ttarget[position++] = 0xd6\r\n\t\t\tbreak\r\n\t\tcase 8:\r\n\t\t\ttarget[position++] = 0xd7\r\n\t\t\tbreak\r\n\t\tcase 16:\r\n\t\t\ttarget[position++] = 0xd8\r\n\t\t\tbreak\r\n\t\tdefault:\r\n\t\t\tif (length < 0x100) {\r\n\t\t\t\ttarget[position++] = 0xc7\r\n\t\t\t\ttarget[position++] = length\r\n\t\t\t} else if (length < 0x10000) {\r\n\t\t\t\ttarget[position++] = 0xc8\r\n\t\t\t\ttarget[position++] = length >> 8\r\n\t\t\t\ttarget[position++] = length & 0xff\r\n\t\t\t} else {\r\n\t\t\t\ttarget[position++] = 0xc9\r\n\t\t\t\ttarget[position++] = length >> 24\r\n\t\t\t\ttarget[position++] = (length >> 16) & 0xff\r\n\t\t\t\ttarget[position++] = (length >> 8) & 0xff\r\n\t\t\t\ttarget[position++] = length & 0xff\r\n\t\t\t}\r\n\t}\r\n\ttarget[position++] = type\r\n\ttarget.set(result, position)\r\n\tposition += length\r\n\treturn position\r\n}\r\n\r\nfunction insertIds(serialized, idsToInsert) {\r\n\t// insert the ids that need to be referenced for structured clones\r\n\tlet nextId\r\n\tlet distanceToMove = idsToInsert.length * 6\r\n\tlet lastEnd = serialized.length - distanceToMove\r\n\tidsToInsert.sort((a, b) => a.offset > b.offset ? 1 : -1)\r\n\twhile (nextId = idsToInsert.pop()) {\r\n\t\tlet offset = nextId.offset\r\n\t\tlet id = nextId.id\r\n\t\tserialized.copyWithin(offset + distanceToMove, offset, lastEnd)\r\n\t\tdistanceToMove -= 6\r\n\t\tlet position = offset + distanceToMove\r\n\t\tserialized[position++] = 0xd6\r\n\t\tserialized[position++] = 0x69 // 'i'\r\n\t\tserialized[position++] = id >> 24\r\n\t\tserialized[position++] = (id >> 16) & 0xff\r\n\t\tserialized[position++] = (id >> 8) & 0xff\r\n\t\tserialized[position++] = id & 0xff\r\n\t\tlastEnd = offset\r\n\t}\r\n\treturn serialized\r\n}\r\n\r\nfunction writeBundles(start, pack) {\r\n\ttargetView.setUint32(bundledStrings.position + start, position - bundledStrings.position - start)\r\n\tlet writeStrings = bundledStrings\r\n\tbundledStrings = null\r\n\tlet startPosition = position\r\n\tpack(writeStrings[0])\r\n\tpack(writeStrings[1])\r\n}\r\n\r\nexport function addExtension(extension) {\r\n\tif (extension.Class) {\r\n\t\tif (!extension.pack && !extension.write)\r\n\t\t\tthrow new Error('Extension has no pack or write function')\r\n\t\tif (extension.pack && !extension.type)\r\n\t\t\tthrow new Error('Extension has no type (numeric code to identify the extension)')\r\n\t\textensionClasses.unshift(extension.Class)\r\n\t\textensions.unshift(extension)\r\n\t}\r\n\tunpackAddExtension(extension)\r\n}\r\n\r\nlet defaultPackr = new Packr({ useRecords: false })\r\nexport const pack = defaultPackr.pack\r\nexport const encode = defaultPackr.pack\r\nexport const Encoder = Packr\r\nexport { FLOAT32_OPTIONS } from './unpack.js'\r\nimport { FLOAT32_OPTIONS } from './unpack.js'\r\nexport const { NEVER, ALWAYS, DECIMAL_ROUND, DECIMAL_FIT } = FLOAT32_OPTIONS\r\nexport const REUSE_BUFFER_MODE = 512\r\nexport const RESET_BUFFER_MODE = 1024\r\n","\"use strict\"\r\nvar decoder\r\ntry {\r\n\tdecoder = new TextDecoder()\r\n} catch(error) {}\r\nvar src\r\nvar srcEnd\r\nvar position = 0\r\nvar alreadySet\r\nconst EMPTY_ARRAY = []\r\nvar strings = EMPTY_ARRAY\r\nvar stringPosition = 0\r\nvar currentUnpackr = {}\r\nvar currentStructures\r\nvar srcString\r\nvar srcStringStart = 0\r\nvar srcStringEnd = 0\r\nvar bundledStrings\r\nvar referenceMap\r\nvar currentExtensions = []\r\nvar dataView\r\nvar defaultOptions = {\r\n\tuseRecords: false,\r\n\tmapsAsObjects: true\r\n}\r\nexport class C1Type {}\r\nexport const C1 = new C1Type()\r\nC1.name = 'MessagePack 0xC1'\r\nvar sequentialMode = false\r\nvar inlineObjectReadThreshold = 2\r\ntry {\r\n\tnew Function('')\r\n} catch(error) {\r\n\t// if eval variants are not supported, do not create inline object readers ever\r\n\tinlineObjectReadThreshold = Infinity\r\n}\r\n\r\nexport class Unpackr {\r\n\tconstructor(options) {\r\n\t\tif (options) {\r\n\t\t\tif (options.useRecords === false && options.mapsAsObjects === undefined)\r\n\t\t\t\toptions.mapsAsObjects = true\r\n\t\t\tif (options.structures)\r\n\t\t\t\toptions.structures.sharedLength = options.structures.length\r\n\t\t\telse if (options.getStructures) {\r\n\t\t\t\t(options.structures = []).uninitialized = true // this is what we use to denote an uninitialized structures\r\n\t\t\t\toptions.structures.sharedLength = 0\r\n\t\t\t}\r\n\t\t}\r\n\t\tObject.assign(this, options)\r\n\t}\r\n\tunpack(source, end) {\r\n\t\tif (src) {\r\n\t\t\t// re-entrant execution, save the state and restore it after we do this unpack\r\n\t\t\treturn saveState(() => {\r\n\t\t\t\tclearSource()\r\n\t\t\t\treturn this ? this.unpack(source, end) : Unpackr.prototype.unpack.call(defaultOptions, source, end)\r\n\t\t\t})\r\n\t\t}\r\n\t\tsrcEnd = end > -1 ? end : source.length\r\n\t\tposition = 0\r\n\t\tstringPosition = 0\r\n\t\tsrcStringEnd = 0\r\n\t\tsrcString = null\r\n\t\tstrings = EMPTY_ARRAY\r\n\t\tbundledStrings = null\r\n\t\tsrc = source\r\n\t\t// this provides cached access to the data view for a buffer if it is getting reused, which is a recommend\r\n\t\t// technique for getting data from a database where it can be copied into an existing buffer instead of creating\r\n\t\t// new ones\r\n\t\ttry {\r\n\t\t\tdataView = source.dataView || (source.dataView = new DataView(source.buffer, source.byteOffset, source.byteLength))\r\n\t\t} catch(error) {\r\n\t\t\t// if it doesn't have a buffer, maybe it is the wrong type of object\r\n\t\t\tsrc = null\r\n\t\t\tif (source instanceof Uint8Array)\r\n\t\t\t\tthrow error\r\n\t\t\tthrow new Error('Source must be a Uint8Array or Buffer but was a ' + ((source && typeof source == 'object') ? source.constructor.name : typeof source))\r\n\t\t}\r\n\t\tif (this instanceof Unpackr) {\r\n\t\t\tcurrentUnpackr = this\r\n\t\t\tif (this.structures) {\r\n\t\t\t\tcurrentStructures = this.structures\r\n\t\t\t\treturn checkedRead()\r\n\t\t\t} else if (!currentStructures || currentStructures.length > 0) {\r\n\t\t\t\tcurrentStructures = []\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tcurrentUnpackr = defaultOptions\r\n\t\t\tif (!currentStructures || currentStructures.length > 0)\r\n\t\t\t\tcurrentStructures = []\r\n\t\t}\r\n\t\treturn checkedRead()\r\n\t}\r\n\tunpackMultiple(source, forEach) {\r\n\t\tlet values, lastPosition = 0\r\n\t\ttry {\r\n\t\t\tsequentialMode = true\r\n\t\t\tlet size = source.length\r\n\t\t\tlet value = this ? this.unpack(source, size) : defaultUnpackr.unpack(source, size)\r\n\t\t\tif (forEach) {\r\n\t\t\t\tforEach(value)\r\n\t\t\t\twhile(position < size) {\r\n\t\t\t\t\tlastPosition = position\r\n\t\t\t\t\tif (forEach(checkedRead()) === false) {\r\n\t\t\t\t\t\treturn\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tvalues = [ value ]\r\n\t\t\t\twhile(position < size) {\r\n\t\t\t\t\tlastPosition = position\r\n\t\t\t\t\tvalues.push(checkedRead())\r\n\t\t\t\t}\r\n\t\t\t\treturn values\r\n\t\t\t}\r\n\t\t} catch(error) {\r\n\t\t\terror.lastPosition = lastPosition\r\n\t\t\terror.values = values\r\n\t\t\tthrow error\r\n\t\t} finally {\r\n\t\t\tsequentialMode = false\r\n\t\t\tclearSource()\r\n\t\t}\r\n\t}\r\n\t_mergeStructures(loadedStructures, existingStructures) {\r\n\t\tloadedStructures = loadedStructures || []\r\n\t\tfor (let i = 0, l = loadedStructures.length; i < l; i++) {\r\n\t\t\tlet structure = loadedStructures[i]\r\n\t\t\tif (structure) {\r\n\t\t\t\tstructure.isShared = true\r\n\t\t\t\tif (i >= 32)\r\n\t\t\t\t\tstructure.highByte = (i - 32) >> 5\r\n\t\t\t}\r\n\t\t}\r\n\t\tloadedStructures.sharedLength = loadedStructures.length\r\n\t\tfor (let id in existingStructures || []) {\r\n\t\t\tif (id >= 0) {\r\n\t\t\t\tlet structure = loadedStructures[id]\r\n\t\t\t\tlet existing = existingStructures[id]\r\n\t\t\t\tif (existing) {\r\n\t\t\t\t\tif (structure)\r\n\t\t\t\t\t\t(loadedStructures.restoreStructures || (loadedStructures.restoreStructures = []))[id] = structure\r\n\t\t\t\t\tloadedStructures[id] = existing\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn this.structures = loadedStructures\r\n\t}\r\n\tdecode(source, end) {\r\n\t\treturn this.unpack(source, end)\r\n\t}\r\n}\r\nexport function getPosition() {\r\n\treturn position\r\n}\r\nexport function checkedRead() {\r\n\ttry {\r\n\t\tif (!currentUnpackr.trusted && !sequentialMode) {\r\n\t\t\tlet sharedLength = currentStructures.sharedLength || 0\r\n\t\t\tif (sharedLength < currentStructures.length)\r\n\t\t\t\tcurrentStructures.length = sharedLength\r\n\t\t}\r\n\t\tlet result = read()\r\n\t\tif (bundledStrings) // bundled strings to skip past\r\n\t\t\tposition = bundledStrings.postBundlePosition\r\n\r\n\t\tif (position == srcEnd) {\r\n\t\t\t// finished reading this source, cleanup references\r\n\t\t\tif (currentStructures.restoreStructures)\r\n\t\t\t\trestoreStructures()\r\n\t\t\tcurrentStructures = null\r\n\t\t\tsrc = null\r\n\t\t\tif (referenceMap)\r\n\t\t\t\treferenceMap = null\r\n\t\t} else if (position > srcEnd) {\r\n\t\t\t// over read\r\n\t\t\tlet error = new Error('Unexpected end of MessagePack data')\r\n\t\t\terror.incomplete = true\r\n\t\t\tthrow error\r\n\t\t} else if (!sequentialMode) {\r\n\t\t\tthrow new Error('Data read, but end of buffer not reached')\r\n\t\t}\r\n\t\t// else more to read, but we are reading sequentially, so don't clear source yet\r\n\t\treturn result\r\n\t} catch(error) {\r\n\t\tif (currentStructures.restoreStructures)\r\n\t\t\trestoreStructures()\r\n\t\tclearSource()\r\n\t\tif (error instanceof RangeError || error.message.startsWith('Unexpected end of buffer')) {\r\n\t\t\terror.incomplete = true\r\n\t\t}\r\n\t\tthrow error\r\n\t}\r\n}\r\n\r\nfunction restoreStructures() {\r\n\tfor (let id in currentStructures.restoreStructures) {\r\n\t\tcurrentStructures[id] = currentStructures.restoreStructures[id]\r\n\t}\r\n\tcurrentStructures.restoreStructures = null\r\n}\r\n\r\nexport function read() {\r\n\tlet token = src[position++]\r\n\tif (token < 0xa0) {\r\n\t\tif (token < 0x80) {\r\n\t\t\tif (token < 0x40)\r\n\t\t\t\treturn token\r\n\t\t\telse {\r\n\t\t\t\tlet structure = currentStructures[token & 0x3f] ||\r\n\t\t\t\t\tcurrentUnpackr.getStructures && loadStructures()[token & 0x3f]\r\n\t\t\t\tif (structure) {\r\n\t\t\t\t\tif (!structure.read) {\r\n\t\t\t\t\t\tstructure.read = createStructureReader(structure, token & 0x3f)\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn structure.read()\r\n\t\t\t\t} else\r\n\t\t\t\t\treturn token\r\n\t\t\t}\r\n\t\t} else if (token < 0x90) {\r\n\t\t\t// map\r\n\t\t\ttoken -= 0x80\r\n\t\t\tif (currentUnpackr.mapsAsObjects) {\r\n\t\t\t\tlet object = {}\r\n\t\t\t\tfor (let i = 0; i < token; i++) {\r\n\t\t\t\t\tobject[readKey()] = read()\r\n\t\t\t\t}\r\n\t\t\t\treturn object\r\n\t\t\t} else {\r\n\t\t\t\tlet map = new Map()\r\n\t\t\t\tfor (let i = 0; i < token; i++) {\r\n\t\t\t\t\tmap.set(read(), read())\r\n\t\t\t\t}\r\n\t\t\t\treturn map\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\ttoken -= 0x90\r\n\t\t\tlet array = new Array(token)\r\n\t\t\tfor (let i = 0; i < token; i++) {\r\n\t\t\t\tarray[i] = read()\r\n\t\t\t}\r\n\t\t\treturn array\r\n\t\t}\r\n\t} else if (token < 0xc0) {\r\n\t\t// fixstr\r\n\t\tlet length = token - 0xa0\r\n\t\tif (srcStringEnd >= position) {\r\n\t\t\treturn srcString.slice(position - srcStringStart, (position += length) - srcStringStart)\r\n\t\t}\r\n\t\tif (srcStringEnd == 0 && srcEnd < 140) {\r\n\t\t\t// for small blocks, avoiding the overhead of the extract call is helpful\r\n\t\t\tlet string = length < 16 ? shortStringInJS(length) : longStringInJS(length)\r\n\t\t\tif (string != null)\r\n\t\t\t\treturn string\r\n\t\t}\r\n\t\treturn readFixedString(length)\r\n\t} else {\r\n\t\tlet value\r\n\t\tswitch (token) {\r\n\t\t\tcase 0xc0: return null\r\n\t\t\tcase 0xc1:\r\n\t\t\t\tif (bundledStrings) {\r\n\t\t\t\t\tvalue = read() // followed by the length of the string in characters (not bytes!)\r\n\t\t\t\t\tif (value > 0)\r\n\t\t\t\t\t\treturn bundledStrings[1].slice(bundledStrings.position1, bundledStrings.position1 += value)\r\n\t\t\t\t\telse\r\n\t\t\t\t\t\treturn bundledStrings[0].slice(bundledStrings.position0, bundledStrings.position0 -= value)\r\n\t\t\t\t}\r\n\t\t\t\treturn C1; // \"never-used\", return special object to denote that\r\n\t\t\tcase 0xc2: return false\r\n\t\t\tcase 0xc3: return true\r\n\t\t\tcase 0xc4:\r\n\t\t\t\t// bin 8\r\n\t\t\t\treturn readBin(src[position++])\r\n\t\t\tcase 0xc5:\r\n\t\t\t\t// bin 16\r\n\t\t\t\tvalue = dataView.getUint16(position)\r\n\t\t\t\tposition += 2\r\n\t\t\t\treturn readBin(value)\r\n\t\t\tcase 0xc6:\r\n\t\t\t\t// bin 32\r\n\t\t\t\tvalue = dataView.getUint32(position)\r\n\t\t\t\tposition += 4\r\n\t\t\t\treturn readBin(value)\r\n\t\t\tcase 0xc7:\r\n\t\t\t\t// ext 8\r\n\t\t\t\treturn readExt(src[position++])\r\n\t\t\tcase 0xc8:\r\n\t\t\t\t// ext 16\r\n\t\t\t\tvalue = dataView.getUint16(position)\r\n\t\t\t\tposition += 2\r\n\t\t\t\treturn readExt(value)\r\n\t\t\tcase 0xc9:\r\n\t\t\t\t// ext 32\r\n\t\t\t\tvalue = dataView.getUint32(position)\r\n\t\t\t\tposition += 4\r\n\t\t\t\treturn readExt(value)\r\n\t\t\tcase 0xca:\r\n\t\t\t\tvalue = dataView.getFloat32(position)\r\n\t\t\t\tif (currentUnpackr.useFloat32 > 2) {\r\n\t\t\t\t\t// this does rounding of numbers that were encoded in 32-bit float to nearest significant decimal digit that could be preserved\r\n\t\t\t\t\tlet multiplier = mult10[((src[position] & 0x7f) << 1) | (src[position + 1] >> 7)]\r\n\t\t\t\t\tposition += 4\r\n\t\t\t\t\treturn ((multiplier * value + (value > 0 ? 0.5 : -0.5)) >> 0) / multiplier\r\n\t\t\t\t}\r\n\t\t\t\tposition += 4\r\n\t\t\t\treturn value\r\n\t\t\tcase 0xcb:\r\n\t\t\t\tvalue = dataView.getFloat64(position)\r\n\t\t\t\tposition += 8\r\n\t\t\t\treturn value\r\n\t\t\t// uint handlers\r\n\t\t\tcase 0xcc:\r\n\t\t\t\treturn src[position++]\r\n\t\t\tcase 0xcd:\r\n\t\t\t\tvalue = dataView.getUint16(position)\r\n\t\t\t\tposition += 2\r\n\t\t\t\treturn value\r\n\t\t\tcase 0xce:\r\n\t\t\t\tvalue = dataView.getUint32(position)\r\n\t\t\t\tposition += 4\r\n\t\t\t\treturn value\r\n\t\t\tcase 0xcf:\r\n\t\t\t\tif (currentUnpackr.int64AsNumber) {\r\n\t\t\t\t\tvalue = dataView.getUint32(position) * 0x100000000\r\n\t\t\t\t\tvalue += dataView.getUint32(position + 4)\r\n\t\t\t\t} else\r\n\t\t\t\t\tvalue = dataView.getBigUint64(position)\r\n\t\t\t\tposition += 8\r\n\t\t\t\treturn value\r\n\r\n\t\t\t// int handlers\r\n\t\t\tcase 0xd0:\r\n\t\t\t\treturn dataView.getInt8(position++)\r\n\t\t\tcase 0xd1:\r\n\t\t\t\tvalue = dataView.getInt16(position)\r\n\t\t\t\tposition += 2\r\n\t\t\t\treturn value\r\n\t\t\tcase 0xd2:\r\n\t\t\t\tvalue = dataView.getInt32(position)\r\n\t\t\t\tposition += 4\r\n\t\t\t\treturn value\r\n\t\t\tcase 0xd3:\r\n\t\t\t\tif (currentUnpackr.int64AsNumber) {\r\n\t\t\t\t\tvalue = dataView.getInt32(position) * 0x100000000\r\n\t\t\t\t\tvalue += dataView.getUint32(position + 4)\r\n\t\t\t\t} else\r\n\t\t\t\t\tvalue = dataView.getBigInt64(position)\r\n\t\t\t\tposition += 8\r\n\t\t\t\treturn value\r\n\r\n\t\t\tcase 0xd4:\r\n\t\t\t\t// fixext 1\r\n\t\t\t\tvalue = src[position++]\r\n\t\t\t\tif (value == 0x72) {\r\n\t\t\t\t\treturn recordDefinition(src[position++] & 0x3f)\r\n\t\t\t\t} else {\r\n\t\t\t\t\tlet extension = currentExtensions[value]\r\n\t\t\t\t\tif (extension) {\r\n\t\t\t\t\t\tif (extension.read) {\r\n\t\t\t\t\t\t\tposition++ // skip filler byte\r\n\t\t\t\t\t\t\treturn extension.read(read())\r\n\t\t\t\t\t\t} else if (extension.noBuffer) {\r\n\t\t\t\t\t\t\tposition++ // skip filler byte\r\n\t\t\t\t\t\t\treturn extension()\r\n\t\t\t\t\t\t} else\r\n\t\t\t\t\t\t\treturn extension(src.subarray(position, ++position))\r\n\t\t\t\t\t} else\r\n\t\t\t\t\t\tthrow new Error('Unknown extension ' + value)\r\n\t\t\t\t}\r\n\t\t\tcase 0xd5:\r\n\t\t\t\t// fixext 2\r\n\t\t\t\tvalue = src[position]\r\n\t\t\t\tif (value == 0x72) {\r\n\t\t\t\t\tposition++\r\n\t\t\t\t\treturn recordDefinition(src[position++] & 0x3f, src[position++])\r\n\t\t\t\t} else\r\n\t\t\t\t\treturn readExt(2)\r\n\t\t\tcase 0xd6:\r\n\t\t\t\t// fixext 4\r\n\t\t\t\treturn readExt(4)\r\n\t\t\tcase 0xd7:\r\n\t\t\t\t// fixext 8\r\n\t\t\t\treturn readExt(8)\r\n\t\t\tcase 0xd8:\r\n\t\t\t\t// fixext 16\r\n\t\t\t\treturn readExt(16)\r\n\t\t\tcase 0xd9:\r\n\t\t\t// str 8\r\n\t\t\t\tvalue = src[position++]\r\n\t\t\t\tif (srcStringEnd >= position) {\r\n\t\t\t\t\treturn srcString.slice(position - srcStringStart, (position += value) - srcStringStart)\r\n\t\t\t\t}\r\n\t\t\t\treturn readString8(value)\r\n\t\t\tcase 0xda:\r\n\t\t\t// str 16\r\n\t\t\t\tvalue = dataView.getUint16(position)\r\n\t\t\t\tposition += 2\r\n\t\t\t\tif (srcStringEnd >= position) {\r\n\t\t\t\t\treturn srcString.slice(position - srcStringStart, (position += value) - srcStringStart)\r\n\t\t\t\t}\r\n\t\t\t\treturn readString16(value)\r\n\t\t\tcase 0xdb:\r\n\t\t\t// str 32\r\n\t\t\t\tvalue = dataView.getUint32(position)\r\n\t\t\t\tposition += 4\r\n\t\t\t\tif (srcStringEnd >= position) {\r\n\t\t\t\t\treturn srcString.slice(position - srcStringStart, (position += value) - srcStringStart)\r\n\t\t\t\t}\r\n\t\t\t\treturn readString32(value)\r\n\t\t\tcase 0xdc:\r\n\t\t\t// array 16\r\n\t\t\t\tvalue = dataView.getUint16(position)\r\n\t\t\t\tposition += 2\r\n\t\t\t\treturn readArray(value)\r\n\t\t\tcase 0xdd:\r\n\t\t\t// array 32\r\n\t\t\t\tvalue = dataView.getUint32(position)\r\n\t\t\t\tposition += 4\r\n\t\t\t\treturn readArray(value)\r\n\t\t\tcase 0xde:\r\n\t\t\t// map 16\r\n\t\t\t\tvalue = dataView.getUint16(position)\r\n\t\t\t\tposition += 2\r\n\t\t\t\treturn readMap(value)\r\n\t\t\tcase 0xdf:\r\n\t\t\t// map 32\r\n\t\t\t\tvalue = dataView.getUint32(position)\r\n\t\t\t\tposition += 4\r\n\t\t\t\treturn readMap(value)\r\n\t\t\tdefault: // negative int\r\n\t\t\t\tif (token >= 0xe0)\r\n\t\t\t\t\treturn token - 0x100\r\n\t\t\t\tif (token === undefined) {\r\n\t\t\t\t\tlet error = new Error('Unexpected end of MessagePack data')\r\n\t\t\t\t\terror.incomplete = true\r\n\t\t\t\t\tthrow error\r\n\t\t\t\t}\r\n\t\t\t\tthrow new Error('Unknown MessagePack token ' + token)\r\n\r\n\t\t}\r\n\t}\r\n}\r\nconst validName = /^[a-zA-Z_$][a-zA-Z\\d_$]*$/\r\nfunction createStructureReader(structure, firstId) {\r\n\tfunction readObject() {\r\n\t\t// This initial function is quick to instantiate, but runs slower. After several iterations pay the cost to build the faster function\r\n\t\tif (readObject.count++ > inlineObjectReadThreshold) {\r\n\t\t\tlet readObject = structure.read = (new Function('r', 'return function(){return {' + structure.map(key => validName.test(key) ? key + ':r()' : ('[' + JSON.stringify(key) + ']:r()')).join(',') + '}}'))(read)\r\n\t\t\tif (structure.highByte === 0)\r\n\t\t\t\tstructure.read = createSecondByteReader(firstId, structure.read)\r\n\t\t\treturn readObject() // second byte is already read, if there is one so immediately read object\r\n\t\t}\r\n\t\tlet object = {}\r\n\t\tfor (let i = 0, l = structure.length; i < l; i++) {\r\n\t\t\tlet key = structure[i]\r\n\t\t\tobject[key] = read()\r\n\t\t}\r\n\t\treturn object\r\n\t}\r\n\treadObject.count = 0\r\n\tif (structure.highByte === 0) {\r\n\t\treturn createSecondByteReader(firstId, readObject)\r\n\t}\r\n\treturn readObject\r\n}\r\n\r\nconst createSecondByteReader = (firstId, read0) => {\r\n\treturn function() {\r\n\t\tlet highByte = src[position++]\r\n\t\tif (highByte === 0)\r\n\t\t\treturn read0()\r\n\t\tlet id = firstId < 32 ? -(firstId + (highByte << 5)) : firstId + (highByte << 5)\r\n\t\tlet structure = currentStructures[id] || loadStructures()[id]\r\n\t\tif (!structure) {\r\n\t\t\tthrow new Error('Record id is not defined for ' + id)\r\n\t\t}\r\n\t\tif (!structure.read)\r\n\t\t\tstructure.read = createStructureReader(structure, firstId)\r\n\t\treturn structure.read()\r\n\t}\r\n}\r\n\r\nfunction loadStructures() {\r\n\tlet loadedStructures = saveState(() => {\r\n\t\t// save the state in case getStructures modifies our buffer\r\n\t\tsrc = null\r\n\t\treturn currentUnpackr.getStructures()\r\n\t})\r\n\treturn currentStructures = currentUnpackr._mergeStructures(loadedStructures, currentStructures)\r\n}\r\n\r\nvar readFixedString = readStringJS\r\nvar readString8 = readStringJS\r\nvar readString16 = readStringJS\r\nvar readString32 = readStringJS\r\nexport let isNativeAccelerationEnabled = false\r\n\r\nexport function setExtractor(extractStrings) {\r\n\tisNativeAccelerationEnabled = true\r\n\treadFixedString = readString(1)\r\n\treadString8 = readString(2)\r\n\treadString16 = readString(3)\r\n\treadString32 = readString(5)\r\n\tfunction readString(headerLength) {\r\n\t\treturn function readString(length) {\r\n\t\t\tlet string = strings[stringPosition++]\r\n\t\t\tif (string == null) {\r\n\t\t\t\tif (bundledStrings)\r\n\t\t\t\t\treturn readStringJS(length)\r\n\t\t\t\tlet extraction = extractStrings(position - headerLength, srcEnd, src)\r\n\t\t\t\tif (typeof extraction == 'string') {\r\n\t\t\t\t\tstring = extraction\r\n\t\t\t\t\tstrings = EMPTY_ARRAY\r\n\t\t\t\t} else {\r\n\t\t\t\t\tstrings = extraction\r\n\t\t\t\t\tstringPosition = 1\r\n\t\t\t\t\tsrcStringEnd = 1 // even if a utf-8 string was decoded, must indicate we are in the midst of extracted strings and can't skip strings\r\n\t\t\t\t\tstring = strings[0]\r\n\t\t\t\t\tif (string === undefined)\r\n\t\t\t\t\t\tthrow new Error('Unexpected end of buffer')\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tlet srcStringLength = string.length\r\n\t\t\tif (srcStringLength <= length) {\r\n\t\t\t\tposition += length\r\n\t\t\t\treturn string\r\n\t\t\t}\r\n\t\t\tsrcString = string\r\n\t\t\tsrcStringStart = position\r\n\t\t\tsrcStringEnd = position + srcStringLength\r\n\t\t\tposition += length\r\n\t\t\treturn string.slice(0, length) // we know we just want the beginning\r\n\t\t}\r\n\t}\r\n}\r\nfunction readStringJS(length) {\r\n\tlet result\r\n\tif (length < 16) {\r\n\t\tif (result = shortStringInJS(length))\r\n\t\t\treturn result\r\n\t}\r\n\tif (length > 64 && decoder)\r\n\t\treturn decoder.decode(src.subarray(position, position += length))\r\n\tconst end = position + length\r\n\tconst units = []\r\n\tresult = ''\r\n\twhile (position < end) {\r\n\t\tconst byte1 = src[position++]\r\n\t\tif ((byte1 & 0x80) === 0) {\r\n\t\t\t// 1 byte\r\n\t\t\tunits.push(byte1)\r\n\t\t} else if ((byte1 & 0xe0) === 0xc0) {\r\n\t\t\t// 2 bytes\r\n\t\t\tconst byte2 = src[position++] & 0x3f\r\n\t\t\tunits.push(((byte1 & 0x1f) << 6) | byte2)\r\n\t\t} else if ((byte1 & 0xf0) === 0xe0) {\r\n\t\t\t// 3 bytes\r\n\t\t\tconst byte2 = src[position++] & 0x3f\r\n\t\t\tconst byte3 = src[position++] & 0x3f\r\n\t\t\tunits.push(((byte1 & 0x1f) << 12) | (byte2 << 6) | byte3)\r\n\t\t} else if ((byte1 & 0xf8) === 0xf0) {\r\n\t\t\t// 4 bytes\r\n\t\t\tconst byte2 = src[position++] & 0x3f\r\n\t\t\tconst byte3 = src[position++] & 0x3f\r\n\t\t\tconst byte4 = src[position++] & 0x3f\r\n\t\t\tlet unit = ((byte1 & 0x07) << 0x12) | (byte2 << 0x0c) | (byte3 << 0x06) | byte4\r\n\t\t\tif (unit > 0xffff) {\r\n\t\t\t\tunit -= 0x10000\r\n\t\t\t\tunits.push(((unit >>> 10) & 0x3ff) | 0xd800)\r\n\t\t\t\tunit = 0xdc00 | (unit & 0x3ff)\r\n\t\t\t}\r\n\t\t\tunits.push(unit)\r\n\t\t} else {\r\n\t\t\tunits.push(byte1)\r\n\t\t}\r\n\r\n\t\tif (units.length >= 0x1000) {\r\n\t\t\tresult += fromCharCode.apply(String, units)\r\n\t\t\tunits.length = 0\r\n\t\t}\r\n\t}\r\n\r\n\tif (units.length > 0) {\r\n\t\tresult += fromCharCode.apply(String, units)\r\n\t}\r\n\r\n\treturn result\r\n}\r\n\r\nfunction readArray(length) {\r\n\tlet array = new Array(length)\r\n\tfor (let i = 0; i < length; i++) {\r\n\t\tarray[i] = read()\r\n\t}\r\n\treturn array\r\n}\r\n\r\nfunction readMap(length) {\r\n\tif (currentUnpackr.mapsAsObjects) {\r\n\t\tlet object = {}\r\n\t\tfor (let i = 0; i < length; i++) {\r\n\t\t\tobject[readKey()] = read()\r\n\t\t}\r\n\t\treturn object\r\n\t} else {\r\n\t\tlet map = new Map()\r\n\t\tfor (let i = 0; i < length; i++) {\r\n\t\t\tmap.set(read(), read())\r\n\t\t}\r\n\t\treturn map\r\n\t}\r\n}\r\n\r\nvar fromCharCode = String.fromCharCode\r\nfunction longStringInJS(length) {\r\n\tlet start = position\r\n\tlet bytes = new Array(length)\r\n\tfor (let i = 0; i < length; i++) {\r\n\t\tconst byte = src[position++];\r\n\t\tif ((byte & 0x80) > 0) {\r\n\t\t\tposition = start\r\n    \t\t\treturn\r\n    \t\t}\r\n    \t\tbytes[i] = byte\r\n    \t}\r\n    \treturn fromCharCode.apply(String, bytes)\r\n}\r\nfunction shortStringInJS(length) {\r\n\tif (length < 4) {\r\n\t\tif (length < 2) {\r\n\t\t\tif (length === 0)\r\n\t\t\t\treturn ''\r\n\t\t\telse {\r\n\t\t\t\tlet a = src[position++]\r\n\t\t\t\tif ((a & 0x80) > 1) {\r\n\t\t\t\t\tposition -= 1\r\n\t\t\t\t\treturn\r\n\t\t\t\t}\r\n\t\t\t\treturn fromCharCode(a)\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tlet a = src[position++]\r\n\t\t\tlet b = src[position++]\r\n\t\t\tif ((a & 0x80) > 0 || (b & 0x80) > 0) {\r\n\t\t\t\tposition -= 2\r\n\t\t\t\treturn\r\n\t\t\t}\r\n\t\t\tif (length < 3)\r\n\t\t\t\treturn fromCharCode(a, b)\r\n\t\t\tlet c = src[position++]\r\n\t\t\tif ((c & 0x80) > 0) {\r\n\t\t\t\tposition -= 3\r\n\t\t\t\treturn\r\n\t\t\t}\r\n\t\t\treturn fromCharCode(a, b, c)\r\n\t\t}\r\n\t} else {\r\n\t\tlet a = src[position++]\r\n\t\tlet b = src[position++]\r\n\t\tlet c = src[position++]\r\n\t\tlet d = src[position++]\r\n\t\tif ((a & 0x80) > 0 || (b & 0x80) > 0 || (c & 0x80) > 0 || (d & 0x80) > 0) {\r\n\t\t\tposition -= 4\r\n\t\t\treturn\r\n\t\t}\r\n\t\tif (length < 6) {\r\n\t\t\tif (length === 4)\r\n\t\t\t\treturn fromCharCode(a, b, c, d)\r\n\t\t\telse {\r\n\t\t\t\tlet e = src[position++]\r\n\t\t\t\tif ((e & 0x80) > 0) {\r\n\t\t\t\t\tposition -= 5\r\n\t\t\t\t\treturn\r\n\t\t\t\t}\r\n\t\t\t\treturn fromCharCode(a, b, c, d, e)\r\n\t\t\t}\r\n\t\t} else if (length < 8) {\r\n\t\t\tlet e = src[position++]\r\n\t\t\tlet f = src[position++]\r\n\t\t\tif ((e & 0x80) > 0 || (f & 0x80) > 0) {\r\n\t\t\t\tposition -= 6\r\n\t\t\t\treturn\r\n\t\t\t}\r\n\t\t\tif (length < 7)\r\n\t\t\t\treturn fromCharCode(a, b, c, d, e, f)\r\n\t\t\tlet g = src[position++]\r\n\t\t\tif ((g & 0x80) > 0) {\r\n\t\t\t\tposition -= 7\r\n\t\t\t\treturn\r\n\t\t\t}\r\n\t\t\treturn fromCharCode(a, b, c, d, e, f, g)\r\n\t\t} else {\r\n\t\t\tlet e = src[position++]\r\n\t\t\tlet f = src[position++]\r\n\t\t\tlet g = src[position++]\r\n\t\t\tlet h = src[position++]\r\n\t\t\tif ((e & 0x80) > 0 || (f & 0x80) > 0 || (g & 0x80) > 0 || (h & 0x80) > 0) {\r\n\t\t\t\tposition -= 8\r\n\t\t\t\treturn\r\n\t\t\t}\r\n\t\t\tif (length < 10) {\r\n\t\t\t\tif (length === 8)\r\n\t\t\t\t\treturn fromCharCode(a, b, c, d, e, f, g, h)\r\n\t\t\t\telse {\r\n\t\t\t\t\tlet i = src[position++]\r\n\t\t\t\t\tif ((i & 0x80) > 0) {\r\n\t\t\t\t\t\tposition -= 9\r\n\t\t\t\t\t\treturn\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn fromCharCode(a, b, c, d, e, f, g, h, i)\r\n\t\t\t\t}\r\n\t\t\t} else if (length < 12) {\r\n\t\t\t\tlet i = src[position++]\r\n\t\t\t\tlet j = src[position++]\r\n\t\t\t\tif ((i & 0x80) > 0 || (j & 0x80) > 0) {\r\n\t\t\t\t\tposition -= 10\r\n\t\t\t\t\treturn\r\n\t\t\t\t}\r\n\t\t\t\tif (length < 11)\r\n\t\t\t\t\treturn fromCharCode(a, b, c, d, e, f, g, h, i, j)\r\n\t\t\t\tlet k = src[position++]\r\n\t\t\t\tif ((k & 0x80) > 0) {\r\n\t\t\t\t\tposition -= 11\r\n\t\t\t\t\treturn\r\n\t\t\t\t}\r\n\t\t\t\treturn fromCharCode(a, b, c, d, e, f, g, h, i, j, k)\r\n\t\t\t} else {\r\n\t\t\t\tlet i = src[position++]\r\n\t\t\t\tlet j = src[position++]\r\n\t\t\t\tlet k = src[position++]\r\n\t\t\t\tlet l = src[position++]\r\n\t\t\t\tif ((i & 0x80) > 0 || (j & 0x80) > 0 || (k & 0x80) > 0 || (l & 0x80) > 0) {\r\n\t\t\t\t\tposition -= 12\r\n\t\t\t\t\treturn\r\n\t\t\t\t}\r\n\t\t\t\tif (length < 14) {\r\n\t\t\t\t\tif (length === 12)\r\n\t\t\t\t\t\treturn fromCharCode(a, b, c, d, e, f, g, h, i, j, k, l)\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tlet m = src[position++]\r\n\t\t\t\t\t\tif ((m & 0x80) > 0) {\r\n\t\t\t\t\t\t\tposition -= 13\r\n\t\t\t\t\t\t\treturn\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn fromCharCode(a, b, c, d, e, f, g, h, i, j, k, l, m)\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tlet m = src[position++]\r\n\t\t\t\t\tlet n = src[position++]\r\n\t\t\t\t\tif ((m & 0x80) > 0 || (n & 0x80) > 0) {\r\n\t\t\t\t\t\tposition -= 14\r\n\t\t\t\t\t\treturn\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (length < 15)\r\n\t\t\t\t\t\treturn fromCharCode(a, b, c, d, e, f, g, h, i, j, k, l, m, n)\r\n\t\t\t\t\tlet o = src[position++]\r\n\t\t\t\t\tif ((o & 0x80) > 0) {\r\n\t\t\t\t\t\tposition -= 15\r\n\t\t\t\t\t\treturn\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn fromCharCode(a, b, c, d, e, f, g, h, i, j, k, l, m, n, o)\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction readOnlyJSString() {\r\n\tlet token = src[position++]\r\n\tlet length\r\n\tif (token < 0xc0) {\r\n\t\t// fixstr\r\n\t\tlength = token - 0xa0\r\n\t} else {\r\n\t\tswitch(token) {\r\n\t\t\tcase 0xd9:\r\n\t\t\t// str 8\r\n\t\t\t\tlength = src[position++]\r\n\t\t\t\tbreak\r\n\t\t\tcase 0xda:\r\n\t\t\t// str 16\r\n\t\t\t\tlength = dataView.getUint16(position)\r\n\t\t\t\tposition += 2\r\n\t\t\t\tbreak\r\n\t\t\tcase 0xdb:\r\n\t\t\t// str 32\r\n\t\t\t\tlength = dataView.getUint32(position)\r\n\t\t\t\tposition += 4\r\n\t\t\t\tbreak\r\n\t\t\tdefault:\r\n\t\t\t\tthrow new Error('Expected string')\r\n\t\t}\r\n\t}\r\n\treturn readStringJS(length)\r\n}\r\n\r\n\r\nfunction readBin(length) {\r\n\treturn currentUnpackr.copyBuffers ?\r\n\t\t// specifically use the copying slice (not the node one)\r\n\t\tUint8Array.prototype.slice.call(src, position, position += length) :\r\n\t\tsrc.subarray(position, position += length)\r\n}\r\nfunction readExt(length) {\r\n\tlet type = src[position++]\r\n\tif (currentExtensions[type]) {\r\n\t\treturn currentExtensions[type](src.subarray(position, position += length))\r\n\t}\r\n\telse\r\n\t\tthrow new Error('Unknown extension type ' + type)\r\n}\r\n\r\nvar keyCache = new Array(4096)\r\nfunction readKey() {\r\n\tlet length = src[position++]\r\n\tif (length >= 0xa0 && length < 0xc0) {\r\n\t\t// fixstr, potentially use key cache\r\n\t\tlength = length - 0xa0\r\n\t\tif (srcStringEnd >= position) // if it has been extracted, must use it (and faster anyway)\r\n\t\t\treturn srcString.slice(position - srcStringStart, (position += length) - srcStringStart)\r\n\t\telse if (!(srcStringEnd == 0 && srcEnd < 180))\r\n\t\t\treturn readFixedString(length)\r\n\t} else { // not cacheable, go back and do a standard read\r\n\t\tposition--\r\n\t\treturn read()\r\n\t}\r\n\tlet key = ((length << 5) ^ (length > 1 ? dataView.getUint16(position) : length > 0 ? src[position] : 0)) & 0xfff\r\n\tlet entry = keyCache[key]\r\n\tlet checkPosition = position\r\n\tlet end = position + length - 3\r\n\tlet chunk\r\n\tlet i = 0\r\n\tif (entry && entry.bytes == length) {\r\n\t\twhile (checkPosition < end) {\r\n\t\t\tchunk = dataView.getUint32(checkPosition)\r\n\t\t\tif (chunk != entry[i++]) {\r\n\t\t\t\tcheckPosition = 0x70000000\r\n\t\t\t\tbreak\r\n\t\t\t}\r\n\t\t\tcheckPosition += 4\r\n\t\t}\r\n\t\tend += 3\r\n\t\twhile (checkPosition < end) {\r\n\t\t\tchunk = src[checkPosition++]\r\n\t\t\tif (chunk != entry[i++]) {\r\n\t\t\t\tcheckPosition = 0x70000000\r\n\t\t\t\tbreak\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (checkPosition === end) {\r\n\t\t\tposition = checkPosition\r\n\t\t\treturn entry.string\r\n\t\t}\r\n\t\tend -= 3\r\n\t\tcheckPosition = position\r\n\t}\r\n\tentry = []\r\n\tkeyCache[key] = entry\r\n\tentry.bytes = length\r\n\twhile (checkPosition < end) {\r\n\t\tchunk = dataView.getUint32(checkPosition)\r\n\t\tentry.push(chunk)\r\n\t\tcheckPosition += 4\r\n\t}\r\n\tend += 3\r\n\twhile (checkPosition < end) {\r\n\t\tchunk = src[checkPosition++]\r\n\t\tentry.push(chunk)\r\n\t}\r\n\t// for small blocks, avoiding the overhead of the extract call is helpful\r\n\tlet string = length < 16 ? shortStringInJS(length) : longStringInJS(length)\r\n\tif (string != null)\r\n\t\treturn entry.string = string\r\n\treturn entry.string = readFixedString(length)\r\n}\r\n\r\n// the registration of the record definition extension (as \"r\")\r\nconst recordDefinition = (id, highByte) => {\r\n\tvar structure = read()\r\n\tlet firstByte = id\r\n\tif (highByte !== undefined) {\r\n\t\tid = id < 32 ? -((highByte << 5) + id) : ((highByte << 5) + id)\r\n\t\tstructure.highByte = highByte\r\n\t}\r\n\tlet existingStructure = currentStructures[id]\r\n\tif (existingStructure && existingStructure.isShared) {\r\n\t\t(currentStructures.restoreStructures || (currentStructures.restoreStructures = []))[id] = existingStructure\r\n\t}\r\n\tcurrentStructures[id] = structure\r\n\tstructure.read = createStructureReader(structure, firstByte)\r\n\treturn structure.read()\r\n}\r\nvar glbl = typeof self == 'object' ? self : global\r\ncurrentExtensions[0] = () => {} // notepack defines extension 0 to mean undefined, so use that as the default here\r\ncurrentExtensions[0].noBuffer = true\r\n\r\ncurrentExtensions[0x65] = () => {\r\n\tlet data = read()\r\n\treturn (glbl[data[0]] || Error)(data[1])\r\n}\r\n\r\ncurrentExtensions[0x69] = (data) => {\r\n\t// id extension (for structured clones)\r\n\tlet id = dataView.getUint32(position - 4)\r\n\tif (!referenceMap)\r\n\t\treferenceMap = new Map()\r\n\tlet token = src[position]\r\n\tlet target\r\n\t// TODO: handle Maps, Sets, and other types that can cycle; this is complicated, because you potentially need to read\r\n\t// ahead past references to record structure definitions\r\n\tif (token >= 0x90 && token < 0xa0 || token == 0xdc || token == 0xdd)\r\n\t\ttarget = []\r\n\telse\r\n\t\ttarget = {}\r\n\r\n\tlet refEntry = { target } // a placeholder object\r\n\treferenceMap.set(id, refEntry)\r\n\tlet targetProperties = read() // read the next value as the target object to id\r\n\tif (refEntry.used) // there is a cycle, so we have to assign properties to original target\r\n\t\treturn Object.assign(target, targetProperties)\r\n\trefEntry.target = targetProperties // the placeholder wasn't used, replace with the deserialized one\r\n\treturn targetProperties // no cycle, can just use the returned read object\r\n}\r\n\r\ncurrentExtensions[0x70] = (data) => {\r\n\t// pointer extension (for structured clones)\r\n\tlet id = dataView.getUint32(position - 4)\r\n\tlet refEntry = referenceMap.get(id)\r\n\trefEntry.used = true\r\n\treturn refEntry.target\r\n}\r\n\r\ncurrentExtensions[0x73] = () => new Set(read())\r\n\r\nexport const typedArrays = ['Int8','Uint8','Uint8Clamped','Int16','Uint16','Int32','Uint32','Float32','Float64','BigInt64','BigUint64'].map(type => type + 'Array')\r\n\r\ncurrentExtensions[0x74] = (data) => {\r\n\tlet typeCode = data[0]\r\n\tlet typedArrayName = typedArrays[typeCode]\r\n\tif (!typedArrayName)\r\n\t\tthrow new Error('Could not find typed array for code ' + typeCode)\r\n\t// we have to always slice/copy here to get a new ArrayBuffer that is word/byte aligned\r\n\treturn new glbl[typedArrayName](Uint8Array.prototype.slice.call(data, 1).buffer)\r\n}\r\ncurrentExtensions[0x78] = () => {\r\n\tlet data = read()\r\n\treturn new RegExp(data[0], data[1])\r\n}\r\nconst TEMP_BUNDLE = []\r\ncurrentExtensions[0x62] = (data) => {\r\n\tlet dataSize = (data[0] << 24) + (data[1] << 16) + (data[2] << 8) + data[3]\r\n\tlet dataPosition = position\r\n\tposition += dataSize - data.length\r\n\tbundledStrings = TEMP_BUNDLE\r\n\tbundledStrings = [readOnlyJSString(), readOnlyJSString()]\r\n\tbundledStrings.position0 = 0\r\n\tbundledStrings.position1 = 0\r\n\tbundledStrings.postBundlePosition = position\r\n\tposition = dataPosition\r\n\treturn read()\r\n}\r\n\r\ncurrentExtensions[0xff] = (data) => {\r\n\t// 32-bit date extension\r\n\tif (data.length == 4)\r\n\t\treturn new Date((data[0] * 0x1000000 + (data[1] << 16) + (data[2] << 8) + data[3]) * 1000)\r\n\telse if (data.length == 8)\r\n\t\treturn new Date(\r\n\t\t\t((data[0] << 22) + (data[1] << 14) + (data[2] << 6) + (data[3] >> 2)) / 1000000 +\r\n\t\t\t((data[3] & 0x3) * 0x100000000 + data[4] * 0x1000000 + (data[5] << 16) + (data[6] << 8) + data[7]) * 1000)\r\n\telse if (data.length == 12)// TODO: Implement support for negative\r\n\t\treturn new Date(\r\n\t\t\t((data[0] << 24) + (data[1] << 16) + (data[2] << 8) + data[3]) / 1000000 +\r\n\t\t\t(((data[4] & 0x80) ? -0x1000000000000 : 0) + data[6] * 0x10000000000 + data[7] * 0x100000000 + data[8] * 0x1000000 + (data[9] << 16) + (data[10] << 8) + data[11]) * 1000)\r\n\telse\r\n\t\treturn new Date('invalid')\r\n} // notepack defines extension 0 to mean undefined, so use that as the default here\r\n// registration of bulk record definition?\r\n// currentExtensions[0x52] = () =>\r\n\r\nfunction saveState(callback) {\r\n\tlet savedSrcEnd = srcEnd\r\n\tlet savedPosition = position\r\n\tlet savedStringPosition = stringPosition\r\n\tlet savedSrcStringStart = srcStringStart\r\n\tlet savedSrcStringEnd = srcStringEnd\r\n\tlet savedSrcString = srcString\r\n\tlet savedStrings = strings\r\n\tlet savedReferenceMap = referenceMap\r\n\tlet savedBundledStrings = bundledStrings\r\n\r\n\t// TODO: We may need to revisit this if we do more external calls to user code (since it could be slow)\r\n\tlet savedSrc = new Uint8Array(src.slice(0, srcEnd)) // we copy the data in case it changes while external data is processed\r\n\tlet savedStructures = currentStructures\r\n\tlet savedStructuresContents = currentStructures.slice(0, currentStructures.length)\r\n\tlet savedPackr = currentUnpackr\r\n\tlet savedSequentialMode = sequentialMode\r\n\tlet value = callback()\r\n\tsrcEnd = savedSrcEnd\r\n\tposition = savedPosition\r\n\tstringPosition = savedStringPosition\r\n\tsrcStringStart = savedSrcStringStart\r\n\tsrcStringEnd = savedSrcStringEnd\r\n\tsrcString = savedSrcString\r\n\tstrings = savedStrings\r\n\treferenceMap = savedReferenceMap\r\n\tbundledStrings = savedBundledStrings\r\n\tsrc = savedSrc\r\n\tsequentialMode = savedSequentialMode\r\n\tcurrentStructures = savedStructures\r\n\tcurrentStructures.splice(0, currentStructures.length, ...savedStructuresContents)\r\n\tcurrentUnpackr = savedPackr\r\n\tdataView = new DataView(src.buffer, src.byteOffset, src.byteLength)\r\n\treturn value\r\n}\r\nexport function clearSource() {\r\n\tsrc = null\r\n\treferenceMap = null\r\n\tcurrentStructures = null\r\n}\r\n\r\nexport function addExtension(extension) {\r\n\tif (extension.unpack)\r\n\t\tcurrentExtensions[extension.type] = extension.unpack\r\n\telse\r\n\t\tcurrentExtensions[extension.type] = extension\r\n}\r\n\r\nexport const mult10 = new Array(147) // this is a table matching binary exponents to the multiplier to determine significant digit rounding\r\nfor (let i = 0; i < 256; i++) {\r\n\tmult10[i] = +('1e' + Math.floor(45.15 - i * 0.30103))\r\n}\r\nexport const Decoder = Unpackr\r\nvar defaultUnpackr = new Unpackr({ useRecords: false })\r\nexport const unpack = defaultUnpackr.unpack\r\nexport const unpackMultiple = defaultUnpackr.unpackMultiple\r\nexport const decode = defaultUnpackr.unpack\r\nexport const FLOAT32_OPTIONS = {\r\n\tNEVER: 0,\r\n\tALWAYS: 1,\r\n\tDECIMAL_ROUND: 3,\r\n\tDECIMAL_FIT: 4\r\n}\r\nlet f32Array = new Float32Array(1)\r\nlet u8Array = new Uint8Array(f32Array.buffer, 0, 4)\r\nexport function roundFloat32(float32Number) {\r\n\tf32Array[0] = float32Number\r\n\tlet multiplier = mult10[((u8Array[3] & 0x7f) << 1) | (u8Array[2] >> 7)]\r\n\treturn ((multiplier * float32Number + (float32Number > 0 ? 0.5 : -0.5)) >> 0) / multiplier\r\n}\r\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","const Cookies = require('js-cookie')\nconst serial = require('../src/utils/serial')\nconst physics = require('../src/game/physics')\nconst here = document.location\nconst tps = physics.TICKS_PER_SECOND\nconst TURN_UNIT = 2 * Math.PI / tps\nconst BASE_SELF = { dead: true, posX: 0, posY: 0, velX: 0, velY: 0, orient: 0, speedMul: 1 }\nconst ZOOM_LEVELS = [1.0, 1.5, 2.0]\nconst canvas = document.getElementById('screen')\n\nconst common = require('./common')\nconst cursor = require('./cursor')\n\nlet inGame = false\nlet ws = null\nlet self = BASE_SELF\nlet connectTimer = null\n\nlet objects = {\n  ships: [],\n  bullets: [],\n  powerups: [],\n  planets: []\n}\nlet state = {\n  dead: false,\n  token: null,\n  mouseLocked: false\n}\nlet ticksPerFrame = 1\n\nlet count = 1\nlet leaderboard = []\nlet rubber = 150\nlet no_data = 0\nlet pinger = null\nlet seed = 0\nlet zoom = 1\nlet lastPartialTick = null\n\nlet resendCtrl = false\n\nconst draw = require('./draw')(canvas, self, objects, state, cursor)\nconst controls = require('./controls')(canvas, self, state, cursor,\n  {\n    useItem: () => useItem(),\n    resendControls: () => resendCtrl = true,\n    tryLockMouse: (e) => tryLockMouse(e),\n    nextZoom: () => nextZoom(),\n  })\nconst joystick = require('./joystick')(self, state, controls)\nconst tick = require('./tick')(self, objects, controls)\nlet ui\n\ndraw.checkSize()\n\nconst updateZoomText = () => {\n  ui.updateZoomText(zoom)\n  draw.checkSize()\n}\n\nconst setZoom = z => {\n  zoom = z\n  draw.setZoom(z)\n  updateZoomText()\n}\n\nconst nextZoom = () => {\n  let indx = (ZOOM_LEVELS.indexOf(zoom) + 1) % ZOOM_LEVELS.length\n  if (indx < 0) {\n    indx += ZOOM_LEVELS.length\n  }\n  Cookies.set('avaruuspeli-zoom', indx, { sameSite: 'strict' })\n  setZoom(ZOOM_LEVELS[indx])\n}\n\nconst onConnect = () => {\n  state.dead = false\n  if (connectTimer !== null) {\n    clearTimeout(connectTimer)\n    connectTimer = null\n  }\n  let nick = document.getElementById('nick').value.trim()\n  const perk = document.getElementById('perkselect').value.trim()\n  if (nick.length < 1) {\n    nick = ((100000000 * Math.random()) | 0).toString()\n  } else {\n    Cookies.set('avaruuspeli-name', nick)\n  }\n  Cookies.set('avaruuspeli-perk', perk)\n  ui.updateOnlineStatus('waiting for spawn')\n  serial.send(ws, serial.e_join(nick, perk))\n  draw.checkSize()\n  ui.updateControls(state)\n  joystick.resetJoystickCenter()\n  pinger = setInterval(() => {\n    if (++no_data > 8 || ws == null) {\n      disconnect()\n      return\n    }\n    serial.send(ws, serial.e_ping(performance.now()))\n  }, 500)\n}\n\nconst disconnect = () => {\n  ui.disconnect()\n  leaveGame()\n}\n\nconst gotData = obj => {\n  let you = null\n  let ships = []\n  let projs = null\n  let oldHealth = {}\n  for (const ship of objects.ships) {\n    oldHealth[ship._id] = ship.health\n  }\n\n  ({ you, ships, projs, count, rubber, seed } = obj)\n  draw.setRubber(rubber)\n\n  objects.ships = ships\n\n  for (const ship of ships) {\n    if (Object.prototype.hasOwnProperty.call(oldHealth, ship._id) && oldHealth[ship._id] > ship.health) {\n      draw.addBubble({ x: ship.posX, y: ship.posY, alpha: 100, radius: 0.3 * (1 + oldHealth[ship._id] - ship.health) })\n    }\n  }\n\n  if (self.dead) {\n    Object.assign(self, you)\n    self.dead = false\n  } else {\n    // if there is a high velocity difference, average them out\n    if (Math.abs(you.posX - self.posX) > 0.3) {\n      self.posX = (self.posX + 3 * you.posX) / 4\n      self.velX = (self.velX + you.velX) / 2\n    }\n    if (Math.abs(you.posY - self.posY) > 0.3) {\n      self.posY = (self.posY + 3 * you.posY) / 4\n      self.velY = (self.velY + you.velY) / 2\n    }\n    if (Math.abs(you.velX - self.velX) > 0.2) {\n      self.velX = you.velX\n    }\n    if (Math.abs(you.velY - self.velY) > 0.2) {\n      self.posY = you.posY\n    }\n    \n    if (controls.isAccelerating() !== (you.accel !== null)\n        || controls.isBraking() !== (you.brake !== null)) {\n      resendCtrl = true\n    }\n    ui.updateScore(you.score, self.score)\n    self.name = you.name\n    self.score = you.score\n    self.dead = you.dead\n    if (you.health < self.health) {\n      draw.gotDamage(self.health - you.health)\n      draw.addBubble({ x: self.posX, y: self.posY, alpha: 100, radius: 0.3 * (1 + self.health - you.health) })\n    }\n    self.health = you.health\n    self.latched = you.latched\n    self.speedMul = you.speedMul\n    self.item = you.item\n    self.regen = you.regen\n    self.overdrive = you.overdrive\n    self.rubbership = you.rubbership\n  }\n  if (physics.getPlanetSeed() != seed) {\n    physics.setPlanetSeed(seed)\n    objects.planets = physics.getPlanets(self.posX, self.posY)\n  }\n  if (projs.length) {\n    objects.bullets = [...objects.bullets, ...projs.filter(x => x)]\n  }\n  ui.updatePowerup(self, state)\n  physics.setPlanetSeed(seed)\n  ui.updatePlayerCount(count)\n  ui.updateHealthBar(self.health)\n  ui.updateDebugInfo(self.thrustBoost.toFixed(6))\n}\n\nconst joinGame = () => {\n  if (!inGame) {\n    ui.joiningGame()\n    ui.hideDialog()\n\n    connectTimer = setTimeout(() => disconnect(), 5000)\n\n    let wsproto = here.protocol.replace('http', 'ws')\n    let port = here.port\n    if (port) {\n      port = `:${port}`\n    }\n    ws = new WebSocket(`${wsproto}//${here.hostname}${port}${here.pathname}`)\n    ws.binaryType = 'arraybuffer'\n    inGame = true\n\n    ws.addEventListener('message', (e) => {\n      let data = serial.recv(e.data)\n      if (data instanceof ArrayBuffer)\n        data = new Uint8Array(data)\n      const [cmd, obj] = serial.decode(data)\n\n      switch (cmd) {\n      case serial.C_token:\n        ui.updateOnlineStatus('in game')\n        state.token = obj.token\n        break\n\n      case serial.C_pong:\n        ui.updateOnlineStatus(\n          `in game, ping: ${Math.max(performance.now() - obj.time, 0).toFixed(1)}ms`)\n        break\n\n      case serial.C_data:\n        no_data = 0\n        obj.you = serial.deserializeShip(obj.you)\n        obj.ships = obj.ships.map(serial.deserializeShip)\n        obj.projs = obj.projs.map(serial.deserializeBullet)\n        gotData(obj)\n        state.dead = self.dead\n        break\n\n      case serial.C_board:\n        leaderboard = obj.board\n        ui.updateLeaderboard(leaderboard)\n        break\n\n      case serial.C_orient:\n        self.orient = obj.orient\n        break\n\n      case serial.C_unauth:\n        disconnect()\n        break\n\n      case serial.C_killed:\n        draw.explosion(self, ticksPerFrame)\n        leaveGame()\n        ui.defeatedByPlayer(obj.ship)\n        break\n\n      case serial.C_crashed:\n        draw.explosion(self, ticksPerFrame)\n        leaveGame()\n        ui.defeatedByCrash(obj.ship)\n        break\n\n      case serial.C_hitpl:\n        draw.explosion(self, ticksPerFrame)\n        leaveGame()\n        ui.defeatedByPlanet(obj.ship)\n        self.velX = 0\n        self.velY = 0\n        break\n\n      case serial.C_killship:\n        obj.ship = serial.deserializeShip(obj.ship)\n        if (objects.ships.find(ship => ship._id === obj.ship._id) !== null) {\n          draw.explosion(obj.ship, ticksPerFrame)\n        }\n        objects.ships = objects.ships.filter(ship => ship._id !== obj.ship._id)\n        break\n\n      case serial.C_killproj:\n        objects.bullets = objects.bullets.filter(bullet => bullet._id !== obj.proj)\n        break\n\n      case serial.C_minexpl:\n      {\n        const mine = serial.deserializeBullet(obj.mine)\n        draw.addBubble({ x: mine.posX, y: mine.posY, alpha: 200, radius: 1 })\n        break\n      }\n\n      case serial.C_addpup:\n        objects.powerups.push(serial.deserializePowerup(obj.powerup))\n        ui.showPowerupAnimation()\n        break\n\n      case serial.C_delpup:\n        objects.powerups = objects.powerups.filter(powerup => powerup._id !== obj.powerup)\n        break\n\n      case serial.C_deathk:\n        ui.addDeathLog(`${obj.ship} was killed by ${obj.by}`)\n        break\n\n      case serial.C_deathc:\n        ui.addDeathLog(`${obj.ship} crashed into ${obj.by}`)\n        break\n\n      case serial.C_deathp:\n        ui.addDeathLog(`${obj.ship} crashed into a planet`)\n        break\n\n      case serial.C_addpups:\n        objects.powerups.push(...obj.powerups.map(serial.deserializePowerup))\n        break\n      }\n    })\n    \n    ws.addEventListener('open', () => {\n      onConnect()\n    })\n    \n    ws.addEventListener('close', () => {\n      if (!state.dead) {\n        disconnect()\n      }\n      state.dead = true\n    })\n  }\n}\n\nconst leaveGame = () => {\n  if (pinger !== null) {\n    clearInterval(pinger)\n    pinger = null\n  }\n  if (ws !== null) {\n    ws.close()\n  }\n  if (state.mouseLocked) {\n    document.exitPointerLock()\n  }\n  state.token = null\n  state.dead = self.dead = true\n  ws = null\n  inGame = false\n\n  objects.ships = []\n  objects.bullets = []\n  objects.powerups = []\n\n  draw.reset()\n  controls.reset()\n  ui.updateOnlineStatus('offline')\n  ui.showDialog()\n  draw.checkSize()\n  ui.updateControls(state)\n}\n\nconst serverTick = () => {\n  if (!ws || !self) {\n    self.velX *= 0.95\n    self.velY *= 0.95\n    return\n  }\n\n  if (!state.token) {\n    return\n  }\n\n  if (resendCtrl) {\n    serial.send(ws, serial.e_ctrl(state.token, self.orient, \n      controls.isAccelerating(), controls.isBraking(), controls.isFiring()))\n    resendCtrl = false\n  }\n  \n  tick.serverTick(rubber)\n  ui.updateColors(self.health, performance.now())\n}\nsetInterval(serverTick, physics.MS_PER_TICK)\n\nlet turnLeftRamp = 0\nlet turnRightRamp = 0\n\nconst partialTick = (delta) => {\n  ticksPerFrame = 1.0 * delta / physics.MS_PER_TICK\n\n  if (!self.latched) {\n    // turning\n    const turnLeft = controls.isTurningLeft()\n    const turnRight = controls.isTurningRight()\n    if (turnLeft && !turnRight) {\n      self.orient -= turnLeftRamp * TURN_UNIT * ticksPerFrame\n      turnLeftRamp = Math.min(1, turnLeftRamp + ticksPerFrame * 0.1)\n      //physics.onTurn(self, chron.timeMs())\n      resendCtrl = true\n    } else if (turnRight && !turnLeft) {\n      self.orient += turnRightRamp * TURN_UNIT * ticksPerFrame\n      turnRightRamp = Math.min(1, turnRightRamp + ticksPerFrame * 0.1)\n      //physics.onTurn(self, chron.timeMs())\n      resendCtrl = true\n    }\n    if (!turnLeft)\n      turnLeftRamp = 0\n    if (!turnRight)\n      turnRightRamp = 0\n  } else {\n    turnLeftRamp = 0\n    turnRightRamp = 0\n  }\n  \n  // interpolate\n  self.posX += ticksPerFrame * self.velX\n  self.posY += ticksPerFrame * self.velY\n\n  for (const ship of objects.ships) {\n    ship.posX += ticksPerFrame * ship.velX\n    ship.posY += ticksPerFrame * ship.velY\n  }\n  for (const bullet of objects.bullets) {\n    if (bullet.type == 'bullet' || bullet.type == 'laser') {\n      bullet.posX += ticksPerFrame * bullet.velX\n      bullet.posY += ticksPerFrame * bullet.velY\n      bullet.dist += ticksPerFrame * bullet.velocity\n    } else if (bullet.type == 'mine') {\n      bullet.dist += ticksPerFrame / (physics.TICKS_PER_SECOND * physics.MINE_LIFETIME)\n    }\n  }\n  objects.bullets = objects.bullets.filter(b => b.dist <= physics.MAX_BULLET_DISTANCE)\n}\n\nconst useItem = () => {\n  if (self.item !== null) {\n    serial.send(ws, serial.e_useitem(state.token))\n    self.item = null\n  }\n}\n\nconst tryLockMouse = (e) => {\n  if (common.isMobile()) {\n    return\n  }\n  cursor.setPosition(e.clientX, e.clientY)\n  canvas.requestPointerLock()\n}\n\nwindow.addEventListener('blur', () => {\n  if (!state.token || state.dead) {\n    return\n  }\n  controls.unpress()\n}, true)\n\nwindow.addEventListener('beforeunload', () => {\n  if (ws) serial.send(ws, serial.e_quit(state.token))\n}, true)\n\nconst tryReadCookies = () => {\n  const name = Cookies.get('avaruuspeli-name')\n  if (name) {\n    document.getElementById('nick').value = name.substring(0, 20).trim()\n  }\n  const perk = Cookies.get('avaruuspeli-perk')\n  if (perk) {\n    document.getElementById('perkselect').value = ''\n    for (let i = 0; i < document.getElementById('perkselect').options.length; ++i) {\n      const option = document.getElementById('perkselect').options[i]\n      if (option.value == perk) {\n        option.selected = true\n        break\n      }\n    }\n  }\n  const cookieZoom = Cookies.get('avaruuspeli-zoom') | 0\n  if (isFinite(cookieZoom)) {\n    setZoom(ZOOM_LEVELS[cookieZoom % ZOOM_LEVELS.length])\n  }\n}\n\nconst frame = time => {\n  let delta = 0\n  if (lastPartialTick != null) {\n    delta = time - lastPartialTick\n    partialTick(delta)\n    ui.updateOpacity(delta)\n  }\n  lastPartialTick = time\n  draw.frame(time, delta)\n  window.requestAnimationFrame(frame)\n}\n\nwindow.requestAnimationFrame(frame)\n\nui = require('./ui')({ joinGame, tryLockMouse, nextZoom })\nleaveGame()\nupdateZoomText()\nui.hideLose()\ntryReadCookies()\n"],"names":["isMobile","test","navigator","userAgent","module","exports","chron","require","canvas","self","state","cursor","callbacks","firing","accel","brake","turnLeft","turnRight","isAccelerating","isBraking","isFiring","isTurningLeft","isTurningRight","accelerate","flag","resendControls","reset","unpress","handleMouseDown","e","mouseLocked","document","hidden","dead","tryLockMouse","handleMouseMove","handleMouseUp","leftButton","buttons","rightButton","useItem","addPosition","movementX","movementY","mcx","body","clientWidth","mcy","clientHeight","radius","Math","hypot","getX","getY","latched","orient","atan2","addEventListener","pointerLockElement","pointerType","getElementById","pressure","window","PointerEvent","token","code","timeMs","nextZoom","shiftKey","cursorX","cursorY","setPosition","x","y","LCG","geom","physics","fogCanvas","createElement","fogCtx","getContext","SQRT_H","sqrt","GRID_SIZE","PLANET_SPIN_SPEED","MINE_X","MINE_Y","objects","ctx","damageGot","lcg","lines","smokes","bubbles","planetAngle","damageAlpha","lastSmoke","zoom","rubber","cx","cy","unitSize","gotDamage","damage","performance","now","setZoom","z","setRubber","r","checkSize","width","innerWidth","devicePixelRatio","height","innerHeight","min","VIEW_DISTANCE","drawFog","addBubble","bubble","push","clearRect","bgradient","createRadialGradient","addColorStop","beginPath","arc","PI","rect","fillStyle","fill","drawShip","ship","p1","p2","p3","p4","getShipPoints","x1","y1","x2","y2","x3","y3","x4","y4","x0","y0","posX","posY","strokeStyle","moveTo","lineTo","closePath","stroke","tp1","tp2","tp3","tp4","tp5","getThrusterPoints","x5","y5","xo","random","yo","font","textAlign","fillText","name","drawBullet","bullet","lineWidth","type","velX","velY","i","drawLine","line","angle","alpha","cos","sin","drawPowerup","powerup","color","sx","sy","drawSmoke","smoke","drawBubble","max","computePlanetAngle","drawPlanet","planet","reseed","seed","gon","abs","randomInt","randomOffset","randomSign","fac","createLine","xv","yv","tpf","vx","vy","vangle","explosion","x6","y6","frame","time","delta","xm","ym","fillRect","dx","dy","gradient","RUBBERBAND_BUFFER","health","interval","Object","prototype","hasOwnProperty","call","_id","ships","bullets","planets","powerups","length","ctr","alp","powerupColor","filter","shipid","keys","drawImage","jouter","jbase","jstick","controls","applyPosition","hjbw","offsetWidth","hjbh","offsetHeight","offsetLeft","offsetTop","h","willAccel","shouldUpdateAccelStart","resetJoystickCenter","style","top","left","clientX","clientY","stopPropagation","stopImmediatePropagation","serverTick","fireWaitTicks","recoil","inertia","rubberband","getPlanets","gravityShip","gravityBullet","common","dialogOpacity","DEBUG","animation","visibility","updateZoomText","textContent","showDialog","opacity","display","position","overflow","hideDialog","hideLose","disconnect","updateOpacity","makeTd","text","td","makeTableRow","lb","tr","appendChild","updateLeaderboard","leaderboard","leaderBoardTable","newBody","replaceChild","childNodes","formatTime","sec","floor","slice","updateControls","updatePowerup","resText","item","rubbership","overdrive","regen","trim","updateOnlineStatus","updateDebugInfo","updateColors","background","t","updateScore","scoreNow","scoreWas","updatePlayerCount","players","updateHealthBar","ceil","addDeathLog","deathLog","childElementCount","removeChild","firstChild","p","setTimeout","parentNode","defeatedByPlayer","innerHTML","defeatedByCrash","defeatedByPlanet","showPowerupAnimation","joiningGame","blur","joinGame","fullscreenElement","exitFullscreen","documentElement","requestFullscreen","global","factory","define","amd","current","Cookies","noConflict","assign","target","arguments","source","key","defaultConverter","read","value","replace","decodeURIComponent","write","encodeURIComponent","init","converter","defaultAttributes","set","attributes","expires","Date","toUTCString","escape","stringifiedAttributes","attributeName","split","cookie","get","cookies","jar","parts","join","foundKey","create","remove","withAttributes","withConverter","freeze","api","path","Counter","bulletCounter","BULLET_DAMAGE_MULTIPLIER","newBullet","dist","velocity","shooter","shooterName","isHit","canPickUp","next","bulletFields","bulletSystemFactory","handler","getBullets","values","getBulletsById","ids","map","id","removeBullet","onBulletDeleted","handleShipBulletCollision","getShipById","absorber","healthMul","damageShip","killShipByBullet","handlePowerupBulletCollision","applyPowerup","removeMinesBy","shipId","projList","projCount","moveBullets","shipList","getShips","powerupList","getPowerups","bulletList","shipCount","powerupCount","bulletCount","MAX_BULLET_DISTANCE","newX","newY","collisionShip","j","closestSynchroDistance","posXnew","posYnew","lerp1D","getCollisionPoints","lineIntersectsTriangle","collisionPowerup","pickupRadius","a1","a2","lineIntersectsLine","hitPlanet","primerShip","forEach","onMineExplode","MINE_LIFETIME","TICKS_PER_SECOND","addProjectile","extras","extraDist","orientOffset","speedFactor","damageFactor","rangeSub","typeSpeedMul","BULLET_VELOCITY","bulletSpeedMul","system","fields","GRAV","MS_PER_TICK","MAX_SHIP_VELOCITY","ACTUAL_MAX_SHIP_VELOCITY","MIN_SHIP_VELOCITY","LATCH_VELOCITY","BRAKE_MUL","RUBBERBAND_RADIUS_MUL","INERTIA_MUL","PLANET_CHUNK_SIZE","PLANET_SEED","getAccelMul","accelTimeMs","checkMinVelocity","v","checkMaxVelocity","maxvel","healthToVelocity","speedMul","getPlanetSeed","setPlanetSeed","newPlanetSeed","getPlanetsForChunk","xb","yb","xu","yu","hasOverdrive","hasRubbership","hasRegen","accelMul","thrustBoost","highAgility","d","r2","f","thrust","vector","dv","direction","normalize","getRubberbandRadius","playerCount","pow","distCenter","maxRadius","baseX","baseY","nv","powerupCounter","newPowerup","despawn","pickupDist","pickupPlayer","powerupFields","powerupSystemFactory","nextPowerup","clear","trySpawnPowerup","tries","count","theta","playerDist","apply","inPlanet","tooClose","onPowerupSpawned","setNextPowerupTime","division","getShipCount","maybeSpawnPowerup","ITEM_COUNT","removePowerup","updateClosestPlayer","onPowerupDeleted","updatePowerups","maths","shipCounter","SHIP_RECT_RADIUS","SHIP_RADIUS","newShip","score","firingInterval","planetDamageMul","healRate","lastDamageAt","lastDamageBy","shipFields","shipSystemFactory","removeShipById","newPlayerShip","spawn","latchToPlanet","latchToPlanetWithAngle","computePlanetPoint","onShipLatch","spawnLone","playerKeys","randShip","bulletDist","ideal","find","testPlanet","a","b","mostIdeal","reduce","angleOffset","minimalScore","testAngle","doFire","shipAcceleration","radiusGoal","doAccel","doBrake","premoveShips","ship1","moveShips","pup","lineIntersectCircleFirstDepth","ship2","testShipShipCollision","search","searchSquare","lineClosestPointToPoint","squarePair","handleShipPlanetCollision","handleShipShipCollision","dmg1","dmg2","onShipKilledByCrash","killShip","q1","q2","q4","testTriangleCollision","col_mul","getPlanetDamageMultiplier","col_vmul","getPlanetDamageSpeedMultiplier","offx","offy","by","onShipKilledByPlanet","deleteShip","onDeath","onShipKilled","getTime","constructor","counter","BigInt","val","toString","padStart","asUintN","SHIP_SCALE","lerp2D","m","pointInTriangle","xp","yp","c1","c2","c3","testTriangleCollisionSub","a3","b1","b2","b3","dax","day","dbx","dby","dcx","dcy","b32x","b23y","D","sa","sb","sc","ta","tb","tc","getDirectionSign","s","sign","collinearLinesIntersect","c","isFinite","n","l1","l2","t1","t2","t3","Number","NaN","v1","v2","u1","u2","vu","vv","A","B","C","wrapRadianAngle","ox","oy","px","py","padFromBelow","withinBoundingSquare","center","rotatePoint","rotatePointOffset","S","LCG_A","LCG_C","SC","Generator","msgpackr","serializeFrom","object","field","deserializeFrom","array","serializeBullet","obj","deserializeBullet","arr","serializePowerup","deserializePowerup","serializeShip","deserializeShip","C_ping","C_join","C_ctrl","C_quit","C_useitem","C_pong","C_token","C_data","C_board","C_killship","C_killproj","C_orient","C_unauth","C_addpup","C_delpup","C_minexpl","C_deathk","C_deathc","C_deathp","C_addpups","C_crashed","C_killed","C_hitpl","encode","cmd","data","pack","messageKeys","decode","unpack","fromEntries","index","recv","send","ws","e_token","e_data","you","projs","e_unauth","e_board","board","e_killship","e_killproj","proj","e_crashed","e_killed","e_orient","e_hitpl","e_join","nick","perk","e_ping","e_pong","e_quit","e_ctrl","e_addpup","e_delpup","e_useitem","e_minexpl","e_deathk","e_deathc","e_deathp","e_addpups","Packr","Encoder","addExtension","NEVER","ALWAYS","DECIMAL_ROUND","DECIMAL_FIT","REUSE_BUFFER_MODE","Unpackr","Decoder","C1","unpackMultiple","FLOAT32_OPTIONS","clearSource","roundFloat32","isNativeAccelerationEnabled","decodeIter","encodeIter","useRecords","mapsAsObjects","packIter","objectIterator","options","Error","Symbol","iterator","packIterSync","then","asyncIterator","packIterAsync","packr","unpackIter","bufferIterator","unpackr","incomplete","parser","chunk","yields","Buffer","concat","undefined","err","lastPosition","iter","mult10","C1Type","typedArrays","unpackAddExtension","textEncoder","TextEncoder","error","extensions","extensionClasses","hasNodeBuffer","ByteArrayAllocate","allocUnsafeSlow","Uint8Array","ByteArray","MAX_BUFFER_SIZE","keysTarget","targetView","safeEnd","bundledStrings","MAX_BUNDLE_SIZE","hasNonLatin","RECORD_SYMBOL","offset","typeBuffer","start","hasSharedUpdate","structures","referenceMap","lastSharedStructuresLength","encodeUtf8","utf8Write","string","maxBytes","encodeInto","subarray","written","isSequential","sequential","hasSharedStructures","saveStructures","maxSharedStructures","structuredClone","moreTypes","maxOwnStructures","useTwoByteRecords","sharedLimitId","maxStructureId","recordIdsToRemove","transitionsCount","serializationsSinceTransitionRebuild","encodeOptions","DataView","buffer","Map","bundleStrings","size","Infinity","uninitialized","_mergeStructures","getStructures","sharedLength","transitions","nextTransition","transition","l","nextId","writeBundles","idsToInsert","makeRoom","serialized","insertIds","end","returnBuffer","RESET_BUFFER_MODE","strLength","extStart","setUint16","twoByte","headerSize","strPosition","charCodeAt","copyWithin","setUint32","setInt16","setInt32","useFloat32","setFloat32","xShifted","setFloat64","referee","writeObject","Array","entryValue","extensionClass","extension","currentTarget","currentTargetView","currentPosition","result","writeExtensionData","setBigInt64","setBigUint64","largeBigIntToFloat","RangeError","encodeUndefinedAsNil","writeFunction","variableMapSize","safePrototype","objectOffset","progressiveRecords","wroteKeys","lastTransition","newTransitions","newRecord","insertNewRecord","recordId","__keys__","newSize","round","newBuffer","copy","shouldShareStructure","nextOwnId","highByte","isShared","shift","insertionOffset","mainTarget","mainPosition","mainSafeEnd","mainStart","keysPosition","newEnd","insertionPosition","useBuffer","byteOffset","byteLength","clearSharedData","copyBinary","targetOffset","endOffset","Set","RegExp","ArrayBuffer","getPrototypeOf","date","allocateForWrite","seconds","useTimestamp32","getMilliseconds","isNaN","onInvalidDate","from","message","regex","flags","arrayBuffer","writeExtBuffer","writeBuffer","typedArray","indexOf","distanceToMove","lastEnd","sort","pop","writeStrings","startPosition","Class","unshift","defaultPackr","decoder","TextDecoder","src","srcEnd","alreadySet","EMPTY_ARRAY","strings","stringPosition","currentUnpackr","currentStructures","srcString","srcStringStart","srcStringEnd","currentExtensions","dataView","defaultOptions","sequentialMode","inlineObjectReadThreshold","Function","saveState","checkedRead","defaultUnpackr","loadedStructures","existingStructures","structure","existing","restoreStructures","getPosition","trusted","postBundlePosition","startsWith","loadStructures","createStructureReader","readKey","shortStringInJS","longStringInJS","readFixedString","position1","position0","readBin","getUint16","getUint32","readExt","getFloat32","multiplier","getFloat64","int64AsNumber","getBigUint64","getInt8","getInt16","getInt32","getBigInt64","recordDefinition","noBuffer","readString8","readString16","readString32","readArray","readMap","validName","firstId","readObject","JSON","stringify","createSecondByteReader","read0","readStringJS","setExtractor","extractStrings","readString","headerLength","extraction","srcStringLength","units","byte1","byte2","byte3","byte4","unit","fromCharCode","String","bytes","byte","g","k","o","readOnlyJSString","copyBuffers","keyCache","entry","checkPosition","firstByte","existingStructure","glbl","refEntry","targetProperties","used","typeCode","typedArrayName","TEMP_BUNDLE","dataSize","dataPosition","callback","savedSrcEnd","savedPosition","savedStringPosition","savedSrcStringStart","savedSrcStringEnd","savedSrcString","savedStrings","savedReferenceMap","savedBundledStrings","savedSrc","savedStructures","savedStructuresContents","savedPackr","savedSequentialMode","splice","f32Array","Float32Array","u8Array","float32Number","serial","here","location","tps","TURN_UNIT","BASE_SELF","ZOOM_LEVELS","inGame","connectTimer","ticksPerFrame","no_data","pinger","lastPartialTick","resendCtrl","draw","joystick","tick","ui","indx","sameSite","onConnect","clearTimeout","setInterval","leaveGame","gotData","oldHealth","toFixed","wsproto","protocol","port","WebSocket","hostname","pathname","binaryType","mine","clearInterval","close","exitPointerLock","turnLeftRamp","turnRightRamp","partialTick","requestPointerLock","tryReadCookies","substring","option","selected","cookieZoom","requestAnimationFrame"],"sourceRoot":""}