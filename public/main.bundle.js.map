{"version":3,"file":"main.bundle.js","mappings":"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","sources":["webpack://avaruussota/./js/common.js","webpack://avaruussota/./js/controls.js","webpack://avaruussota/./js/cursor.js","webpack://avaruussota/./js/draw.js","webpack://avaruussota/./js/joystick.js","webpack://avaruussota/./js/tick.js","webpack://avaruussota/./js/ui.js","webpack://avaruussota/./node_modules/js-cookie/dist/js.cookie.js","webpack://avaruussota/./src/game/bullet.js","webpack://avaruussota/./src/game/physics.js","webpack://avaruussota/./src/game/powerup.js","webpack://avaruussota/./src/game/ship.js","webpack://avaruussota/./src/utils/chron.js","webpack://avaruussota/./src/utils/counter.js","webpack://avaruussota/./src/utils/filter.js","webpack://avaruussota/./src/utils/geom.js","webpack://avaruussota/./src/utils/lcg.js","webpack://avaruussota/./src/utils/maths.js","webpack://avaruussota/./src/utils/serial.js","webpack://avaruussota/./node_modules/msgpackr/index.js","webpack://avaruussota/./node_modules/msgpackr/iterators.js","webpack://avaruussota/./node_modules/msgpackr/pack.js","webpack://avaruussota/./node_modules/msgpackr/unpack.js","webpack://avaruussota/webpack/bootstrap","webpack://avaruussota/webpack/runtime/define property getters","webpack://avaruussota/webpack/runtime/hasOwnProperty shorthand","webpack://avaruussota/webpack/runtime/make namespace object","webpack://avaruussota/./js/main.js"],"sourcesContent":["\nconst isMobile = () => {\n  return /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)\n}\n\nmodule.exports = {\n  isMobile\n}\n","const chron = require('../src/utils/chron')\n\nmodule.exports = (canvas, self, state, cursor, callbacks) => {\n  let firing = false\n  let accel = false\n  let brake = false\n  let turnLeft = false\n  let turnRight = false\n\n  const isAccelerating = () => accel\n  const isBraking = () => brake\n  const isFiring = () => firing\n  const isTurningLeft = () => turnLeft\n  const isTurningRight = () => turnRight\n\n  const accelerate = flag => {\n    if (accel !== flag) {\n      accel = flag\n      if (!flag)\n        self.accel = null\n      resendControls()\n    }\n  }\n\n  const reset = () => {\n    accel = false\n    brake = false\n    turnLeft = false\n    turnRight = false\n    firing = false\n  }\n\n  const resendControls = () => callbacks.resendControls()\n\n  const unpress = () => {\n    reset()\n    self.accel = null\n    resendControls()\n  }\n\n  const handleMouseDown = (e) =>{\n    if (!state.mouseLocked && !document.hidden && !state.dead) {\n      callbacks.tryLockMouse(e)\n    }\n    handleMouseMove(e)\n  }\n  \n  const handleMouseUp = (e) => {\n    handleMouseMove(e)\n  }\n  \n  const handleMouseMove = (e) => {\n    const leftButton = (e.buttons & 1) !== 0\n    const rightButton = (e.buttons & 2) !== 0\n  \n    if (leftButton && !firing) {\n      firing = true\n      resendControls()\n    } else if (!leftButton && firing) {\n      firing = false\n      resendControls()\n    }\n  \n    if (rightButton) {\n      callbacks.useItem()\n    }\n  \n    if (state.mouseLocked) {\n      cursor.addPosition(e.movementX, e.movementY)\n      const mcx = document.body.clientWidth / 2\n      const mcy = document.body.clientHeight / 2\n      const radius = Math.hypot(cursor.getX() - mcx, mcy - cursor.getY())\n      if (!self.latched && radius > 2) {\n        self.orient = Math.atan2(cursor.getX() - mcx, mcy - cursor.getY())\n        resendControls()\n      }\n    }\n  }\n  \n  document.addEventListener('pointerlockchange', () => {\n    state.mouseLocked = document.pointerLockElement === canvas\n  })\n  \n  canvas.addEventListener('pointerdown', (e) => {\n    if (e.pointerType == 'mouse') {\n      handleMouseDown(e)\n    }\n  })\n  \n  canvas.addEventListener('pointerup', (e) => {\n    if (e.pointerType == 'mouse') {\n      handleMouseUp(e)\n    }\n  })\n  \n  canvas.addEventListener('pointermove', (e) => {\n    if (e.pointerType == 'mouse') {\n      handleMouseMove(e)\n    }\n  })\n  \n  document.getElementById('btnfire').addEventListener('pointerdown', () => {\n    firing = true\n    resendControls()\n  })\n  document.getElementById('btnfire').addEventListener('pointerover', (e) => {\n    if (e.pressure > 0) {\n      firing = true\n      resendControls()\n    }\n  })\n  \n  document.getElementById('btnfire').addEventListener('pointerout', () => {\n    firing = false\n    resendControls()\n  })\n  document.getElementById('btnfire').addEventListener('pointerup', () => {\n    firing = false\n    resendControls()\n  })\n  \n  document.getElementById('btnbrake').addEventListener('pointerdown', () => {\n    brake = true\n    resendControls()\n  })\n  document.getElementById('btnbrake').addEventListener('pointerover', (e) => {\n    if (e.pressure > 0) {\n      brake = true\n      resendControls()\n    }\n  })\n  \n  document.getElementById('btnbrake').addEventListener('pointerout', () => {\n    brake = false\n    resendControls()\n  })\n  document.getElementById('btnbrake').addEventListener('pointerup', () => {\n    brake = false\n    resendControls()\n  })\n  \n  document.getElementById('btnconsume').addEventListener('pointerdown', () => {\n    callbacks.useItem()\n  })\n  document.getElementById('btnconsume').addEventListener('pointerover', (e) => {\n    if (e.pressure > 0) {\n      callbacks.useItem()\n    }\n  })\n  \n  if (!window.PointerEvent) {\n    canvas.addEventListener('mousedown', (e) => {\n      handleMouseDown(e)\n    })\n    \n    canvas.addEventListener('mouseup', (e) => {\n      handleMouseUp(e)\n    })\n    \n    canvas.addEventListener('mousemove', (e) => {\n      handleMouseMove(e)\n    })\n  }\n  \n  window.addEventListener('keydown', (e) => {\n    if (!state.token || state.dead) {\n      return\n    }\n  \n    if (e.code == 'KeyW') {\n      accel = true\n      self.accel = chron.timeMs()\n      resendControls()\n    } else if (e.code == 'KeyS') {\n      brake = true\n      resendControls()\n    } else if (e.code == 'KeyA') {\n      turnLeft = true\n    } else if (e.code == 'KeyD') {\n      turnRight = true\n    } else if (e.code == 'KeyQ') {\n      callbacks.useItem()\n    } else if (e.code == 'Space') {\n      firing = true\n      resendControls()\n    }\n  }, true)\n  \n  window.addEventListener('keyup', (e) => {\n    if (!state.token || state.dead) {\n      return\n    }\n  \n    if (e.code == 'KeyW') {\n      accel = false\n      self.accel = null\n      resendControls()\n    } else if (e.code == 'KeyS') {\n      brake = false\n      resendControls()\n    } else if (e.code == 'KeyA') {\n      turnLeft = false\n    } else if (e.code == 'KeyD') {\n      turnRight = false\n    } else if (e.code == 'KeyZ') {\n      callbacks.nextZoom(e.shiftKey ? -1 : 1)\n    } else if (e.code == 'Space') {\n      firing = false\n      resendControls()\n    }\n  }, true)\n  \n  return {\n    accelerate,\n    resendControls,\n    isAccelerating,\n    isBraking,\n    isFiring,\n    isTurningLeft,\n    isTurningRight,\n    reset,\n    unpress\n  }\n}\n","let cursorX = -10\nlet cursorY = -10\n\nconst setPosition = (x, y) => (cursorX = x, cursorY = y)\nconst addPosition = (x, y) => (cursorX += x, cursorY += y)\nconst getX = () => cursorX\nconst getY = () => cursorY\n\nmodule.exports = {\n  setPosition,\n  addPosition,\n  getX,\n  getY\n}\n","const LCG = require('../src/utils/lcg')\nconst geom = require('../src/utils/geom')\nconst physics = require('../src/game/physics')\n\nconst fogCanvas = document.createElement('canvas')\nconst fogCtx = fogCanvas.getContext('2d')\nconst SQRT_H = Math.sqrt(0.5)\nconst GRID_SIZE = 10\nconst PLANET_SPIN_SPEED = 0.02\nconst MINE_X = [0, SQRT_H, 1, SQRT_H, 0, -SQRT_H, -1, -SQRT_H]\nconst MINE_Y = [1, SQRT_H, 0, -SQRT_H, -1, -SQRT_H, 0, SQRT_H]\n\nmodule.exports = (canvas, self, objects, state, cursor) => {\n  const ctx = canvas.getContext('2d')\n\n  let damageGot = 0\n  let lcg = new LCG(0)\n  let lines = []\n  let smokes = []\n  let bubbles = []\n  let planetAngle = 0\n  let damageAlpha = 0\n  let lastSmoke = {}\n  let zoom = 1\n  let rubber = 150\n  let cx = 0\n  let cy = 0\n  let unitSize = 1\n\n  const reset = () => {\n    lines = []\n    smokes = []\n    damageGot = 0\n    damageAlpha = 0\n  }\n\n  const gotDamage = (damage) => {\n    damageGot = performance.now() + damage * 700\n    damageAlpha = 0.8 * damage\n  }\n\n  const setZoom = z => zoom = z\n\n  const setRubber = r => rubber = r\n\n  const checkSize = () => {\n    ctx.canvas.width = window.innerWidth * window.devicePixelRatio\n    ctx.canvas.height = window.innerHeight * window.devicePixelRatio\n    cx = ctx.canvas.width / 2\n    cy = ctx.canvas.height / 2\n    unitSize = Math.min(ctx.canvas.width, ctx.canvas.height) \n      / physics.VIEW_DISTANCE * (zoom / 2)\n    \n    drawFog()\n  }\n\n  const addBubble = bubble => bubbles.push(bubble)\n\n  const drawFog = () => {\n    fogCanvas.width = ctx.canvas.width\n    fogCanvas.height = ctx.canvas.height\n\n    fogCtx.clearRect(0, 0, fogCanvas.width, fogCanvas.height)\n    const bgradient = fogCtx.createRadialGradient(cx, cy,\n      (physics.VIEW_DISTANCE - 1) * unitSize,\n      cx, cy,\n      (physics.VIEW_DISTANCE + 10) * unitSize)\n\n    bgradient.addColorStop(0, 'rgba(0,0,0,0)')\n    bgradient.addColorStop(0.5, 'rgba(0,0,0,0.2)')\n    bgradient.addColorStop(1, 'rgba(0,0,0,0.9)')\n    fogCtx.beginPath()\n    fogCtx.arc(cx, cy, \n      (physics.VIEW_DISTANCE - 1) * unitSize, 0, 2 * Math.PI)\n    fogCtx.rect(fogCtx.canvas.width, 0, -fogCtx.canvas.width, fogCtx.canvas.height)\n    fogCtx.fillStyle = bgradient\n    fogCtx.fill()\n  }\n\n  const drawShip = (ship) => {\n    const [p1, p2, p3, p4] = geom.getShipPoints(ship)\n    let [x1, y1] = p1\n    let [x2, y2] = p2\n    let [x3, y3] = p3\n    let [x4, y4] = p4\n    let [x0, y0] = [0, 0]\n\n    x0 = cx + (self.posX - ship.posX) * unitSize\n    x1 = cx + (self.posX - x1) * unitSize\n    x2 = cx + (self.posX - x2) * unitSize\n    x3 = cx + (self.posX - x3) * unitSize\n    x4 = cx + (self.posX - x4) * unitSize\n\n    y0 = cy + (self.posY - ship.posY) * unitSize\n    y1 = cy + (self.posY - y1) * unitSize\n    y2 = cy + (self.posY - y2) * unitSize\n    y3 = cy + (self.posY - y3) * unitSize\n    y4 = cy + (self.posY - y4) * unitSize\n\n    ctx.strokeStyle = '#fff'\n    ctx.beginPath()\n    ctx.moveTo(x1, y1)\n    ctx.lineTo(x2, y2)\n    ctx.lineTo(x3, y3)\n    ctx.lineTo(x4, y4)\n    ctx.closePath()\n    ctx.stroke()\n\n    if (ship.accel !== null) {\n      const [tp1, tp2, tp3, tp4, tp5] = geom.getThrusterPoints(ship)\n      let [x1, y1] = tp1\n      let [x2, y2] = tp2\n      let [x3, y3] = tp3\n      let [x4, y4] = tp4\n      let [x5, y5] = tp5\n\n      let xo = (Math.random() - 0.5) * unitSize / 2\n      let yo = (Math.random() - 0.5) * unitSize / 2\n\n      x1 = cx + (self.posX - x1) * unitSize\n      x2 = cx + (self.posX - x2) * unitSize\n      x3 = cx + (self.posX - x3) * unitSize\n      x4 = cx + (self.posX - x4) * unitSize\n      x5 = cx + (self.posX - x5) * unitSize\n    \n      y1 = cy + (self.posY - y1) * unitSize\n      y2 = cy + (self.posY - y2) * unitSize\n      y3 = cy + (self.posY - y3) * unitSize\n      y4 = cy + (self.posY - y4) * unitSize\n      y5 = cy + (self.posY - y5) * unitSize\n\n      x3 += xo\n      y3 += yo\n      x5 += xo / 2\n      y5 += yo / 2  \n\n      ctx.strokeStyle = '#888'\n      ctx.beginPath()\n      ctx.moveTo(x1, y1)\n      ctx.lineTo(x2, y2)\n      ctx.lineTo(x3, y3)\n      ctx.lineTo(x4, y4)\n      ctx.lineTo(x1, y1)\n      ctx.lineTo(x5, y5)\n      ctx.closePath()\n      ctx.stroke()\n    }\n\n    ctx.font = `${18 * window.devicePixelRatio}px monospace`\n    ctx.fillStyle = 'rgba(255,255,255,0.75)'\n    ctx.textAlign = 'center'\n    ctx.fillText(ship.name, x0, y0 - 3.75 * unitSize)\n  }\n\n  const drawBullet = (bullet) => {\n    const x = cx + (self.posX - bullet.posX) * unitSize\n    const y = cy + (self.posY - bullet.posY) * unitSize\n\n    ctx.lineWidth = 1 * window.devicePixelRatio\n    if (bullet.type === 'bullet') {\n      ctx.moveTo(x, y)\n      ctx.arc(x, y, 0.3 * unitSize, 0, 2 * Math.PI)\n    } else if (bullet.type === 'knockout') {\n      const radius = 0.7 * unitSize\n      ctx.beginPath()\n      ctx.moveTo(x + radius, y)\n      for (let i = 0; i < 7; ++i) {\n        const angle = i * Math.PI * 6 / 7\n        ctx.lineTo(x + radius * Math.sin(angle), y + radius * Math.cos(angle))\n      }\n      ctx.lineTo(x + radius, y)\n      ctx.closePath()\n      ctx.stroke()\n    } else if (bullet.type === 'laser') {\n      const x1 = cx + (self.posX - (bullet.posX + bullet.velX * 0.1)) * unitSize\n      const y1 = cy + (self.posY - (bullet.posY + bullet.velY * 0.1)) * unitSize\n      ctx.moveTo(x, y)\n      ctx.lineTo(x1, y1)\n    } else if (bullet.type === 'mine') {\n      ctx.moveTo(x + 1.6 * unitSize, y)\n      ctx.arc(x, y, 1.6 * unitSize, 0, 2 * Math.PI)\n      for (let i = 0; i < 8; ++i) {\n        const xo = unitSize * 0.8 * MINE_X[i]\n        const yo = unitSize * 0.8 * MINE_Y[i]\n        ctx.moveTo(x + 2 * xo, y + 2 * yo)\n        ctx.lineTo(x + 3 * xo, y + 3 * yo)\n      }\n      ctx.moveTo(x, y)\n    }\n  }\n\n  const drawLine = (line) => {\n    const { x, y, angle, r, alpha } = line\n    const x1 = cx + unitSize * (self.posX - x - r * Math.cos(angle))\n    const y1 = cy + unitSize * (self.posY - y - r * Math.sin(angle))\n    const x2 = cx + unitSize * (self.posX - x + r * Math.cos(angle))\n    const y2 = cy + unitSize * (self.posY - y + r * Math.sin(angle))\n\n    ctx.strokeStyle = `rgba(192,192,192,${alpha * 0.01})` \n    ctx.beginPath()\n    ctx.moveTo(x1, y1)\n    ctx.lineTo(x2, y2)\n    ctx.stroke()\n  }\n\n  const drawPowerup = (powerup, color) => {\n    const { posX, posY } = powerup\n\n    const sx = cx + (self.posX - posX) * unitSize\n    const sy = cy + (self.posY - posY) * unitSize\n\n    if (sx < -20 || sy < -20 \n      || sx > ctx.canvas.width + 20 || sy > ctx.canvas.height + 20) {\n      return\n    }\n\n    ctx.fillStyle = color\n    ctx.beginPath()\n    ctx.arc(sx, sy, unitSize, 0, 2 * Math.PI)\n    ctx.fill()\n  }\n\n  const drawSmoke = (smoke) => {\n    const { x, y, radius, alpha } = smoke\n    const sx = cx + (self.posX - x) * unitSize\n    const sy = cy + (self.posY - y) * unitSize\n\n    ctx.fillStyle = `rgba(92,92,92,${alpha * 0.01})` \n    ctx.beginPath()\n    ctx.arc(sx, sy, radius * unitSize, 0, 2 * Math.PI)\n    ctx.fill()\n  }\n\n  const drawBubble = (bubble) => {\n    const { x, y, radius, alpha } = bubble\n    const sx = cx + (self.posX - x) * unitSize\n    const sy = cy + (self.posY - y) * unitSize\n\n    ctx.lineWidth = window.devicePixelRatio * (1 + Math.max(0, alpha - 1))\n    ctx.strokeStyle = `rgba(128,128,128,${Math.min(1, alpha) * 0.01})` \n    ctx.beginPath()\n    ctx.arc(sx, sy, radius * unitSize, 0, 2 * Math.PI)\n    ctx.stroke()\n  }\n\n  const computePlanetAngle = (radius, sx, sy, angle) => {\n    return [sx + Math.sin(angle) * radius * unitSize,\n      sy + Math.cos(angle) * radius * unitSize]\n  }\n\n  const drawPlanet = (planet) => {\n    ctx.strokeStyle = '#fff'\n    ctx.lineWidth = 1 * window.devicePixelRatio\n    \n    const sx = cx + (self.posX - planet.x) * unitSize\n    const sy = cy + (self.posY - planet.y) * unitSize\n\n    if (sx < -planet.radius * unitSize \n      || sy < -planet.radius  * unitSize\n      || sx > ctx.canvas.width + planet.radius * unitSize \n      || sy > ctx.canvas.height + planet.radius * unitSize) {\n      return\n    }\n\n    lcg.reseed(planet.seed)\n    const gon = Math.abs(lcg.randomInt()) % 19 + 12\n\n    let angle = lcg.randomOffset() * Math.PI * 2 + planetAngle * lcg.randomSign()\n    let [x, y] = computePlanetAngle(planet.radius, sx, sy, angle)\n    let fac = 2 * Math.PI / gon\n\n    ctx.moveTo(x, y)\n    for (let i = 0; i <= gon; ++i) {\n      [x, y] = computePlanetAngle(planet.radius, sx, sy, angle + i * fac)\n      ctx.lineTo(x, y)\n    }\n  }\n\n  const createLine = (x1, y1, x2, y2, xv, yv, tpf) => {\n    const [x, y] = [(x1 + x2) / 2, (y1 + y2) / 2]\n    const angle = Math.atan2(x2 - x1, y2 - y1)\n    const r = Math.hypot(x2 - x1, y2 - y1) / 2\n    const vx = -0.05 + 0.1 * Math.random() + xv * tpf\n    const vy = -0.05 + 0.1 * Math.random() + yv * tpf\n    const vangle = -0.1 + 0.2 * Math.random()\n\n    return { x, y, angle, alpha: 100, r, vx, vy, vangle }\n  }\n\n  const explosion = (ship, tpf) => {\n    if (!ship) {\n      return\n    }\n\n    const [p1, p2, p3, p4] = geom.getShipPoints(ship)\n    let [x1, y1] = p1\n    let [x2, y2] = p2\n    let [x3, y3] = p3\n    let [x4, y4] = p4\n\n    let [x5, y5] = [(x1 + x2) / 2, (y1 + y2) / 2]\n    let [x6, y6] = [(x1 + x4) / 2, (y1 + y4) / 2]\n\n    lines.push(createLine(x1, y1, x5, y5, ship.velX, ship.velY, tpf))\n    lines.push(createLine(x5, y5, x2, y2, ship.velX, ship.velY, tpf))\n    lines.push(createLine(x2, y2, x3, y3, ship.velX, ship.velY, tpf))\n    lines.push(createLine(x3, y3, x4, y4, ship.velX, ship.velY, tpf))\n    lines.push(createLine(x4, y4, x6, y6, ship.velX, ship.velY, tpf))\n    lines.push(createLine(x6, y6, x1, y1, ship.velX, ship.velY, tpf))\n  }\n\n  const frame = (time, delta) => {\n    const xm = ((self.posX % GRID_SIZE) + GRID_SIZE) % GRID_SIZE\n    const ym = ((self.posY % GRID_SIZE) + GRID_SIZE) % GRID_SIZE\n\n    ctx.fillStyle = '#000'\n    ctx.fillRect(0, 0, ctx.canvas.width, ctx.canvas.height)\n\n    // draw grid\n    ctx.lineWidth = 1 * window.devicePixelRatio\n    ctx.strokeStyle = '#333'\n    ctx.beginPath()\n    for (let x = xm * unitSize; \n      x < ctx.canvas.width; \n      x += GRID_SIZE * unitSize) {\n      const dx = x | 0 + 0.5\n      ctx.moveTo(dx, 0)\n      ctx.lineTo(dx, ctx.canvas.height)\n    }\n    for (let y = ym * unitSize; \n      y < ctx.canvas.height;\n      y += GRID_SIZE * unitSize) {\n      const dy = y | 0 + 0.5\n      ctx.moveTo(0, dy)\n      ctx.lineTo(ctx.canvas.width, dy)\n    }\n    ctx.stroke()\n    \n    if (state.ingame) {\n      // draw red mask\n      if (rubber > 1) {\n        const gradient = ctx.createRadialGradient(cx + self.posX * unitSize,\n          cy + self.posY * unitSize,\n          (rubber - 1) * unitSize,\n          cx + self.posX * unitSize,\n          cy + self.posY * unitSize,\n          (rubber + physics.RUBBERBAND_BUFFER - 1) * unitSize)\n        gradient.addColorStop(0, 'rgba(192,192,192,0)')\n        gradient.addColorStop(1, 'rgba(192,192,192,0.25)')\n        ctx.beginPath()\n        ctx.arc(cx + self.posX * unitSize, cy + self.posY * unitSize, \n          rubber * unitSize, 0, 2 * Math.PI)\n        ctx.rect(ctx.canvas.width, 0, -ctx.canvas.width, ctx.canvas.height)\n        ctx.fillStyle = gradient\n        ctx.fill()\n      }\n    }\n\n    if (!self.dead) {\n      // draw player ship\n      ctx.lineWidth = 1.5 * window.devicePixelRatio\n      drawShip(self)\n      if (self.health < 0.75) {\n        const interval = 320 ** (self.health * 0.35 + 0.9) / 2 / (1 + Math.hypot(self.velX, self.velY) / 4)\n        if (!Object.prototype.hasOwnProperty.call(lastSmoke, self._id) || time - lastSmoke[self._id] > interval) {\n          smokes.push({ \n            x: self.posX + 1.5 * Math.random() - 0.75, \n            y: self.posY + 1.5 * Math.random() - 0.75, \n            radius: 0.15 + (0.75 - self.health) + Math.random() * 0.3, \n            alpha: 100 * Math.min(1, 1.4 - self.health) })\n          lastSmoke[self._id] = time\n        }\n      }\n\n      // draw ships\n      ctx.lineWidth = 1 * window.devicePixelRatio\n      for (const ship of objects.ships) {\n        drawShip(ship)\n        if (ship.health < 0.75) {\n          const interval = 320 ** (ship.health * 0.35 + 0.9) / 2 / (1 + Math.hypot(ship.velX, ship.velY) / 4)\n          if (!Object.prototype.hasOwnProperty.call(lastSmoke, ship._id) || time - lastSmoke[ship._id] > interval) {\n            smokes.push({ \n              x: ship.posX + 1.5 * Math.random() - 0.75, \n              y: ship.posY + 1.5 * Math.random() - 0.75, \n              radius: 0.15 + (0.75 - ship.health) + Math.random() * 0.3, \n              alpha: 100 * Math.min(1, 1.4 - ship.health) })\n            lastSmoke[ship._id] = time\n          }\n        }\n      }\n\n      ctx.fillStyle = '#fff'\n      ctx.strokeStyle = '#fff'\n      ctx.beginPath()\n      // draw bullets\n      for (const bullet of objects.bullets) {\n        drawBullet(bullet)\n      }\n      ctx.stroke()\n    }\n\n    ctx.beginPath()\n    // draw planets\n    for (const planet of objects.planets) {\n      drawPlanet(planet)\n    }\n    ctx.stroke()\n\n    if (objects.powerups.length) {\n      const ctr = 0 | ((time % 300) / 15)\n      const alp = (time / 1000) % 1.0\n      const powerupColor = `rgba(${224+ctr},255,${192+ctr*2},${Math.max(alp, 1 - alp)})`\n      // draw powerups\n      for (const powerup of objects.powerups) {\n        drawPowerup(powerup, powerupColor)\n      }\n    }\n      \n    // draw lines\n    for (const line of lines) {\n      drawLine(line)\n\n      line.x += line.vx * delta\n      line.y += line.vy * delta\n      line.angle += line.vangle\n      line.vx *= 0.99\n      line.vy *= 0.99\n      line.vangle *= 0.99\n      line.alpha -= 1\n    }\n    lines = lines.filter(line => line.alpha > 0)\n\n    // draw smokes\n    for (const smoke of smokes) {\n      drawSmoke(smoke)\n\n      smoke.radius += 0.015\n      smoke.alpha -= 1\n    }\n    smokes = smokes.filter(smoke => smoke.alpha > 0)\n\n    for (const shipid of Object.keys(lastSmoke)) {\n      if (time - lastSmoke[shipid] >= 5000) {\n        delete lastSmoke[shipid]\n      }\n    }\n\n    // draw bubbles\n    for (const bubble of bubbles) {\n      drawBubble(bubble)\n\n      bubble.radius += 0.05\n      bubble.alpha -= 1\n    }\n    bubbles = bubbles.filter(bubble => bubble.alpha > 0)\n\n    if (state.ingame) {\n      ctx.drawImage(fogCanvas, 0, 0)\n    }\n\n    if (!self.dead) {\n      if (damageAlpha > 0) {\n        ctx.beginPath()\n        ctx.fillStyle = `rgba(128,0,0,${damageAlpha})`\n        ctx.rect(0, 0, ctx.canvas.width, ctx.canvas.height)\n        ctx.fill()\n        if (time > damageGot && damageAlpha > 0) {\n          damageAlpha = Math.max(0, damageAlpha - delta / 800)\n        }\n      }\n    }\n    \n    if (state.mouseLocked) {\n      const cursorX = cursor.getX()\n      const cursorY = cursor.getY()\n      ctx.beginPath()\n      ctx.strokeStyle = '#fff'\n      ctx.lineWidth = 1 * window.devicePixelRatio\n      ctx.moveTo(cursorX - 8.5, cursorY + 0.5)\n      ctx.lineTo(cursorX + 9.5, cursorY + 0.5)\n      ctx.moveTo(cursorX + 0.5, cursorY - 8.5)\n      ctx.lineTo(cursorX + 0.5, cursorY + 9.5)\n      ctx.stroke()\n    }\n\n    planetAngle += PLANET_SPIN_SPEED\n    planetAngle %= 2 * Math.PI\n  }\n\n  window.addEventListener('resize', () => checkSize())\n\n  return {\n    reset,\n    gotDamage,\n    setZoom,\n    setRubber,\n    checkSize,\n    addBubble,\n    drawFog,\n    drawShip,\n    drawBullet,\n    drawLine,\n    drawPowerup,\n    drawSmoke,\n    drawBubble,\n    drawPlanet,\n    explosion,\n    frame\n  }\n}\n","const chron = require('../src/utils/chron')\nconst jouter = document.getElementById('joystickouter')\nconst jbase = document.getElementById('joystickbase')\nconst jstick = document.getElementById('joystick')\n\nmodule.exports = (self, state, controls) => {\n  const applyPosition = () => {\n    if (state.dead || self === null) {\n      return\n    }\n\n    const hjbw = jbase.offsetWidth / 2\n    const hjbh = jbase.offsetHeight / 2\n    let x = (jstick.offsetLeft + (jstick.offsetWidth / 2) - (jbase.offsetLeft + hjbw)) / hjbw * Math.sqrt(2)\n    let y = (jstick.offsetTop + (jstick.offsetHeight / 2) - (jbase.offsetTop + hjbh)) / hjbh * Math.sqrt(2)\n    if (x > 1) x = 1\n    if (x < -1) x = -1\n    if (y > 1) y = 1\n    if (y < -1) y = -1\n\n    const h = Math.hypot(x, y)\n    \n    const willAccel = h > 0.8\n    let shouldUpdateAccelStart = willAccel != controls.isAccelerating()\n\n    if (!self.latched && h > 0.01) {\n      const angle = Math.atan2(x, -y)\n      shouldUpdateAccelStart |= self.orient != angle\n      self.orient = angle \n    }\n\n    controls.accelerate(willAccel)\n    if (shouldUpdateAccelStart) {\n      if (willAccel) {\n        self.accel = chron.timeMs()\n      } else {\n        self.accel = null\n      }\n      controls.resendControls()\n    }\n  }\n\n  const resetJoystickCenter = () => {\n    jstick.style.top = jbase.offsetTop + (jbase.offsetHeight / 2) - (jstick.offsetHeight / 2) + 'px'\n    jstick.style.left = jbase.offsetLeft + (jbase.offsetWidth / 2) - (jstick.offsetWidth / 2) + 'px'\n    applyPosition()\n  }\n\n  jbase.addEventListener('pointerdown', (e) => {\n    jstick.style.left = e.clientX - (jstick.offsetWidth / 2) + 'px'\n    jstick.style.top = e.clientY - (jstick.offsetHeight / 2) + 'px'\n    applyPosition()\n  })\n\n  jbase.addEventListener('pointermove', (e) => {\n    if (e.pressure > 0 || e.buttons & 1) {\n      jstick.style.left = e.clientX - (jstick.offsetWidth / 2) + 'px'\n      jstick.style.top = e.clientY - (jstick.offsetHeight / 2) + 'px'\n      applyPosition()\n    }\n  })\n\n  jbase.addEventListener('pointerout', (e) => {\n    e.stopPropagation()\n    e.stopImmediatePropagation()\n  })\n\n  jstick.addEventListener('pointerout', (e) => {\n    e.stopPropagation()\n    e.stopImmediatePropagation()\n  })\n\n  jouter.addEventListener('pointerout', () => {\n    resetJoystickCenter()\n  })\n\n  jouter.addEventListener('pointerup', () => {\n    resetJoystickCenter()\n  })\n\n  return {\n    applyPosition,\n    resetJoystickCenter\n  }\n}\n","const physics = require('../src/game/physics')\nconst chron = require('../src/utils/chron')\n\nmodule.exports = (self, objects, controls) => {\n  const serverTick = (delta, rubber) => {\n    if (controls.isAccelerating()) {\n      physics.accel(self, chron.timeMs() - self.accel)\n    }\n    if (controls.isBraking()) {\n      physics.brake(self)\n    }\n    if (controls.isFiring() \n      && self.fireWaitTicks <= 0\n      && !self.latched) {\n      physics.recoil(self)\n    }\n    physics.inertia(self)\n    if (!self.latched) {\n      physics.rubberband(self, rubber)\n      objects.planets = physics.getPlanets(self.posX, self.posY)\n      physics.gravityShip(self, objects.planets)\n    }\n\n    for (const ship of objects.ships) {\n      if (!ship.latched) {\n        physics.gravityShip(ship, physics.getPlanets(ship.posX, ship.posY))\n      }\n    }\n\n    for (const bullet of objects.bullets) {\n      if (bullet.type !== 'mine') {\n        if (bullet.type !== 'laser') {\n          bullet.posX = bullet.syncPosX\n          bullet.posY = bullet.syncPosY\n          physics.gravityBullet(bullet, physics.getPlanets(bullet.posX, bullet.posY))\n        }\n        bullet.posX = bullet.syncPosX = bullet.syncPosX + bullet.velX * delta\n        bullet.posY = bullet.syncPosY = bullet.syncPosY + bullet.velY * delta\n      }\n    }\n  }\n\n  return {\n    serverTick\n  }\n}\n","const common = require('./common')\n\nmodule.exports = (callbacks) => {\n  let dialogOpacity = 0\n  const DEBUG = false\n\n  document.getElementById('scoreanimation').style.animation = 'none'\n  document.getElementById('scoreanimation').style.visibility = 'hidden'\n  document.getElementById('powerupanimation').style.animation = 'none'\n  document.getElementById('powerupanimation').style.visibility = 'hidden'\n\n  const updateZoomText = zoom => {\n    document.getElementById('btnzoom').textContent = `zoom: ${(zoom * 100) | 0}%`\n  }\n\n  const showDialog = (always) => {\n    if (always || document.getElementById('dialog').style.display === 'none') {\n      dialogOpacity = 0\n      document.getElementById('dialogbox').style.opacity = '0'\n      document.getElementById('dialog').style.display = 'flex'\n      document.getElementById('gamestats').style.display = 'none'\n      document.getElementById('finalscore').style.display = 'block'\n      document.body.style.position = 'absolute'\n      document.body.style.overflow = ''\n    }\n  }\n\n  const wasKilled = () => {\n    document.getElementById('leaderboardtitle').textContent = 'leaderboard when you died'\n  }\n\n  const hideDialog = () => {\n    document.getElementById('dialog').style.display = 'none'\n    document.getElementById('gamestats').style.display = 'block'\n    document.getElementById('playerCount').style.display = 'block'\n    document.getElementById('leaderboardtitle').textContent = 'live leaderboard'\n    document.body.style.position = 'relative'\n    document.body.style.overflow = 'hidden'\n  }\n\n  const reset = () => {\n    document.getElementById('defeat').style.display = 'none'\n    document.getElementById('defeatcrash').style.display = 'none'\n    document.getElementById('defeatplanet').style.display = 'none'\n    document.getElementById('defeatname').style.display = 'none'\n    document.getElementById('disconnected').style.display = 'none'\n    document.getElementById('finalscore').style.display = 'none'\n  }\n\n  const endOfBuffer = () => {\n    document.getElementById('playerCount').style.display = 'none'\n  }\n\n  const disconnect = () => {\n    endOfBuffer()\n    reset()\n    document.getElementById('disconnected').style.display = 'inline'\n  }\n\n  const updateOpacity = (delta) => {\n    if (dialogOpacity < 1) {\n      dialogOpacity = Math.min(1, dialogOpacity + delta / 250)\n      document.getElementById('dialogbox').style.opacity = dialogOpacity\n    }\n  }\n\n  const makeTd = (text) => {\n    const td = document.createElement('td')\n    td.textContent = text\n    return td\n  }\n  \n  const makeTableRow = (lb) => {\n    const tr = document.createElement('tr')\n    tr.appendChild(makeTd(lb[0]))\n    tr.appendChild(makeTd(lb[1]))\n    return tr\n  }\n  \n  const updateLeaderboard = (leaderboard) => {\n    const leaderBoardTable = document.getElementById('leaderboard')\n    const newBody = document.createElement('tbody')\n    \n    for (let i = 0; i < Math.min(10, leaderboard.length); ++i) {\n      newBody.appendChild(makeTableRow(leaderboard[i]))\n    }\n  \n    leaderBoardTable.replaceChild(newBody, leaderBoardTable.childNodes[0])\n  }\n    \n  const formatTime = (sec) => {\n    sec = Math.floor(sec)\n    return `${0 | (sec / 60)}:${('0' + (sec % 60)).slice(-2)}`\n  }\n\n  const updateControls = (state) => {\n    if (state.dead) {\n      document.getElementById('mobilecontrols').style.display = 'none'\n    } else {\n      document.getElementById('mobilecontrols').style.display = common.isMobile() ? 'block' : 'none'\n    }\n  }\n\n  const updatePowerup = (self, state) => {\n    let resText = ''\n    if (!state.dead) {\n      if (self.item !== null) {\n        if (common.isMobile()) {\n          resText += `item: ${self.item} ([USE] to use)\\n`\n        } else {\n          resText += `item: ${self.item} ([Q] to use)\\n`\n        }\n      }\n      if (self.rubbership > 0) {\n        resText += `[${formatTime(self.rubbership / 1000)}] rubber ship\\n`\n      }\n      if (self.overdrive > 0) {\n        resText += `[${formatTime(self.overdrive / 1000)}] overdrive\\n`\n      }\n      if (self.regen > 0) {\n        resText += `[${formatTime(self.regen / 1000)}] regen\\n`\n      }\n    }\n    document.getElementById('powerupstatus').textContent = resText.trim()\n    document.getElementById('btnconsume').style.display = self.item !== null ? 'block' : 'none'\n  }\n\n  const updateOnlineStatus = (text) => {\n    document.getElementById('onlinestatus').textContent = text\n  }\n\n  const debug = (text) => {\n    if (!DEBUG) return\n    document.getElementById('debuginfo').textContent = text\n  }\n\n  const updateColors = (health, time) => {\n    if (health < 0.3) {\n      document.getElementById('yourscore').style.color = (time % 1000) >= 500 ? '#f88' : '#fff'\n      document.getElementById('healthbarhealth').style.background = ((time + 100) % 800) >= 400 ? '#800' : '#c00'\n    } else if (health < 0.7) {\n      const t = (health - 0.3) / 0.4 * 204\n      document.getElementById('yourscore').style.color = '#fff'\n      document.getElementById('healthbarhealth').style.background = `rgba(204,${t},${t})`\n    } else {\n      document.getElementById('yourscore').style.color = '#fff'\n      document.getElementById('healthbarhealth').style.background = '#ccc'\n    }\n  }\n\n  const updateScore = (scoreNow, scoreWas) => {\n    document.getElementById('yourscore').textContent \n      = document.getElementById('scoreanimation').textContent \n      = document.getElementById('finalscorenum').textContent \n      = scoreNow\n    if (scoreNow > scoreWas) {\n      document.getElementById('scoreanimation').style.visibility = 'visible'\n      document.getElementById('scoreanimation').style.animation = 'none'\n      document.getElementById('scoreanimation').offsetHeight\n      document.getElementById('scoreanimation').style.animation = ''\n    }\n  }\n\n  const updatePlayerCount = (players) => {\n    document.getElementById('playerCountNum').textContent = players\n  }\n\n  const updateHealthBar = (health) => {\n    document.getElementById('healthbarhealth').style.width = `${Math.ceil(health * 200)}px`\n  }\n\n  const addDeathLog = (text) => {\n    const deathLog = document.getElementById('deathlog')\n    if (deathLog.childElementCount > 5)\n      deathLog.removeChild(deathLog.firstChild)\n    const p = document.createElement('p')\n    p.textContent = text\n    setTimeout(() => {\n      if (p.parentNode) p.parentNode.removeChild(p)\n    }, 5000)\n    deathLog.appendChild(p)\n  }\n\n  const defeatedByPlayer = (name) => {\n    reset()\n    document.getElementById('defeat').style.display = 'inline'\n    document.getElementById('defeatname').style.display = 'inline'\n    document.getElementById('defeatname').innerHTML = name\n  }\n\n  const defeatedByCrash = (name) => {\n    reset()\n    document.getElementById('defeatcrash').style.display = 'inline'\n    document.getElementById('defeatname').style.display = 'inline'\n    document.getElementById('defeatname').innerHTML = name\n  }\n\n  const defeatedByPlanet = () => {\n    reset()\n    document.getElementById('defeatplanet').style.display = 'inline'\n  }\n\n  const showPowerupAnimation = () => {\n    // document.getElementById('powerupanimation').style.visibility = 'visible'\n    document.getElementById('powerupanimation').style.animation = 'none'\n    document.getElementById('powerupanimation').offsetHeight\n    document.getElementById('powerupanimation').style.animation = ''\n  }\n\n  const joiningGame = () => {\n    document.getElementById('scoreanimation').style.animation = 'none'\n    document.getElementById('scoreanimation').style.visibility = 'hidden'\n    document.getElementById('powerupanimation').style.animation = 'none'\n    document.getElementById('powerupanimation').style.visibility = 'hidden'\n    document.getElementById('btnplay').blur()\n    updateOnlineStatus('connecting')\n  }\n\n  document.getElementById('btnplay').addEventListener('click', (e) => {\n    callbacks.tryLockMouse(e)\n    callbacks.joinGame()\n  })\n  document.getElementById('btnhelp').addEventListener('click', () => {\n    document.getElementById('gamehelp').style.display = 'block'\n  })\n  document.getElementById('btnclosehelp').addEventListener('click', () => {\n    document.getElementById('gamehelp').style.display = 'none'\n  })\n  document.getElementById('btnfs').addEventListener('click', () => {\n    if (document.fullscreenElement) {\n      document.exitFullscreen()\n    } else {\n      document.documentElement.requestFullscreen()\n    }\n  })\n  document.getElementById('btnzoom').addEventListener('click', () => {\n    callbacks.nextZoom(1)\n  })\n\n  if (!DEBUG)\n    document.getElementById('debuginfo').style.display = 'none'\n\n  return {\n    updateZoomText,\n    updatePowerup,\n    showDialog,\n    hideDialog,\n    wasKilled,\n    reset,\n    endOfBuffer,\n    disconnect,\n    updateControls,\n    updateOpacity,\n    updateLeaderboard,\n    updateOnlineStatus,\n    updateColors,\n    updateScore,\n    updatePlayerCount,\n    updateHealthBar,\n    showPowerupAnimation,\n    defeatedByPlayer,\n    defeatedByCrash,\n    defeatedByPlanet,\n    joiningGame,\n    addDeathLog,\n    debug,\n  }\n}\n","/*! js-cookie v3.0.1 | MIT */\n;\n(function (global, factory) {\n  typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\n  typeof define === 'function' && define.amd ? define(factory) :\n  (global = global || self, (function () {\n    var current = global.Cookies;\n    var exports = global.Cookies = factory();\n    exports.noConflict = function () { global.Cookies = current; return exports; };\n  }()));\n}(this, (function () { 'use strict';\n\n  /* eslint-disable no-var */\n  function assign (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n      for (var key in source) {\n        target[key] = source[key];\n      }\n    }\n    return target\n  }\n  /* eslint-enable no-var */\n\n  /* eslint-disable no-var */\n  var defaultConverter = {\n    read: function (value) {\n      if (value[0] === '\"') {\n        value = value.slice(1, -1);\n      }\n      return value.replace(/(%[\\dA-F]{2})+/gi, decodeURIComponent)\n    },\n    write: function (value) {\n      return encodeURIComponent(value).replace(\n        /%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,\n        decodeURIComponent\n      )\n    }\n  };\n  /* eslint-enable no-var */\n\n  /* eslint-disable no-var */\n\n  function init (converter, defaultAttributes) {\n    function set (key, value, attributes) {\n      if (typeof document === 'undefined') {\n        return\n      }\n\n      attributes = assign({}, defaultAttributes, attributes);\n\n      if (typeof attributes.expires === 'number') {\n        attributes.expires = new Date(Date.now() + attributes.expires * 864e5);\n      }\n      if (attributes.expires) {\n        attributes.expires = attributes.expires.toUTCString();\n      }\n\n      key = encodeURIComponent(key)\n        .replace(/%(2[346B]|5E|60|7C)/g, decodeURIComponent)\n        .replace(/[()]/g, escape);\n\n      var stringifiedAttributes = '';\n      for (var attributeName in attributes) {\n        if (!attributes[attributeName]) {\n          continue\n        }\n\n        stringifiedAttributes += '; ' + attributeName;\n\n        if (attributes[attributeName] === true) {\n          continue\n        }\n\n        // Considers RFC 6265 section 5.2:\n        // ...\n        // 3.  If the remaining unparsed-attributes contains a %x3B (\";\")\n        //     character:\n        // Consume the characters of the unparsed-attributes up to,\n        // not including, the first %x3B (\";\") character.\n        // ...\n        stringifiedAttributes += '=' + attributes[attributeName].split(';')[0];\n      }\n\n      return (document.cookie =\n        key + '=' + converter.write(value, key) + stringifiedAttributes)\n    }\n\n    function get (key) {\n      if (typeof document === 'undefined' || (arguments.length && !key)) {\n        return\n      }\n\n      // To prevent the for loop in the first place assign an empty array\n      // in case there are no cookies at all.\n      var cookies = document.cookie ? document.cookie.split('; ') : [];\n      var jar = {};\n      for (var i = 0; i < cookies.length; i++) {\n        var parts = cookies[i].split('=');\n        var value = parts.slice(1).join('=');\n\n        try {\n          var foundKey = decodeURIComponent(parts[0]);\n          jar[foundKey] = converter.read(value, foundKey);\n\n          if (key === foundKey) {\n            break\n          }\n        } catch (e) {}\n      }\n\n      return key ? jar[key] : jar\n    }\n\n    return Object.create(\n      {\n        set: set,\n        get: get,\n        remove: function (key, attributes) {\n          set(\n            key,\n            '',\n            assign({}, attributes, {\n              expires: -1\n            })\n          );\n        },\n        withAttributes: function (attributes) {\n          return init(this.converter, assign({}, this.attributes, attributes))\n        },\n        withConverter: function (converter) {\n          return init(assign({}, this.converter, converter), this.attributes)\n        }\n      },\n      {\n        attributes: { value: Object.freeze(defaultAttributes) },\n        converter: { value: Object.freeze(converter) }\n      }\n    )\n  }\n\n  var api = init(defaultConverter, { path: '/' });\n  /* eslint-enable no-var */\n\n  return api;\n\n})));\n","const chron = require('../utils/chron')\nconst geom = require('../utils/geom')\nconst maths = require('../utils/maths')\nconst physics = require('./physics')\nconst Counter = require('../utils/counter')\nconst bulletCounter = new Counter()\nconst { filterInplace } = require('../utils/filter')\n\nconst BULLET_VELOCITY = physics.MAX_SHIP_VELOCITY * 2.4\nconst BULLET_DAMAGE_MULTIPLIER = 0.115\n\nconst newBullet = () => ({\n  posX: 0, posY: 0,           // position X, Y\n  velX: 0, velY: 0,           // velocity X, Y\n  dist: 0,                    // distance taken\n  velocity: 0,\n  shooter: null,\n  shooterName: '',\n  isHit: false,\n  canPickUp: true,\n  type: 'bullet',\n  damage: 1,\n  radius: 0.3,\n  punch: 0,\n\n  dead: false,\n  _id: bulletCounter.next()\n})\n\nconst FIELDS = [\n  '_id', 'posX', 'posY', 'velX', 'velY', 'dist', 'dead', 'velocity',\n  'shooter', 'shooterName', 'isHit', 'canPickUp', 'type', 'damage'\n]\n\nconst FIELDS_SHORT = [\n  '_id', 'posX', 'posY', 'velX', 'velY', 'dist'\n]\n\nconst bulletTypeRadius = {\n  bullet: 0.3,\n  laser: 0.01,\n  knockout: 0.7,\n}\n\nconst bulletSystemFactory = handler => {\n  let bullets = []\n\n  const getBullets = () => bullets\n\n  const removeBullet = (bullet) => {\n    bullet.dead = true\n    handler.onBulletDeleted(bullet)\n  }\n\n  const handleShipBulletCollision = (ships, ship, bullet) => {\n    if (bullet.dead) {\n      return\n    }\n    const shooter = ships.getShipById(bullet.shooter)\n    if (shooter && shooter.absorber) {\n      shooter.health += 0.01 * shooter.healthMul\n    }\n    ships.damageShip(ship, BULLET_DAMAGE_MULTIPLIER * bullet.damage, bullet, shooter, handler.killShipByBullet)\n    if (bullet.punch) {\n      if (ship.latched) {\n        ship.latched = false\n        ship.velX += Math.sin(-ship.orient) * 25 * bullet.punch\n        ship.velY += Math.cos(-ship.orient) * 25 * bullet.punch\n      } else {\n        let hitX = ship.posX - bullet.posX\n        let hitY = ship.posY - bullet.posY;\n        [hitX, hitY] = geom.normalize(hitX, hitY, 25 * bullet.punch)\n        ship.velX += hitX\n        ship.velY += hitY\n      }\n      if (shooter) {\n        ship.lastDamageAt = chron.timeMs()\n        ship.lastDamageBy = bullet.shooter\n      }\n      physics.checkMaxVelocity(ship)\n    }\n    if (bullet.type !== 'laser') {\n      removeBullet(bullet)\n    }\n  }\n\n  const handlePowerupBulletCollision = (ships, powerup, bullet, powerups) => {\n    if (bullet.dead) {\n      return\n    }\n    const shooter = ships.getShipById(bullet.shooter)\n    if (shooter) {\n      powerups.applyPowerup(shooter, powerup)\n    }\n    if (bullet.type !== 'laser') {\n      removeBullet(bullet)\n    }\n  }\n\n  const removeMinesBy = ship => {\n    const shipId = ship._id\n    const projList = getBullets()\n    const projCount = projList.length\n    for (let i = 0; i < projCount; ++i) {\n      const bullet = projList[i]\n      if (bullet.type === 'mine' && bullet.shooter === shipId) {\n        removeBullet(bullet)\n      }\n    }\n  }\n\n  const moveBullets = (delta, ships, powerups) => {\n    const powerupList = powerups.getPowerups()\n    const bulletList = getBullets()\n    const powerupCount = powerupList.length\n    const bulletCount = bulletList.length\n\n    for (let i = 0; i < bulletCount; ++i) {\n      const bullet = bulletList[i]\n      if (bullet.dist > physics.MAX_BULLET_DISTANCE) {\n        removeBullet(bullet)\n        continue\n      }\n      if (bullet.dead) continue\n\n      switch (bullet.type) {\n      case 'bullet':\n      case 'knockout':\n        physics.gravityBullet(bullet, physics.getPlanets(bullet.posX, bullet.posY))\n        // fall through\n      case 'laser':\n      {\n        const newX = bullet.posX + delta * bullet.velX\n        const newY = bullet.posY + delta * bullet.velY\n        const isLaser = bullet.type === 'laser'\n\n        let collisionShip = null\n        for (const ship of ships.iterateShips()) {\n          if (ship._id !== bullet.shooter\n            && Math.abs(ship.posX - bullet.posX) < 2 * delta * Math.abs(bullet.velX) + bullet.radius\n            && Math.abs(ship.posY - bullet.posY) < 2 * delta * Math.abs(bullet.velY) + bullet.radius) {\n            const t = geom.closestSynchroDistance(\n              [ship.posX, ship.posY],\n              [ship.posXnew, ship.posYnew],\n              [bullet.posX, bullet.posY],\n              [newX, newY])\n            if ((isLaser ? 0 : -2) <= t && t <= (isLaser ? 1 : 3)) {\n              [ship.posX, ship.posY] = geom.lerp2D([ship.posX, ship.posY],\n                maths.clamp(0, t, 1), [ship.posXnew, ship.posYnew])\n              const [p1, p2, p3] = geom.getCollisionPoints(ship)\n              const dist = geom.lineClosestDistanceToTriangle(\n                [bullet.posX, bullet.posY], [newX, newY], p1, p2, p3)\n              if (dist < bullet.radius) {\n                collisionShip = ship\n                break\n              }\n            }\n          }\n        }\n\n        if (collisionShip) {\n          handleShipBulletCollision(ships, collisionShip, bullet)\n        }\n\n        let collisionPowerup = null\n        if (bullet.canPickUp) {\n          for (let j = 0; j < powerupCount; ++j) {\n            const powerup = powerupList[j]\n            if (Math.abs(powerup.posX - bullet.posX) < bullet.velocity &&\n                Math.abs(powerup.posY - bullet.posY) < bullet.velocity) {\n              const r = powerup.pickupRadius * 0.35\n              const a1 = [\n                powerup.posX - (bullet.posY - powerup.posY) * r,\n                powerup.posY - (powerup.posX - bullet.posX) * r\n              ]\n              const a2 = [\n                powerup.posX + (bullet.posY - powerup.posY) * r,\n                powerup.posY + (powerup.posX - bullet.posX) * r\n              ]\n              if (geom.lineIntersectsLine([bullet.posX, bullet.posY],\n                [newX, newY], a1, a2)) {\n                collisionPowerup = powerup\n                break\n              }\n            }\n          }\n        }\n\n        if (collisionPowerup) {\n          handlePowerupBulletCollision(ships, collisionPowerup, bullet, powerups)\n        }\n        \n        let hitPlanet = false\n        const planets = physics.getPlanets(newX, newY)\n        for (const planet of planets) {\n          if (Math.hypot(planet.x - newX, planet.y - newY) < planet.radius) {\n            hitPlanet = true\n            break\n          }\n        }\n\n        if (hitPlanet) {\n          removeBullet(bullet)\n          continue\n        }\n\n        bullet.posX = newX\n        bullet.posY = newY\n        bullet.dist += delta * bullet.velocity\n        break\n      }\n      case 'mine':\n      {\n        const r = 3 + 7 * Math.random() ** 3\n        let primerShip = null\n        \n        for (const ship of ships.iterateShips()) {\n          if (!ship.dead && bullet.shooter !== ship._id &&\n              Math.hypot(ship.posX - bullet.posX,\n                ship.posY - bullet.posY) < r) {\n            primerShip = ship\n            break\n          }\n        }\n\n        if (primerShip || bullet.isHit) {\n          // blow up the mine\n          for (const ship of ships.iterateShips()) {\n            if (bullet.shooter === ship._id) continue\n            if (Math.abs(ship.posX - bullet.posX) > 15 ||\n              Math.abs(ship.posY - bullet.posY) > 15) {\n              continue\n            }\n\n            let damage = 2 / Math.sqrt(Math.hypot(\n              ship.posX - bullet.posX, ship.posY - bullet.posY))\n\n            if (damage < 0.05) {\n              damage = 0\n            }\n\n            const shooter = ships.getShipById(bullet.shooter)\n            ships.damageShip(ship, damage, bullet, shooter, handler.killShipByBullet)\n          }\n\n          handler.onMineExplode(bullet)\n          removeBullet(bullet)\n          continue\n        }\n\n        bullet.dist += physics.MAX_BULLET_DISTANCE / (physics.MINE_LIFETIME * physics.TICKS_PER_SECOND)\n        break\n      }\n      }\n    }\n\n    filterInplace(bullets, bullet => !bullet.dead)\n  }\n\n  const addProjectile = (ship, type, extras) => {\n    const [p1, , , ] = geom.getShipPoints(ship)\n    const { \n      extraDist, \n      orientOffset, \n      speedFactor,\n      damageFactor, \n      rangeSub,\n      canPickUp,\n      noShear,\n      punch } = { \n      extraDist: 0,\n      orientOffset: 0,\n      speedFactor: 1,\n      damageFactor: 1,\n      rangeSub: 0,\n      canPickUp: true,\n      noShear: false,\n      punch: 0,\n      ...(extras || {}) }\n\n    let typeSpeedMul = 1\n    if (type == 'mine') {\n      typeSpeedMul = 0\n    }\n    typeSpeedMul *= speedFactor\n\n    let bullet = newBullet()\n    bullet = {\n      ...bullet,\n      posX: p1[0] + Math.sin(-ship.orient + orientOffset) * extraDist,\n      posY: p1[1] + Math.cos(-ship.orient + orientOffset) * extraDist,\n      type: type,\n      velocity: BULLET_VELOCITY * ship.bulletSpeedMul,\n      velX: typeSpeedMul * BULLET_VELOCITY * Math.sin(-ship.orient + orientOffset) * ship.bulletSpeedMul + (noShear ? 0 : ship.velX),\n      velY: typeSpeedMul * BULLET_VELOCITY * Math.cos(-ship.orient + orientOffset) * ship.bulletSpeedMul + (noShear ? 0 : ship.velY),\n      dist: rangeSub,\n      damage: damageFactor,\n      canPickUp: canPickUp,\n      shooter: ship._id,\n      shooterName: ship.name,\n      radius: bulletTypeRadius[type] || bulletTypeRadius['bullet'],\n      punch: punch\n    }\n    //[bullet.velX, bullet.velY] = geom.normalize(bullet.velX, bullet.velY, bullet.velocity)\n    bullets.push(bullet)\n    return bullet\n  }\n\n  return {\n    getBullets,\n    moveBullets,\n    addProjectile,\n    removeBullet,\n    removeMinesBy\n  }\n}\n\nmodule.exports = {\n  system: bulletSystemFactory,\n  FIELDS,\n  FIELDS_SHORT,\n}\n","const GRAV = 6.67e-11\nconst TICKS_PER_SECOND = 25\nconst TICK_DELTA = 1 / TICKS_PER_SECOND\nconst MS_PER_TICK = 1000 / TICKS_PER_SECOND\nconst MAX_SHIP_VELOCITY = 1128 / TICKS_PER_SECOND\nconst ACTUAL_MAX_SHIP_VELOCITY = MAX_SHIP_VELOCITY * 2.25\nconst ACCEL_BASE = 1.9375\nconst ACCEL_FACTOR = 0.00055\nconst MIN_SHIP_VELOCITY = 0.21\nconst LATCH_VELOCITY = 7\nconst BRAKE_MUL = (MIN_SHIP_VELOCITY / MAX_SHIP_VELOCITY) ** (1 / (TICKS_PER_SECOND * 1.5))\nconst VIEW_DISTANCE = 55\nconst MAX_BULLET_DISTANCE = 125\nconst RUBBERBAND_BUFFER = 80\nconst RUBBERBAND_RADIUS_MUL = 80\nconst MINE_LIFETIME = 120\nconst INERTIA_MUL = 1\nconst RECOIL = 0.017\n// (MIN_SHIP_VELOCITY / MAX_SHIP_VELOCITY) ** (1 / (TICKS_PER_SECOND * 90))\n\nconst LCG = require('../utils/lcg')\nconst geom = require('../utils/geom')\nconst PLANET_CHUNK_SIZE = VIEW_DISTANCE * 1.6 + 1\nconst lcg = new LCG(0)\n\nlet PLANET_SEED = 1340985553\n\nconst getAccelMul = (accelTimeMs) => { // time in milliseconds\n  return ACCEL_BASE + ACCEL_FACTOR * Math.min(accelTimeMs, 2500)\n}\n\nconst getAccelRamp = (v) => {\n  if (v < MAX_SHIP_VELOCITY) return 1\n  return (geom.unlerp1D(ACTUAL_MAX_SHIP_VELOCITY, v, MAX_SHIP_VELOCITY)) ** 1.5\n}\n\nconst checkMinVelocity = (ship) => {\n  const v = Math.hypot(ship.velX, ship.velY)\n  if (v <= MIN_SHIP_VELOCITY) {\n    ship.velX = 0\n    ship.velY = 0\n  }\n}\n\nconst checkMaxVelocity = (ship) => {\n  const maxvel = ACTUAL_MAX_SHIP_VELOCITY * healthToVelocity(ship.health) * ship.speedMul\n  const v = Math.hypot(ship.velX, ship.velY)\n  if (v > maxvel) {\n    ship.velX *= maxvel / v\n    ship.velY *= maxvel / v\n  }\n}\n\nconst getPlanetSeed = () => {\n  return PLANET_SEED\n}\n\nconst setPlanetSeed = (seed) => {\n  PLANET_SEED = seed\n}\n\nconst newPlanetSeed = () => {\n  PLANET_SEED = Math.floor(Math.random() * 2147483647)\n}\n\n// planet: x, y, radius, seed\nconst getPlanetsForChunk = (cx, cy) => {\n  const r = PLANET_CHUNK_SIZE\n  const xb = (cx + 0.5) * r\n  const yb = (cy + 0.5) * r\n\n  lcg.reseed((PLANET_SEED ^ (cx * 1173320513) ^ (cy * 891693747)) & 0xFFFFFFFF)\n  \n  const xo = lcg.randomOffset() * (r / 4)\n  const yo = lcg.randomOffset() * (r / 4)\n  const radius = (r / 20) + (r / 12) * lcg.random()\n  const seed = lcg.randomInt()\n  return [ { x: xb + xo, y: yb + yo, radius, seed } ]\n}\n\nconst getPlanets = (x, y) => {\n  const x0 = Math.floor(x / PLANET_CHUNK_SIZE)\n  const y0 = Math.floor(y / PLANET_CHUNK_SIZE)\n\n  const xu = [x0 - 2, x0 - 1, x0, x0 + 1, x0 + 2]\n  const yu = [y0 - 2, y0 - 1, y0, y0 + 1, y0 + 2]\n  let planets = []\n\n  for (const x of xu) {\n    for (const y of yu) {\n      planets = [...planets, ...getPlanetsForChunk(x, y)]\n    }\n  }\n  \n  return planets\n}\n\nconst hasOverdrive = (ship) => {\n  return ship.overdrive > 0\n}\n\nconst hasRubbership = (ship) => {\n  return ship.rubbership > 0\n}\n\nconst hasRegen = (ship) => {\n  return ship.regen > 0\n}\n\nconst accel = (ship, accelTimeMs) => {\n  let accelMul = getAccelMul(accelTimeMs) * healthToVelocity(ship.health)\n    * ship.thrustBoost\n    * (hasOverdrive(ship) ? 2 : 1) * (ship.highAgility ? 1.2 : 1)\n  if (ship.speedMul !== 1) {\n    accelMul *= Math.sqrt(ship.speedMul)\n  }\n  const v = Math.hypot(ship.velX, ship.velY)\n  ship.velX += accelMul * getAccelRamp(v) * Math.sin(-ship.orient)\n  ship.velY += accelMul * getAccelRamp(v) * Math.cos(-ship.orient)\n  checkMaxVelocity(ship)\n}\n\nconst inertia = (ship) => {\n  ship.velX *= INERTIA_MUL\n  ship.velY *= INERTIA_MUL\n  checkMinVelocity(ship)\n}\n\nconst brake = (ship) => {\n  ship.velX *= BRAKE_MUL\n  ship.velY *= BRAKE_MUL\n  checkMinVelocity(ship)\n}\n\nconst recoil = (ship) => {\n  ship.velX -= RECOIL * Math.sin(-ship.orient)\n  ship.velY -= RECOIL * Math.cos(-ship.orient)\n  checkMaxVelocity(ship)\n}\n\nconst gravityBullet = (bullet, planets) => {\n  if (bullet.type == 'mine') {\n    return\n  }\n\n  let gx = 0\n  let gy = 0\n  let gravity = false\n  for (const planet of planets) {\n    const d = Math.hypot(bullet.posX - planet.x, bullet.posY - planet.y)\n    if (d > (planet.radius + 1) && d < 10 + planet.radius * 4) {\n      const dx = planet.x - bullet.posX\n      const dy = planet.y - bullet.posY\n      const r2 = dx ** 2 + dy ** 2\n      const f = GRAV * 1.25e+11 / r2 * planet.radius\n      gravity = true\n      gx += f * dx\n      gy += f * dy\n    }\n  }\n  if (gravity) {\n    bullet.velX += gx\n    bullet.velY += gy\n  }\n}\n\nconst gravityShip = (ship, planets) => {\n  let thrust = 1\n  const vector = [Math.sin(-ship.orient), Math.cos(-ship.orient)]\n  const dv = Math.hypot(ship.velX, ship.velY)\n  for (const planet of planets) {\n    const d = Math.hypot(ship.posX - planet.x, ship.posY - planet.y)\n    if (d < 10 + planet.radius * 4) {\n      const dx = planet.x - ship.posX\n      const dy = planet.y - ship.posY\n      const r2 = dx ** 2 + dy ** 2\n      const f = GRAV * 2.2e+10 * planet.radius / r2 / (\n        (ship.brake !== null) ? 3 : 1)\n      ship.velX += f * dx\n      ship.velY += f * dy\n      if (ship.accel !== null) {\n        const direction = geom.normalize(dx, dy)\n        thrust += 50 * (Math.min(1, dv / MAX_SHIP_VELOCITY) ** 0.5) *\n          Math.min(1, dv * 0.009) *\n          (Math.max(0, f * geom.dot2D(direction, vector)))\n      }\n    }\n  }\n  ship.thrustBoost = Math.min(thrust, 1.5)\n  checkMaxVelocity(ship)\n}\n\nconst getRubberbandRadius = (playerCount) => {\n  return RUBBERBAND_RADIUS_MUL * Math.pow(Math.max(playerCount, 1), 0.75)\n}\n\nconst rubberband = (ship, radius) => {\n  const distCenter = Math.hypot(ship.posX, ship.posY)\n  if (distCenter > radius) {\n    const maxRadius = radius + RUBBERBAND_BUFFER\n    const baseX = -ship.posX / Math.hypot(ship.posX, ship.posY)\n    const baseY = -ship.posY / Math.hypot(ship.posX, ship.posY)\n    const d = (distCenter - radius) / (maxRadius - radius)\n    ship.velX += baseX * 0.3 * MAX_SHIP_VELOCITY * (1.1 * d) ** 8\n    ship.velY += baseY * 0.3 * MAX_SHIP_VELOCITY * (1.1 * d) ** 8\n    const v = Math.hypot(ship.velX, ship.velY)\n    if (v > MAX_SHIP_VELOCITY) {\n      const nv = geom.lerp1D(v, 0.05, MAX_SHIP_VELOCITY)\n      ship.velX *= nv / v\n      ship.velY *= nv / v\n    }\n    checkMaxVelocity(ship)\n  }\n}\n\nconst healthToVelocity = (health) => {\n  return 0.7 + 0.3 * health\n}\n\nmodule.exports = {\n  TICKS_PER_SECOND,\n  MAX_SHIP_VELOCITY,\n  ACTUAL_MAX_SHIP_VELOCITY,\n  TICK_DELTA,\n  MS_PER_TICK,\n  LATCH_VELOCITY,\n  VIEW_DISTANCE,\n  MAX_BULLET_DISTANCE,\n  PLANET_CHUNK_SIZE,\n  RUBBERBAND_BUFFER,\n  MINE_LIFETIME,\n  checkMaxVelocity,\n  hasOverdrive,\n  hasRubbership,\n  hasRegen,\n  accel,\n  inertia,\n  brake,\n  recoil,\n  gravityBullet,\n  gravityShip,\n  rubberband,\n  getPlanets,\n  getPlanetSeed,\n  setPlanetSeed,\n  newPlanetSeed,\n  getRubberbandRadius,\n  healthToVelocity }\n","const chron = require('../utils/chron')\nconst physics = require('./physics')\nconst Counter = require('../utils/counter')\nconst powerupCounter = new Counter()\nconst { filterInplace } = require('../utils/filter')\n\nconst newPowerup = () => ({\n  posX: 0, posY: 0,           // position X, Y\n  despawn: chron.timeMs() + 15000,\n  pickupRadius: 3.5,\n  pickupDist: Infinity,\n  pickupPlayer: null,\n  \n  dead: false,\n  _id: powerupCounter.next()\n})\n\nconst FIELDS = [\n  '_id', 'dead', 'posX', 'posY', 'despawn'\n]\n\nconst powerupSystemFactory = handler => {\n  let powerups = []\n  let nextPowerup = null\n\n  const getPowerups = () => powerups\n\n  const clear = () => powerups.length = 0\n\n  const trySpawnPowerup = (playerCount, ships, radius) => {\n    let tries = playerCount * 4\n    let count = 0\n    while (tries > 0) {\n      const r = Math.sqrt(Math.random()) * (radius + 5)\n      const theta = Math.random() * 2 * Math.PI\n\n      const x = Math.sin(theta) * r\n      const y = Math.cos(theta) * r\n      \n      const playerDist = Math.min.apply(null, ships.getShips().map(\n        ship => Math.hypot(ship.posX - x, ship.posY - y)\n      ))\n      const inPlanet = Math.min.apply(null, physics.getPlanets(x, y).map(\n        planet => Math.hypot(planet.x - x, planet.y - y) - planet.radius\n      )) <= 2\n      const tooClose = Math.min.apply(null, getPowerups().map(\n        powerup => Math.hypot(powerup.posX - x, powerup.posY - y)\n      )) <= 3\n\n      if (Math.random() < 0.2 && playerDist >= 30 && !inPlanet && !tooClose) {\n        let powerup = newPowerup()\n        powerup = {\n          ...powerup,\n          posX: x,\n          posY: y\n        }\n        powerups.push(powerup)\n        handler.onPowerupSpawned(powerup)\n        ++count\n      }\n      --tries\n    }\n    return count\n  }\n\n  const setNextPowerupTime = (ships, division) => {\n    const playerCount = Math.max(1, ships.getShipCount())\n    nextPowerup = chron.timeMs() + (1000 * (10 + 18 * Math.random()) / Math.pow(playerCount, 0.125) / division)\n  }\n\n  const maybeSpawnPowerup = (ships, radius) => {\n    const playerCount = Math.max(1, ships.getShipCount())\n    let division = 1\n    if (nextPowerup != null && chron.timeMs() >= nextPowerup) {\n      division = trySpawnPowerup(playerCount, ships, radius) > 0 ? 1 : 8\n      setNextPowerupTime(ships, division)\n    } else if (nextPowerup == null) {\n      setNextPowerupTime(ships, division)\n    }\n  }\n\n  const applyPowerup = (ship, powerup) => {\n    const ITEM_COUNT = 10\n    const item = 0 | (ITEM_COUNT * Math.random())\n    switch (item) {\n    case 0:\n      if (ship.item === null) {\n        ship.item = 'laser'\n      }\n      break\n    case 1:\n      if (ship.item === null) {\n        ship.item = 'reheal'\n      }\n      break\n    case 2:\n      if (ship.item === null) {\n        ship.item = 'bomb'\n      }\n      break\n    case 3:\n      if (ship.item === null) {\n        ship.item = 'mine'\n      }\n      break\n    case 4:\n      if (ship.item === null) {\n        ship.item = 'orion'\n      }\n      break\n    case 5:\n      ship.rubbership = 30 * 1000\n      break\n    case 6:\n      ship.regen = 10 * 1000\n      break\n    case 7:\n      ship.overdrive = 10 * 1000\n      break\n    case 8:\n      if (ship.item === null) {\n        ship.item = 'spread'\n      }\n      break\n    case 9:\n      if (ship.item === null) {\n        ship.item = 'knockout'\n      }\n      break\n    }\n    removePowerup(powerup)\n  }\n\n  const updateClosestPlayer = (powerup, ship, t) => {\n    if (powerup.pickupDist > t) {\n      powerup.pickupDist = t\n      powerup.pickupPlayer = ship\n    }\n  }\n\n  const removePowerup = (powerup) => {\n    powerup.dead = true\n    handler.onPowerupDeleted(powerup)\n  }\n\n  const updatePowerups = () => {\n    const now = chron.timeMs()\n    powerups.forEach((powerup) => {\n      if (now >= powerup.despawn) {\n        removePowerup(powerup)\n        return\n      }\n\n      if (powerup.pickupPlayer !== null) {\n        const ship = powerup.pickupPlayer\n        if (ship !== null && !ship.dead) {\n          applyPowerup(ship, powerup)\n          return\n        } else {\n          powerup.pickupDist = Infinity\n          powerup.pickupPlayer = null\n        }\n      }\n    })\n    filterInplace(powerups, powerup => !powerup.dead)\n  }\n\n  return {\n    getPowerups,\n    clear,\n    applyPowerup,\n    updateClosestPlayer,\n    maybeSpawnPowerup,\n    removePowerup,\n    updatePowerups\n  }\n}\n\nmodule.exports = {\n  system: powerupSystemFactory,\n  FIELDS,\n}\n","const geom = require('../utils/geom')\nconst chron = require('../utils/chron')\nconst physics = require('./physics')\nconst maths = require('../utils/maths')\nconst Counter = require('../utils/counter')\nconst shipCounter = new Counter()\n\nconst SHIP_RECT_RADIUS = 2\nconst SHIP_RADIUS = 1.35\n\nconst newShip = () => ({\n  posX: 0, posY: 0,           // position X, Y\n  velX: 0, velY: 0,           // velocity X, Y\n  orient: 0,                  // radians, clockwise from 0 = up\n  health: 1,                  // 0 = no health, 1 = max health\n\n  name: '',\n  score: 0,\n  accel: null,\n  brake: null,\n  firing: false,\n  latched: false,\n  fireWaitTicks: 0,\n  thrustBoost: 1,\n\n  // perks\n  firingInterval: 4,\n  bulletSpeedMul: 1.0,\n  healthMul: 1.0,\n  speedMul: 1.0,\n  planetDamageMul: 1.0,\n  highAgility: false,\n  absorber: false,\n  healRate: 1,\n\n  // powerups\n  item: null,\n  rubbership: 0,\n  regen: 0,\n  overdrive: 0,\n\n  lastDamageAt: null,\n  lastDamageBy: null,\n\n  dead: false,\n  _id: shipCounter.next()\n})\n\nconst FIELDS = [\n  '_id', 'dead', 'posX', 'posY', 'velX', 'velY', 'orient', 'health', 'name',\n  'score', 'accel', 'brake', 'firing', 'latched', 'fireWaitTicks', 'thrustBoost',\n  'firingInterval', 'bulletSpeedMul', 'healthMul', 'speedMul', 'planetDamageMul',\n  'highAgility', 'absorber', 'healRate', 'item', 'rubbership', 'regen', 'overdrive'\n]\n\nconst FIELDS_SHORT = [\n  '_id', 'dead', 'posX', 'posY', 'velX', 'velY', 'orient', 'health',\n  'name', 'score', 'accel', 'brake'\n]\n\nconst shipSystemFactory = handler => {\n  let ships = new Map()\n\n  const iterateShips = () => ships.values()\n  const getShips = () => [...iterateShips()]\n  const getShipById = id => ships.get(id)\n  const getShipCount = () => ships.size\n\n  const newPlayerShip = (radius, bullets) => {\n    const ship = newShip()\n    spawn(ship, radius, bullets)\n    ships.set(ship._id, ship)\n    return ship\n  }\n\n  const latchToPlanet = (ship, planet) => {\n    const planetAngle = Math.atan2(planet.x - ship.posX,\n      planet.y - ship.posY) + Math.PI\n    latchToPlanetWithAngle(ship, planet, planetAngle)\n  }\n\n  const computePlanetPoint = (planet, angle) => {\n    return [planet.x + (planet.radius + 1.4) * Math.sin(angle),\n      planet.y + (planet.radius + 1.4) * Math.cos(angle)]\n  }\n\n  const latchToPlanetWithAngle = (ship, planet, angle) => {\n    const [x, y] = computePlanetPoint(planet, angle)\n    ship.velX = 0\n    ship.velY = 0\n    ship.posX = x\n    ship.posY = y\n    ship.posXnew = x\n    ship.posYnew = y\n    ship.orient = -angle\n    ship.latched = ship.accel === null\n    handler.onShipLatch(ship)\n  }\n\n  const spawnLone = (ship, radius) => {\n    let baseX = physics.VIEW_DISTANCE * maths.randomSign() * Math.random()\n    let baseY = physics.VIEW_DISTANCE * maths.randomSign() * Math.random()\n    \n    let planets = physics.getPlanets(baseX, baseY)\n    planets = planets.filter(planet =>\n      Math.hypot(planet.x, planet.y) < radius - planet.radius)\n    if (planets.length < 1) {\n      ship.posX = baseX\n      ship.posY = baseY\n      ship.orient = 0\n      return\n    }\n\n    const planet = planets[0 | (planets.length * Math.random())]\n    latchToPlanetWithAngle(ship, planet, Math.random() * 2 * Math.PI)\n  }\n\n  const spawn = (ship, radius, bullets) => {\n    const players = getShips()\n    const playerCount = players.length\n    let baseX = 0\n    let baseY = 0\n    if (playerCount < 1) {\n      return spawnLone(ship, radius)\n    }\n\n    let tries = 128\n    \n    while (--tries > 0) {\n      const randShip = players[(playerCount * Math.random()) | 0]\n      baseX = randShip.posX\n      baseY = randShip.posY\n      baseX += physics.VIEW_DISTANCE * maths.randomSign()\n      baseY += physics.VIEW_DISTANCE * maths.randomSign()\n      if (Math.hypot(baseX, baseY) >=\n            radius - (tries < 8 ? 0 : physics.PLANET_CHUNK_SIZE / 8)) {\n        continue\n      }\n    }\n\n    let planets = physics.getPlanets(baseX, baseY)\n    planets = planets.filter(planet =>\n      Math.hypot(planet.x, planet.y) < radius - (planet.radius - 3))\n    if (planets.length < 1) {\n      ship.posX = baseX + physics.VIEW_DISTANCE * maths.randomSign()\n      ship.posY = baseY + physics.VIEW_DISTANCE * maths.randomSign()\n      ship.orient = 2 * Math.PI * Math.random()\n      return\n    }\n    \n    planets.forEach(planet => {\n      planet.playerDist = Math.min.call(null, \n        getShips().map(ship => \n          Math.hypot(ship.posX - planet.x, ship.posY - planet.y)))\n      planet.bulletDist = Math.min.call(null, \n        bullets.getBullets().map(bullet => \n          Math.hypot(bullet.posX - planet.x, bullet.posY - planet.y)))\n    })\n\n    const ideal = planets.find(planet => \n      planet.playerDist > physics.VIEW_DISTANCE \n      && planet.bulletDist > physics.MAX_BULLET_DISTANCE)\n\n    if (ideal) {\n      latchToPlanetWithAngle(ship, ideal, Math.random() * 2 * Math.PI)\n      return\n    }\n\n    const testPlanet = (a, b) => (\n      a.playerDist + a.bulletDist * 1.5 > b.playerDist + b.bulletDist * 1.5\n    )\n    const mostIdeal = planets.reduce((a, b) => \n      (testPlanet(a, b) ? a : b)\n    )\n\n    // pick optimal angle\n    const angleOffset = Math.random() * 2 * Math.PI\n    let minimalScore = 0\n    let angle = 0\n    for (let i = 0; i < 8; ++i) {\n      const testAngle = angleOffset + i * Math.PI / 4\n      const [x, y] = computePlanetPoint(mostIdeal, testAngle)\n      const score = Math.min.call(null, \n        getShips().map(ship => \n          Math.hypot(ship.posX - x, ship.posY - y)))\n        + Math.min.call(null, \n          bullets.getBullets().map(bullet => \n            Math.hypot(bullet.posX - x, bullet.posY - y)))\n      if (minimalScore < score) {\n        minimalScore = score\n        angle = testAngle\n      }\n    }\n\n    latchToPlanetWithAngle(ship, mostIdeal, angle)\n  }\n\n  const doFire = (ship) => {\n    if (!ship || ship.dead !== false) {\n      return false\n    }\n\n    if (ship.fireWaitTicks <= 0) {\n      handler.addProjectile(ship, 'bullet', { speedFactor: ship.latched ? 1.25 : 1 })\n      ship.fireWaitTicks = ship.firingInterval\n      return true\n    }\n    return false\n  }\n\n  const shipAcceleration = (delta, radius, radiusGoal) => {\n    const now = chron.timeMs()\n    for (const ship of ships.values()) {\n      let doAccel = false\n      let doBrake = false\n  \n      if (ship.accel != null && ship.brake != null) {\n        if (ship.accel > ship.brake) {\n          doAccel = true\n        } else {\n          doBrake = true\n        }\n      } else if (ship.accel != null) {\n        doAccel = true\n      } else if (ship.brake != null) {\n        doBrake = true\n      }\n  \n      if (doAccel) {\n        physics.accel(ship, now - ship.accel)\n        ship.latched = false\n      } else if (doBrake) {\n        physics.brake(ship)\n      }\n      if (ship.firing) {\n        if (doFire(ship) && !ship.latched) {\n          physics.recoil(ship)\n        }\n      }\n  \n      physics.inertia(ship)\n      if (!ship.latched) {\n        physics.rubberband(ship, radius)\n      } else {\n        ship.velX = ship.velY = 0\n        if (Math.hypot(ship.posX, ship.posY) > (radius + 10) \n          && radiusGoal < radius) {\n          ship.latched = false\n          ship.velX += Math.sin(-ship.orient)\n          ship.velY += Math.cos(-ship.orient)\n        }\n      }\n      if (ship.latched && ship.health < 1) {\n        ship.health = Math.min(1, ship.health + ship.healthMul * ship.healRate * 1 / (20 * physics.TICKS_PER_SECOND))\n      }\n      if (physics.hasRegen(ship)) {\n        ship.health = Math.min(1, ship.health + ship.healthMul * ship.healRate * 1.5 / (20 * physics.TICKS_PER_SECOND))\n      }\n      ship.fireWaitTicks = Math.max(0, ship.fireWaitTicks - (physics.hasOverdrive(ship) ? 2 : 1))\n      ship.regen = Math.max(0, ship.regen - physics.MS_PER_TICK)\n      ship.overdrive = Math.max(0, ship.overdrive - physics.MS_PER_TICK)\n      ship.rubbership = Math.max(0, ship.rubbership - physics.MS_PER_TICK)\n      \n      if (!ship.latched) {\n        physics.gravityShip(ship, physics.getPlanets(ship.posX, ship.posY))\n      }\n    }\n  }\n\n  const premoveShips = (delta) => {\n    for (const ship of ships.values()) {\n      ship.posXnew = ship.posX + delta * ship.velX\n      ship.posYnew = ship.posY + delta * ship.velY\n    }\n  }\n\n  const moveShips = (delta, powerups) => {\n    const powerupList = powerups.getPowerups()\n    const powerupCount = powerupList.length\n    const dist = physics.ACTUAL_MAX_SHIP_VELOCITY + 1\n\n    for (const ship1 of ships.values()) {\n      for (let j = 0; j < powerupCount; ++j) {\n        const pup = powerupList[j]\n        if (Math.abs(ship1.posX - pup.posX) < 3\n          && Math.abs(ship1.posY - pup.posY) < 3) {\n          const t = geom.lineIntersectCircleFirstDepth(\n            [ship1.posX, ship1.posY],\n            [ship1.posXnew, ship1.posYnew],\n            pup.posX, pup.posY, pup.pickupRadius)\n          if (0 <= t && t <= 1) {\n            powerups.updateClosestPlayer(pup, ship1, t)\n          }\n        }\n      }\n\n      for (const ship2 of ships.values()) {\n        if (ship1 === ship2 || ship1.dead || ship2.dead) {\n          continue\n        }\n\n        if (Math.abs(ship1.posX - ship2.posX) < dist &&\n          Math.abs(ship1.posY - ship2.posY) < dist) {\n          const t = geom.closestSynchroDistance(\n            [ship1.posX, ship1.posY],\n            [ship1.posXnew, ship1.posYnew],\n            [ship2.posX, ship2.posY],\n            [ship2.posXnew, ship2.posYnew])\n          if (0 <= t && t <= 1) {\n            ship1.posX = geom.lerp1D(ship1.posX, t, ship1.posXnew)\n            ship1.posY = geom.lerp1D(ship1.posY, t, ship1.posYnew)\n            ship2.posX = geom.lerp1D(ship2.posX, t, ship2.posXnew)\n            ship2.posY = geom.lerp1D(ship2.posY, t, ship2.posYnew)\n            testShipShipCollision(ship1, ship2)\n          }\n        }\n      }\n\n      const planets = physics.getPlanets(ship1.posX, ship1.posY)\n      for (let j = 0; j < planets.length; ++j)  {\n        const planet = planets[j]\n        const search = planet.radius + SHIP_RADIUS\n        const searchSquare = search ** 2;\n        [ship1.posX, ship1.posY] = geom.lineClosestPointToPoint(\n          ship1.posX, ship1.posY, ship1.posXnew, ship1.posYnew,\n          planet.x, planet.y\n        )\n\n        if (Math.abs(ship1.posX - planet.x) < search \n          && Math.abs(ship1.posY - planet.y) < search) {\n          if (maths.squarePair(ship1.posX - planet.x, ship1.posY - planet.y) \n            < searchSquare) {\n            if (!ship1.dead) {\n              handleShipPlanetCollision(ship1, planet)\n            }\n            break\n          }\n        }\n      }\n    }\n\n    for (const ship of ships.values()) {\n      ship.posX = ship.posXnew\n      ship.posY = ship.posYnew\n    }\n  }\n\n  const handleShipShipCollision = (ship1, ship2) => {\n    const now = chron.timeMs()\n    const dx = ship1.velX - ship2.velX\n    const dy = ship1.velY - ship2.velY\n    const damage = 5 * (Math.hypot(dx, dy) ** 0.25)\n      / physics.ACTUAL_MAX_SHIP_VELOCITY\n    const dmg1 = damage * (physics.hasRubbership(ship1) ? 0 : 1)\n    const dmg2 = damage * (physics.hasRubbership(ship2) ? 0 : 1)\n\n    if (dmg1 >= 0.1) {\n      ship1.health -= dmg1 * ship1.healthMul\n      ship1.lastDamageAt = now\n      ship1.lastDamageBy = ship2._id\n    }\n\n    if (dmg2 >= 0.1) {\n      ship2.health -= dmg2 * ship2.healthMul\n      ship2.lastDamageAt = now\n      ship2.lastDamageBy = ship1._id  \n    }\n\n    if (physics.hasRubbership(ship1) && physics.hasRubbership(ship2)) {\n      ship1.accel = null\n      ship2.accel = null\n    }\n\n    // elastic collision\n    [ship1.velX, ship2.velX] = [ship2.velX, ship1.velX];\n    [ship1.velY, ship2.velY] = [ship2.velY, ship1.velY]\n    \n    if (ship1.health <= 0) {\n      if (ship2.health > 0) {\n        ++ship2.score\n      }\n      handler.onShipKilledByCrash(ship1, ship2)\n      killShip(ship1)\n    }\n\n    if (ship2.health <= 0) {\n      if (ship1.health > 0) {\n        ++ship1.score\n      }\n      handler.onShipKilledByCrash(ship2, ship1)\n      killShip(ship2)\n    }\n  }\n\n  const testShipShipCollision = (ship1, ship2) => {\n    if (Math.abs(ship1.posX - ship2.posX) < SHIP_RECT_RADIUS &&\n        Math.abs(ship1.posY - ship2.posY) < SHIP_RECT_RADIUS) {\n      const [p1, p2, p3] = geom.getCollisionPoints(ship1)\n      const [q1, q2,   , q4] = geom.getShipPoints(ship2)\n      if (geom.testTriangleCollision(p1, p2, p3, q1, q2, q4)) {\n        handleShipShipCollision(ship1, ship2)\n      }\n    }\n  }\n\n  const handleShipPlanetCollision = (ship, planet) => {\n    const v = Math.hypot(ship.velX, ship.velY)\n    let dist = Math.hypot(planet.x - ship.posX, planet.y - ship.posY)\n    const d = 1 - (dist / (planet.radius - 1))\n    const col_mul = geom.getPlanetDamageMultiplier(\n      Math.sin(-ship.orient), Math.cos(-ship.orient),\n      ship.posX - planet.x, ship.posY - planet.y)\n    if (!col_mul) return\n    const col_vmul = geom.getPlanetDamageSpeedMultiplier(ship.velX, ship.velY,\n      ship.posX - planet.x, ship.posY - planet.y)\n    let damage = Math.max(v * col_mul * col_vmul, d) / physics.MAX_SHIP_VELOCITY * ship.planetDamageMul \n      * (physics.hasRubbership(ship) ? 0 : 1)\n\n    if (!ship.accel \n      && v > 0 \n      && v * col_mul < physics.LATCH_VELOCITY * (ship.brake !== null ? 1.75 : 1)) {\n      latchToPlanet(ship, planet)\n      return\n    }\n\n    if (col_mul < 0.2 && ship.accel !== null) {\n      damage *= 0.2\n    }\n\n    let offx = ship.posX - planet.x\n    let offy = ship.posY - planet.y;\n    [offx, offy] = geom.normalize(offx, offy)\n    const radius = planet.radius + SHIP_RADIUS\n\n    ship.posX = planet.x + offx * (radius + 0.5)\n    ship.posY = planet.y + offy * (radius + 0.5)\n\n    ship.velX = -ship.velX + offx * v * 2\n    ship.velY = -ship.velY + offy * v * 2\n    if (v > 0)\n      ([ship.velX, ship.velY] = geom.normalize(ship.velX, ship.velY, v))\n\n    if (damage >= 0.05) {\n      damageShip(ship, damage, null, null, (ship) => {\n        if (ship.lastDamageAt && chron.timeMs() - ship.lastDamageAt < 2500) {\n          const by = getShipById(ship.lastDamageBy)\n          if (by) ++by.score\n        }\n        handler.onShipKilledByPlanet(ship)\n        killShip(ship)\n      })\n    }\n\n    if (ship.dead) {\n      return\n    }\n  \n    dist = Math.hypot(planet.x - ship.posX, planet.y - ship.posY)\n    if (dist < planet.radius - 0.05)\n      latchToPlanet(ship, planet)\n\n    /*if (!physics.hasRubbership(ship) && damage < 0.4 && col_mul < 1.7) {\n      latchToPlanet(ship, planet)\n    }*/\n  }\n\n  const deleteShip = (ship) => {\n    ship.dead = true\n    ships.delete(ship._id)\n  }\n\n  const damageShip = (ship, damage, bullet, shooter, onDeath) => {\n    if (ship.dead) return\n    ship.health -= damage * ship.healthMul\n    if (shooter) {\n      ship.lastDamageAt = chron.timeMs()\n      ship.lastDamageBy = shooter._id\n    }\n    if (ship.health <= 0) {\n      if (shooter) {\n        ++shooter.score\n      }\n      ship.dead = true\n      onDeath(ship, bullet)\n    }\n  }\n\n  const killShip = (ship) => {\n    deleteShip(ship)\n    handler.onShipKilled(ship)\n  }\n\n  return {\n    getShips,\n    iterateShips,\n    getShipById,\n    getShipCount,\n    damageShip,\n    newPlayerShip,\n    premoveShips,\n    moveShips,\n    killShip,\n    deleteShip,\n    shipAcceleration\n  }\n}\n\nmodule.exports = {\n  system: shipSystemFactory,\n  FIELDS,\n  FIELDS_SHORT,\n}\n","const timeMs = () => new Date().getTime()\n\nmodule.exports = { timeMs }\n","class Counter {\n  constructor() {\n    this.counter = BigInt(0)\n  }\n\n  next() {\n    const val = this.counter.toString(36).padStart(10, '0')\n    this.counter = BigInt.asUintN(64, this.counter + BigInt(1))\n    return '#' + val\n  }\n}\n\nmodule.exports = Counter\n","\nconst filterInplace = (list, fn) => {\n  let i, j = 0\n  for (i = 0; i < list.length; ++i) {\n    if (fn(list[i])) list[j++] = list[i]\n  }\n  list.length = j\n}\n\nmodule.exports = {\n  filterInplace\n}\n","const maths = require('../utils/maths')\n\nconst SHIP_SCALE = 1.1\nconst clamp = maths.clamp\n\nconst lerp1D = (a, t, b) => a + t * (b - a)\nconst unlerp1D = (a, v, b) => (v - a) / (b - a)\nconst lerp2D = (a, t, b) => [lerp1D(a[0], t, b[0]), lerp1D(a[1], t, b[1])]\n\nconst dot2D = (v1, v2) => v1[0] * v2[0] + v1[1] * v2[1]\nconst dot2Dxy = (x1, y1, x2, y2) => x1 * y1 + x2 * y2\n\nconst normalize = (x, y, m) => {\n  const d = Math.hypot(x, y)\n  m = m || 1\n  return [m * x / d, m * y / d]\n}\n\nconst pointInTriangle = (p1, p2, p3, p) => {\n  const [x1, y1] = p1\n  const [x2, y2] = p2\n  const [x3, y3] = p3\n  const [xp, yp] = p\n\n  const c1 = ((y2 - y3) * (xp - x3) + (x3 - x2) * (yp - y3)) \n           / ((y2 - y3) * (x1 - x3) + (x3 - x2) * (y1 - y3))\n  const c2 = ((y3 - y1) * (xp - x3) + (x1 - x3) * (yp - y3)) \n           / ((y2 - y3) * (x1 - x3) + (x3 - x2) * (y1 - y3))\n  const c3 = 1 - c1 - c2\n  return c1 > 0 && c2 > 0 && c3 > 0\n}\n\nconst testTriangleCollisionSub = (a1, a2, a3, b1, b2, b3) => {\n  const dax = a1[0] - b3[0], day = a1[1] - b3[1]\n  const dbx = a2[0] - b3[0], dby = a2[1] - b3[1]\n  const dcx = a3[0] - b3[0], dcy = a3[1] - b3[1]\n  const b32x = b3[0] - b2[0]\n  const b23y = b2[1] - b3[1]\n  const D = b23y * (b1[0] - b3[0]) + b32x * (b1[1] - b3[1])\n  const sa = b23y * dax + b32x * day\n  const sb = b23y * dbx + b32x * dby\n  const sc = b23y * dcx + b32x * dcy\n  const ta = (b3[1] - b1[1]) * dax + (b1[0] - b3[0]) * day\n  const tb = (b3[1] - b1[1]) * dbx + (b1[0] - b3[0]) * dby\n  const tc = (b3[1] - b1[1]) * dcx + (b1[0] - b3[0]) * dcy\n  if (D < 0) return ((sa >= 0 && sb >= 0 && sc >= 0) ||\n                     (ta >= 0 && tb >= 0 && tc >= 0) ||\n                     (sa + ta <= D && sb + tb <= D && sc + tc <= D))\n  return ((sa <= 0 && sb <= 0 && sc <= 0) ||\n          (ta <= 0 && tb <= 0 && tc <= 0) ||\n          (sa + ta >= D && sb + tb >= D && sc + tc >= D))\n}\n\nconst testTriangleCollision = (a1, a2, a3, b1, b2, b3) => {\n  return !(testTriangleCollisionSub(a1, a2, a3, b1, b2, b3)\n        || testTriangleCollisionSub(b1, b2, b3, a1, a2, a3))\n}\n\nconst getDirectionSign = (a, b) => {\n  let s = Math.sign(b[0] - a[0])\n  if (s == 0) {\n    s = Math.sign(b[1] - a[1])\n  }\n  return s\n}\n\nconst collinearLinesIntersect = (a1, a2, b1, b2) => {\n  let a = 0\n  let b = ((a2[0] - a1[0]) * (a2[0] - a1[0]) \n    + (a2[1] - a1[1]) * (a2[1] - a1[1])) * getDirectionSign(a2, a1)\n  let c = ((b1[0] - a1[0]) * (b1[0] - a1[0]) \n    + (b1[1] - a1[1]) * (b1[1] - a1[1])) * getDirectionSign(b1, a1)\n  let d = ((b2[0] - a1[0]) * (b2[0] - a1[0]) \n    + (b2[1] - a1[1]) * (b2[1] - a1[1])) * getDirectionSign(b2, a1)\n  \n  if (a >= b) [a, b] = [b, a]\n  if (c >= d) [c, d] = [d, c]\n  \n  return b >= c && d >= a\n}\n\nconst lineIntersectsLine = (a1, a2, b1, b2) => {\n  const d = 1 / \n    (((a2[0] - a1[0]) * (b2[1] - b1[1])) \n    - ((a2[1] - a1[1]) * (b2[0] - b1[0])))\n  if (!isFinite(d)) { // collinear\n    return collinearLinesIntersect(a1, a2, b1, b2)\n  }\n\n  const n = d * \n    (((a1[1] - b1[1]) * (b2[0] - b1[0])) \n    - ((a1[0] - b1[0]) * (b2[1] - b1[1])))\n  const m = d * \n    (((a1[1] - b1[1]) * (a2[0] - a1[0])) \n    - ((a1[0] - b1[0]) * (a2[1] - a1[1])))\n\n  return 0 <= n && n <= 1 && 0 <= m && m <= 1\n}\n\nconst lineIntersectsTriangle = (l1, l2, t1, t2, t3) => {\n  return lineIntersectsLine(l1, l2, t1, t2)\n      || lineIntersectsLine(l1, l2, t2, t3)\n      || lineIntersectsLine(l1, l2, t3, t1)\n}\n\n/*\nconst lerp1D = (a, t, b) => a + t * (b - a)\nconst lerp2D = (a, t, b) => [lerp1D(a[0], t, b[0]), lerp1D(a[1], t, b[1])]\nconst clamp = (a, x, b) => Math.max(a, Math.min(x, b))\n*/\n\nconst lineClosestDistanceToLine = (a1, a2, b1, b2) => {\n  if (lineIntersectsLine(a1, a2, b1, b2))\n    return 0\n\n  const [rx, ry] = [b1[0] - a1[0], b1[1] - a1[1]]\n  const [ux, uy] = [a2[0] - a1[0], b1[1] - a1[1]]\n  const [vx, vy] = [b2[0] - b1[0], b2[1] - b1[1]]\n\n  const ru = rx * ux + ry * uy\n  const rv = rx * vx + ry * vy\n  const uu = ux * ux + uy * uy\n  const uv = ux * vx + uy * vy\n  const vv = vx * vx + vy * vy\n\n  const det = uu * vv - uv * uv\n  let s0, t0\n\n  if (det < 1e-8) {\n    s0 = clamp(0, ru / uu, 1)\n    t0 = 0\n  } else {\n    s0 = clamp(0, (ru * vv - rv * uv) / det, 1)\n    t0 = clamp(0, (ru * uv - rv * uu) / det, 1)\n  }\n\n  const s1 = clamp(0, (t0 * uv + ru) / uu, 1)\n  const t1 = clamp(0, (s0 * uv - rv) / vv, 1)\n  \n  const as = lerp2D(a1, s1, a2)\n  const bt = lerp2D(b1, t1, b2)\n\n  return Math.hypot(as[0] - bt[0], as[1] - bt[1])\n}\n\nconst pointClosestDistanceToLine = (p1, l1, l2) => {\n  const p2 = lineClosestPointToPoint(l1[0], l1[1], l2[0], l2[1], p1[0], p1[1])\n  return Math.hypot(p1[0] - p2[0], p1[1] - p2[1])\n}\n\nconst pointClosestDistanceToTriangle = (p, t1, t2, t3) => {\n  return Math.min(pointClosestDistanceToLine(p, t1, t2),\n    pointClosestDistanceToLine(p, t2, t3),\n    pointClosestDistanceToLine(p, t3, t1))\n}\n\nconst lineClosestDistanceToTriangle = (l1, l2, t1, t2, t3) => {\n  if (pointInTriangle(t1, t2, t3, l1)\n      || pointInTriangle(t1, t2, t3, l2)) {\n    return 0\n  }\n  if (l1[0] === l2[0] && l1[1] === l2[1]) {\n    return pointClosestDistanceToTriangle(l1, t1, t2, t3)\n  }\n  return Math.min(lineClosestDistanceToLine(l1, l2, t1, t2),\n    lineClosestDistanceToLine(l1, l2, t2, t3),\n    lineClosestDistanceToLine(l1, l2, t3, t1))\n}\n\nconst lineIntersectCircleFirstDepth = (a1, a2, x, y, radius) => {\n  for (let i = 0; i <= 8; ++i) {\n    const s = i / 8\n    if (Math.hypot(a1[0] + s * a2[0] - x, a1[1] + s * a2[1] - y) < radius) {\n      return s\n    }\n  }\n  return Number.NaN\n}\n\nconst lineClosestPointToPoint = (ax, ay, bx, by, px, py) => {\n  const v1 = bx - ax\n  const v2 = by - ay\n  const u1 = ax - px\n  const u2 = ay - py\n  const vu = v1 * u1 + v2 * u2\n  const vv = v1 * v1 + v2 * v2\n  if (vv === 0) return [ax, ay]\n  let t = -vu / vv\n  if (t < 0) t = 0\n  if (t > 1) t = 1\n  return lerp2D([ax, ay], t, [bx, by])\n}\n\nconst closestSynchroDistance = (a1, a2, b1, b2) => {\n  const A = a1[0] - b1[0]\n  const B = (a2[0] - a1[0]) - (b2[0] - b1[0])\n  const C = a1[1] - b1[1]\n  const D = (a2[1] - a1[1]) - (b2[1] - b1[1])\n  if (B == 0 && D == 0) {\n    return 0\n  }\n  return -(A * B + C * D) / (B * B + D * D)\n}\n\nconst wrapRadianAngle = (angle) => {\n  return (angle + Math.PI) % (2 * Math.PI) - Math.PI\n}\n\nconst getPlanetDamageMultiplier = (ox, oy, px, py) => {\n  [ox, oy] = normalize(ox, oy);\n  [px, py] = normalize(px, py)\n  return maths.padFromBelow(0.5, (1 - (ox * px + oy * py)) * 0.5)\n}\n\nconst getPlanetDamageSpeedMultiplier = (vx, vy, px, py) => {\n  if (!(vx || vy)) return 0;\n  [vx, vy] = normalize(vx, vy);\n  [px, py] = normalize(px, py)\n  return maths.padFromBelow(0.5, Math.abs(vx * px + vy * py))\n}\n\nconst withinBoundingSquare = (x, y, center, d) => {\n  return Math.min(Math.abs(x - center), Math.abs(y - center)) <= d\n}\n\nconst rotatePoint = (s, c, x, y) => [x * c - y * s, x * s + y * c]\n\nconst rotatePointOffset = (s, c, x, y, xo, yo) => \n  [xo + x * c - y * s, yo + x * s + y * c]\n\nconst getShipPoints = (ship) => {\n  const S = SHIP_SCALE\n  if (!ship) {\n    return []\n  }\n\n  const s = Math.sin(ship.orient)\n  const c = Math.cos(ship.orient)\n\n  return [\n    rotatePointOffset(s, c,  0     , +2   *S, ship.posX, ship.posY),\n    rotatePointOffset(s, c, +1.5 *S, -2   *S, ship.posX, ship.posY),\n    rotatePointOffset(s, c,  0     , -1.25*S, ship.posX, ship.posY),\n    rotatePointOffset(s, c, -1.5 *S, -2   *S, ship.posX, ship.posY)\n  ]\n}\n\nconst getCollisionPoints = (ship) => {\n  const S = SHIP_SCALE\n  if (!ship) {\n    return []\n  }\n\n  const s = Math.sin(ship.orient)\n  const c = Math.cos(ship.orient)\n  \n  return [\n    rotatePointOffset(s, c,  0      , +2.5*S, ship.posX, ship.posY),\n    rotatePointOffset(s, c, +1.625*S, -2.5*S, ship.posX, ship.posY),\n    rotatePointOffset(s, c, -1.625*S, -2.5*S, ship.posX, ship.posY)\n  ]\n}\n\nconst getThrusterPoints = (ship) => {\n  const S = SHIP_SCALE\n  if (!ship) {\n    return []\n  }\n\n  const s = Math.sin(ship.orient)\n  const c = Math.cos(ship.orient)\n\n  return [\n    rotatePointOffset(s, c,  0   *S, -1.25*S, ship.posX, ship.posY),\n    rotatePointOffset(s, c, +0.75*S, -1.75*S, ship.posX, ship.posY),\n    rotatePointOffset(s, c,  0   *S, -3.75*S, ship.posX, ship.posY),\n    rotatePointOffset(s, c, -0.75*S, -1.75*S, ship.posX, ship.posY),\n    rotatePointOffset(s, c,  0   *S, -2.75*S, ship.posX, ship.posY),\n  ]\n}\n\nmodule.exports = {\n  lerp1D,\n  lerp2D,\n  unlerp1D,\n  dot2D,\n  dot2Dxy,\n  normalize,\n  pointInTriangle,\n  rotatePoint,\n  testTriangleCollision,\n  lineIntersectsLine,\n  lineIntersectCircleFirstDepth,\n  lineClosestPointToPoint,\n  closestSynchroDistance,\n  lineIntersectsTriangle,\n  lineClosestDistanceToLine,\n  lineClosestDistanceToTriangle,\n  wrapRadianAngle,\n  withinBoundingSquare,\n  getPlanetDamageMultiplier,\n  getPlanetDamageSpeedMultiplier,\n  getShipPoints,\n  getCollisionPoints,\n  getThrusterPoints }\n","const LCG_A = 535426113\nconst LCG_C = 2258250855\nconst SC = 2.0 ** -30\n\nclass Generator {\n  constructor(seed) {\n    this.seed = seed & 0xFFFFFFFF\n  }\n\n  reseed(seed) {\n    this.seed = seed & 0xFFFFFFFF\n  }\n\n  randomInt() {\n    const val = this.seed\n    this.seed = (LCG_A * val + LCG_C) & 0xFFFFFFFF\n    return val\n  }\n\n  random() {\n    return (this.randomInt() & 0x3FFFFFFF) * SC\n  }\n\n  randomOffset() {\n    return 2 * this.random() - 1\n  }\n\n  randomSign() {\n    return 2 * (this.randomInt() & 1) - 1\n  }\n}\n\nmodule.exports = Generator\n","\nconst randomSign = () => {\n  return 2 * ((2 * Math.random()) | 0) - 1\n}\n\nconst squarePair = (x, y) => x ** 2 + y ** 2\n\nconst padFromBelow = (p, v) => p + (1 - p) * v\n\nconst clamp = (a, x, b) => Math.max(a, Math.min(x, b))\n\nmodule.exports = {\n  randomSign,\n  squarePair,\n  padFromBelow,\n  clamp }\n","const msgpackr = require('msgpackr')\n\nconst moduleShip = require('../game/ship')\nconst moduleBullet = require('../game/bullet')\nconst modulePowerup = require('../game/powerup')\n\nconst serializeFrom = (object, fields) => fields.map(field => object[field])\nconst deserializeFrom = (array, fields) => {\n  const object = {}\n  for (let i = 0; i < array.length; ++i) {\n    object[fields[i]] = array[i]\n  }\n  return object\n}\n\nconst serializeShip = (obj) => serializeFrom(obj, moduleShip.FIELDS)\nconst serializeShipShort = (obj) => serializeFrom(obj, moduleShip.FIELDS_SHORT)\nconst deserializeShip = (arr) => deserializeFrom(arr, moduleShip.FIELDS)\n\nconst serializeBullet = (obj) => serializeFrom(obj, moduleBullet.FIELDS)\nconst serializeBulletShort = (obj) => serializeFrom(obj, moduleBullet.FIELDS_SHORT)\nconst deserializeBullet = (arr) => deserializeFrom(arr, moduleBullet.FIELDS)\n\nconst serializePowerup = (obj) => serializeFrom(obj, modulePowerup.FIELDS)\nconst deserializePowerup = (arr) => deserializeFrom(arr, modulePowerup.FIELDS)\n\n/*const encode = (data) => pson.encode(data)\nconst decode = (data) => pson.decode(data)\nconst recv = (data) => ByteBuffer.wrap(data)\nconst send = (ws, data) => ws.send(data.buffer)*/\n\n/*\nconst encode = (data) => JSON.stringify(data)\nconst decode = (data) => JSON.parse(data)\nconst recv = (data) => data\nconst send = (ws, data) => ws.send(data)\n*/\n\nconst C_ping = 0\nconst C_join = 1\nconst C_ctrl = 2\nconst C_quit = 3\nconst C_useitem = 4\n\nconst C_pong = 128\nconst C_token = 129\nconst C_data = 130\nconst C_board = 131\nconst C_killship = 132\nconst C_orient = 133\nconst C_unauth = 134\nconst C_addpup = 135\nconst C_delpup = 136\nconst C_minexpl = 137\nconst C_deathk = 138\nconst C_deathc = 139\nconst C_deathp = 140\nconst C_addpups = 141\n\nconst C_crashed = 192\nconst C_killed = 193\nconst C_hitpl = 194\n\nconst encode = (cmd, data) => {\n  return msgpackr.pack([cmd, ...messageKeys[cmd].map(key => data[key])])\n}\n\nconst decode = (data) => {\n  const array = msgpackr.unpack(data)\n  const cmd = array[0]\n  return [ cmd, Object.fromEntries(messageKeys[cmd].map((key, index) => [key, array[index + 1]])) ]\n}\n\nconst recv = (data) => data\nconst send = (ws, data) => ws.send(data)\n\nconst messageKeys = {\n  [C_token]: ['token'],\n  [C_data]: ['you', 'ships', 'bullets', 'newBullets', 'count', 'rubber', 'seed'],\n  [C_unauth]: [],\n  [C_board]: ['board'],\n  [C_killship]: ['ship'],\n  [C_crashed]: ['ship'],\n  [C_killed]: ['ship'],\n  [C_orient]: ['orient'],\n  [C_hitpl]: [],\n  [C_join]: ['nick', 'perk'],\n  [C_ping]: ['time'],\n  [C_pong]: ['time'],\n  [C_quit]: ['token'],\n  [C_ctrl]: ['token', 'orient', 'accel', 'brake', 'firing'],\n  [C_addpup]: ['powerup'],\n  [C_delpup]: ['powerup'],\n  [C_useitem]: ['token'],\n  [C_minexpl]: ['proj'],\n  [C_deathk]: ['ship', 'by'],\n  [C_deathc]: ['ship', 'by'],\n  [C_deathp]: ['ship'],\n  [C_addpups]: ['powerups'],\n}\n\n// token: string\nconst e_token = (token) => encode(C_token, { token })\n// you: Ship, ship:s Ship[], bullets: Bullet[], newBullets: Bullet[]\n// count: number, rubber: number, seed: number\nconst e_data = (you, ships, bullets, newBullets, count, rubber, seed) => \n  encode(C_data, { you: serializeShip(you),\n    ships: ships.map(serializeShipShort),\n    bullets: bullets.map(serializeBulletShort),\n    newBullets: newBullets.map(serializeBullet),\n    count, rubber, seed })\nconst e_unauth = () => encode(C_unauth)\n// board: [[name, score], ...]\nconst e_board = (board) => encode(C_board, { board })\n// ship: ship\nconst e_killship = (ship) => encode(C_killship, { ship: serializeShip(ship) })\n// name: string (name)\nconst e_crashed = (ship) => encode(C_crashed, { ship })\n// name: string (name)\nconst e_killed = (ship) => encode(C_killed, { ship })\n// orient: number\nconst e_orient = (orient) => encode(C_orient, { orient })\nconst e_hitpl = () => encode(C_hitpl)\n// join: string, perk: string\nconst e_join = (nick, perk) => encode(C_join, { nick, perk })\n// time: number\nconst e_ping = (time) => encode(C_ping, { time })\n// time: number\nconst e_pong = (time) => encode(C_pong, { time })\n// token: string\nconst e_quit = (token) => encode(C_quit, { token })\n// token: string, orient: number, accel: boolean, brake: boolean, firing: boolean\nconst e_ctrl = (token, orient, accel, brake, firing) => encode(C_ctrl, {\n  token, orient, accel, brake, firing })\n// powerup: Powerup\nconst e_addpup = (powerup) => encode(C_addpup, { powerup: serializePowerup(powerup) })\n// powerup: (ID) string\nconst e_delpup = (powerup) => encode(C_delpup, { powerup })\n// token: string\nconst e_useitem = (token) => encode(C_useitem, { token })\n// proj: Bullet\nconst e_minexpl = (proj) => encode(C_minexpl, { proj: serializeBullet(proj) })\n// ship: string, by: string\nconst e_deathk = (ship, by) => encode(C_deathk, { ship, by })\n// ship: string, by: string\nconst e_deathc = (ship, by) => encode(C_deathc, { ship, by })\n// ship: string, by: string\nconst e_deathp = (ship) => encode(C_deathp, { ship })\n// powerups: Powerup[]\nconst e_addpups = (powerups) => encode(C_addpups, { powerups: powerups.map(serializePowerup) })\n\nmodule.exports = {\n  encode,\n  decode,\n  recv,\n  send,\n\n  e_token,\n  e_data,\n  e_unauth,\n  e_board,\n  e_killship,\n  e_crashed,\n  e_killed,\n  e_orient,\n  e_hitpl,\n  e_join,\n  e_ping,\n  e_pong,\n  e_ctrl,\n  e_quit,\n  e_addpup,\n  e_delpup,\n  e_useitem,\n  e_minexpl,\n  e_deathk,\n  e_deathc,\n  e_deathp,\n  e_addpups,\n\n  C_ctrl,\n  C_join,\n  C_ping,\n  C_pong,\n  C_quit,\n  C_token,\n  C_data,\n  C_board,\n  C_killship,\n  C_crashed,\n  C_killed,\n  C_hitpl,\n  C_orient,\n  C_unauth,\n  C_addpup,\n  C_delpup,\n  C_useitem,\n  C_minexpl,\n  C_deathk,\n  C_deathc,\n  C_deathp,\n  C_addpups,\n\n  serializeFrom,\n  deserializeFrom,\n\n  deserializeShip,\n  deserializeBullet,\n  deserializePowerup\n}\n","export { Packr, Encoder, addExtension, pack, encode, NEVER, ALWAYS, DECIMAL_ROUND, DECIMAL_FIT, REUSE_BUFFER_MODE } from './pack.js'\r\nexport { Unpackr, Decoder, C1, unpack, unpackMultiple, decode, FLOAT32_OPTIONS, clearSource, roundFloat32, isNativeAccelerationEnabled } from './unpack.js'\r\nexport { decodeIter, encodeIter } from './iterators.js'\r\nexport const useRecords = false\r\nexport const mapsAsObjects = true\r\n","import { Packr } from './pack.js'\r\nimport { Unpackr } from './unpack.js'\r\n\r\n/**\r\n * Given an Iterable first argument, returns an Iterable where each value is packed as a Buffer\r\n * If the argument is only Async Iterable, the return value will be an Async Iterable.\r\n * @param {Iterable|Iterator|AsyncIterable|AsyncIterator} objectIterator - iterable source, like a Readable object stream, an array, Set, or custom object\r\n * @param {options} [options] - msgpackr pack options\r\n * @returns {IterableIterator|Promise.<AsyncIterableIterator>}\r\n */\r\nexport function packIter (objectIterator, options = {}) {\r\n  if (!objectIterator || typeof objectIterator !== 'object') {\r\n    throw new Error('first argument must be an Iterable, Async Iterable, or a Promise for an Async Iterable')\r\n  } else if (typeof objectIterator[Symbol.iterator] === 'function') {\r\n    return packIterSync(objectIterator, options)\r\n  } else if (typeof objectIterator.then === 'function' || typeof objectIterator[Symbol.asyncIterator] === 'function') {\r\n    return packIterAsync(objectIterator, options)\r\n  } else {\r\n    throw new Error('first argument must be an Iterable, Async Iterable, Iterator, Async Iterator, or a Promise')\r\n  }\r\n}\r\n\r\nfunction * packIterSync (objectIterator, options) {\r\n  const packr = new Packr(options)\r\n  for (const value of objectIterator) {\r\n    yield packr.pack(value)\r\n  }\r\n}\r\n\r\nasync function * packIterAsync (objectIterator, options) {\r\n  const packr = new Packr(options)\r\n  for await (const value of objectIterator) {\r\n    yield packr.pack(value)\r\n  }\r\n}\r\n\r\n/**\r\n * Given an Iterable/Iterator input which yields buffers, returns an IterableIterator which yields sync decoded objects\r\n * Or, given an Async Iterable/Iterator which yields promises resolving in buffers, returns an AsyncIterableIterator.\r\n * @param {Iterable|Iterator|AsyncIterable|AsyncIterableIterator} bufferIterator\r\n * @param {object} [options] - unpackr options\r\n * @returns {IterableIterator|Promise.<AsyncIterableIterator}\r\n */\r\nexport function unpackIter (bufferIterator, options = {}) {\r\n  if (!bufferIterator || typeof bufferIterator !== 'object') {\r\n    throw new Error('first argument must be an Iterable, Async Iterable, Iterator, Async Iterator, or a promise')\r\n  }\r\n\r\n  const unpackr = new Unpackr(options)\r\n  let incomplete\r\n  const parser = (chunk) => {\r\n    let yields\r\n    // if there's incomplete data from previous chunk, concatinate and try again\r\n    if (incomplete) {\r\n      chunk = Buffer.concat([incomplete, chunk])\r\n      incomplete = undefined\r\n    }\r\n\r\n    try {\r\n      yields = unpackr.unpackMultiple(chunk)\r\n    } catch (err) {\r\n      if (err.incomplete) {\r\n        incomplete = chunk.slice(err.lastPosition)\r\n        yields = err.values\r\n      } else {\r\n        throw err\r\n      }\r\n    }\r\n    return yields\r\n  }\r\n\r\n  if (typeof bufferIterator[Symbol.iterator] === 'function') {\r\n    return (function * iter () {\r\n      for (const value of bufferIterator) {\r\n        yield * parser(value)\r\n      }\r\n    })()\r\n  } else if (typeof bufferIterator[Symbol.asyncIterator] === 'function') {\r\n    return (async function * iter () {\r\n      for await (const value of bufferIterator) {\r\n        yield * parser(value)\r\n      }\r\n    })()\r\n  }\r\n}\r\nexport const decodeIter = unpackIter\r\nexport const encodeIter = packIter","\"use strict\"\r\nimport { Unpackr, mult10, C1Type, typedArrays, addExtension as unpackAddExtension } from './unpack.js'\r\nlet textEncoder\r\ntry {\r\n\ttextEncoder = new TextEncoder()\r\n} catch (error) {}\r\nlet extensions, extensionClasses\r\nconst hasNodeBuffer = typeof Buffer !== 'undefined'\r\nconst ByteArrayAllocate = hasNodeBuffer ? Buffer.allocUnsafeSlow : Uint8Array\r\nconst ByteArray = hasNodeBuffer ? Buffer : Uint8Array\r\nconst MAX_BUFFER_SIZE = hasNodeBuffer ? 0x100000000 : 0x7fd00000\r\nlet target, keysTarget\r\nlet targetView\r\nlet position = 0\r\nlet safeEnd\r\nlet bundledStrings = null\r\nconst MAX_BUNDLE_SIZE = 0xf000\r\nconst hasNonLatin = /[\\u0080-\\uFFFF]/\r\nconst RECORD_SYMBOL = Symbol('record-id')\r\nexport class Packr extends Unpackr {\r\n\tconstructor(options) {\r\n\t\tsuper(options)\r\n\t\tthis.offset = 0\r\n\t\tlet typeBuffer\r\n\t\tlet start\r\n\t\tlet hasSharedUpdate\r\n\t\tlet structures\r\n\t\tlet referenceMap\r\n\t\tlet lastSharedStructuresLength = 0\r\n\t\tlet encodeUtf8 = ByteArray.prototype.utf8Write ? function(string, position, maxBytes) {\r\n\t\t\treturn target.utf8Write(string, position, maxBytes)\r\n\t\t} : (textEncoder && textEncoder.encodeInto) ?\r\n\t\t\tfunction(string, position) {\r\n\t\t\t\treturn textEncoder.encodeInto(string, target.subarray(position)).written\r\n\t\t\t} : false\r\n\r\n\t\tlet packr = this\r\n\t\tif (!options)\r\n\t\t\toptions = {}\r\n\t\tlet isSequential = options && options.sequential\r\n\t\tlet hasSharedStructures = options.structures || options.saveStructures\r\n\t\tlet maxSharedStructures = options.maxSharedStructures\r\n\t\tif (maxSharedStructures == null)\r\n\t\t\tmaxSharedStructures = hasSharedStructures ? 32 : 0\r\n\t\tif (maxSharedStructures > 8160)\r\n\t\t\tthrow new Error('Maximum maxSharedStructure is 8160')\r\n\t\tif (options.structuredClone && options.moreTypes == undefined) {\r\n\t\t\toptions.moreTypes = true\r\n\t\t}\r\n\t\tlet maxOwnStructures = options.maxOwnStructures\r\n\t\tif (maxOwnStructures == null)\r\n\t\t\tmaxOwnStructures = hasSharedStructures ? 32 : 64\r\n\t\tif (!this.structures && options.useRecords != false)\r\n\t\t\tthis.structures = []\r\n\t\t// two byte record ids for shared structures\r\n\t\tlet useTwoByteRecords = maxSharedStructures > 32 || (maxOwnStructures + maxSharedStructures > 64)\t\t\r\n\t\tlet sharedLimitId = maxSharedStructures + 0x40\r\n\t\tlet maxStructureId = maxSharedStructures + maxOwnStructures + 0x40\r\n\t\tif (maxStructureId > 8256) {\r\n\t\t\tthrow new Error('Maximum maxSharedStructure + maxOwnStructure is 8192')\r\n\t\t}\r\n\t\tlet recordIdsToRemove = []\r\n\t\tlet transitionsCount = 0\r\n\t\tlet serializationsSinceTransitionRebuild = 0\r\n\r\n\t\tthis.pack = this.encode = function(value, encodeOptions) {\r\n\t\t\tif (!target) {\r\n\t\t\t\ttarget = new ByteArrayAllocate(8192)\r\n\t\t\t\ttargetView = new DataView(target.buffer, 0, 8192)\r\n\t\t\t\tposition = 0\r\n\t\t\t}\r\n\t\t\tsafeEnd = target.length - 10\r\n\t\t\tif (safeEnd - position < 0x800) {\r\n\t\t\t\t// don't start too close to the end, \r\n\t\t\t\ttarget = new ByteArrayAllocate(target.length)\r\n\t\t\t\ttargetView = new DataView(target.buffer, 0, target.length)\r\n\t\t\t\tsafeEnd = target.length - 10\r\n\t\t\t\tposition = 0\r\n\t\t\t} else\r\n\t\t\t\tposition = (position + 7) & 0x7ffffff8 // Word align to make any future copying of this buffer faster\r\n\t\t\tstart = position\r\n\t\t\treferenceMap = packr.structuredClone ? new Map() : null\r\n\t\t\tif (packr.bundleStrings && typeof value !== 'string') {\r\n\t\t\t\tbundledStrings = []\r\n\t\t\t\tbundledStrings.size = Infinity // force a new bundle start on first string\r\n\t\t\t} else\r\n\t\t\t\tbundledStrings = null\r\n\t\t\tstructures = packr.structures\r\n\t\t\tif (structures) {\r\n\t\t\t\tif (structures.uninitialized)\r\n\t\t\t\t\tstructures = packr._mergeStructures(packr.getStructures())\r\n\t\t\t\tlet sharedLength = structures.sharedLength || 0\r\n\t\t\t\tif (sharedLength > maxSharedStructures) {\r\n\t\t\t\t\t//if (maxSharedStructures <= 32 && structures.sharedLength > 32) // TODO: could support this, but would need to update the limit ids\r\n\t\t\t\t\tthrow new Error('Shared structures is larger than maximum shared structures, try increasing maxSharedStructures to ' + structures.sharedLength)\r\n\t\t\t\t}\r\n\t\t\t\tif (!structures.transitions) {\r\n\t\t\t\t\t// rebuild our structure transitions\r\n\t\t\t\t\tstructures.transitions = Object.create(null)\r\n\t\t\t\t\tfor (let i = 0; i < sharedLength; i++) {\r\n\t\t\t\t\t\tlet keys = structures[i]\r\n\t\t\t\t\t\tif (!keys)\r\n\t\t\t\t\t\t\tcontinue\r\n\t\t\t\t\t\tlet nextTransition, transition = structures.transitions\r\n\t\t\t\t\t\tfor (let j = 0, l = keys.length; j < l; j++) {\r\n\t\t\t\t\t\t\tlet key = keys[j]\r\n\t\t\t\t\t\t\tnextTransition = transition[key]\r\n\t\t\t\t\t\t\tif (!nextTransition) {\r\n\t\t\t\t\t\t\t\tnextTransition = transition[key] = Object.create(null)\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\ttransition = nextTransition\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\ttransition[RECORD_SYMBOL] = i + 0x40\r\n\t\t\t\t\t}\r\n\t\t\t\t\tlastSharedStructuresLength = sharedLength\r\n\t\t\t\t}\r\n\t\t\t\tif (!isSequential) {\r\n\t\t\t\t\tstructures.nextId = sharedLength + 0x40\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (hasSharedUpdate)\r\n\t\t\t\thasSharedUpdate = false\r\n\t\t\ttry {\r\n\t\t\t\tpack(value)\r\n\t\t\t\tif (bundledStrings) {\r\n\t\t\t\t\twriteBundles(start, pack)\r\n\t\t\t\t}\r\n\t\t\t\tpackr.offset = position // update the offset so next serialization doesn't write over our buffer, but can continue writing to same buffer sequentially\r\n\t\t\t\tif (referenceMap && referenceMap.idsToInsert) {\r\n\t\t\t\t\tposition += referenceMap.idsToInsert.length * 6\r\n\t\t\t\t\tif (position > safeEnd)\r\n\t\t\t\t\t\tmakeRoom(position)\r\n\t\t\t\t\tpackr.offset = position\r\n\t\t\t\t\tlet serialized = insertIds(target.subarray(start, position), referenceMap.idsToInsert)\r\n\t\t\t\t\treferenceMap = null\r\n\t\t\t\t\treturn serialized\r\n\t\t\t\t}\r\n\t\t\t\tif (encodeOptions & REUSE_BUFFER_MODE) {\r\n\t\t\t\t\ttarget.start = start\r\n\t\t\t\t\ttarget.end = position\r\n\t\t\t\t\treturn target\r\n\t\t\t\t}\r\n\t\t\t\treturn target.subarray(start, position) // position can change if we call pack again in saveStructures, so we get the buffer now\r\n\t\t\t} finally {\r\n\t\t\t\tif (structures) {\r\n\t\t\t\t\tif (serializationsSinceTransitionRebuild < 10)\r\n\t\t\t\t\t\tserializationsSinceTransitionRebuild++\r\n\t\t\t\t\tlet sharedLength = structures.sharedLength || maxSharedStructures\r\n\t\t\t\t\tif (structures.length > sharedLength)\r\n\t\t\t\t\t\tstructures.length = sharedLength\r\n\t\t\t\t\tif (transitionsCount > 10000) {\r\n\t\t\t\t\t\t// force a rebuild occasionally after a lot of transitions so it can get cleaned up\r\n\t\t\t\t\t\tstructures.transitions = null\r\n\t\t\t\t\t\tserializationsSinceTransitionRebuild = 0\r\n\t\t\t\t\t\ttransitionsCount = 0\r\n\t\t\t\t\t\tif (recordIdsToRemove.length > 0)\r\n\t\t\t\t\t\t\trecordIdsToRemove = []\r\n\t\t\t\t\t} else if (recordIdsToRemove.length > 0 && !isSequential) {\r\n\t\t\t\t\t\tfor (let i = 0, l = recordIdsToRemove.length; i < l; i++) {\r\n\t\t\t\t\t\t\trecordIdsToRemove[i][RECORD_SYMBOL] = 0\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\trecordIdsToRemove = []\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (hasSharedUpdate && packr.saveStructures) {\r\n\t\t\t\t\t\t// we can't rely on start/end with REUSE_BUFFER_MODE since they will (probably) change when we save\r\n\t\t\t\t\t\tlet returnBuffer = target.subarray(start, position)\r\n\t\t\t\t\t\tif (packr.saveStructures(structures, lastSharedStructuresLength) === false) {\r\n\t\t\t\t\t\t\t// get updated structures and try again if the update failed\r\n\t\t\t\t\t\t\tpackr._mergeStructures(packr.getStructures())\r\n\t\t\t\t\t\t\treturn packr.pack(value)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tlastSharedStructuresLength = sharedLength\r\n\t\t\t\t\t\treturn returnBuffer\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif (encodeOptions & RESET_BUFFER_MODE)\r\n\t\t\t\t\tposition = start\r\n\t\t\t}\r\n\t\t}\r\n\t\tconst pack = (value) => {\r\n\t\t\tif (position > safeEnd)\r\n\t\t\t\ttarget = makeRoom(position)\r\n\r\n\t\t\tvar type = typeof value\r\n\t\t\tvar length\r\n\t\t\tif (type === 'string') {\r\n\t\t\t\tlet strLength = value.length\r\n\t\t\t\tif (bundledStrings && strLength >= 4 && strLength < 0x1000) {\r\n\t\t\t\t\tif ((bundledStrings.size += strLength) > MAX_BUNDLE_SIZE) {\r\n\t\t\t\t\t\tlet extStart\r\n\t\t\t\t\t\tlet maxBytes = (bundledStrings[0] ? bundledStrings[0].length * 3 + bundledStrings[1].length : 0) + 10\r\n\t\t\t\t\t\tif (position + maxBytes > safeEnd)\r\n\t\t\t\t\t\t\ttarget = makeRoom(position + maxBytes)\r\n\t\t\t\t\t\tif (bundledStrings.position) { // here we use the 0x62 extension to write the last bundle and reserve sapce for the reference pointer to the next/current bundle\r\n\t\t\t\t\t\t\ttarget[position] = 0xc8 // ext 16\r\n\t\t\t\t\t\t\tposition += 3 // reserve for the writing bundle size\r\n\t\t\t\t\t\t\ttarget[position++] = 0x62 // 'b'\r\n\t\t\t\t\t\t\textStart = position - start\r\n\t\t\t\t\t\t\tposition += 4 // reserve for writing bundle reference\r\n\t\t\t\t\t\t\twriteBundles(start, pack) // write the last bundles\r\n\t\t\t\t\t\t\ttargetView.setUint16(extStart + start - 3, position - start - extStart)\r\n\t\t\t\t\t\t} else { // here we use the 0x62 extension just to reserve the space for the reference pointer to the bundle (will be updated once the bundle is written)\r\n\t\t\t\t\t\t\ttarget[position++] = 0xd6 // fixext 4\r\n\t\t\t\t\t\t\ttarget[position++] = 0x62 // 'b'\r\n\t\t\t\t\t\t\textStart = position - start\r\n\t\t\t\t\t\t\tposition += 4 // reserve for writing bundle reference\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbundledStrings = ['', ''] // create new ones\r\n\t\t\t\t\t\tbundledStrings.size = 0\r\n\t\t\t\t\t\tbundledStrings.position = extStart\r\n\t\t\t\t\t}\r\n\t\t\t\t\tlet twoByte = hasNonLatin.test(value)\r\n\t\t\t\t\tbundledStrings[twoByte ? 0 : 1] += value\r\n\t\t\t\t\ttarget[position++] = 0xc1\r\n\t\t\t\t\tpack(twoByte ? -strLength : strLength);\r\n\t\t\t\t\treturn\r\n\t\t\t\t}\r\n\t\t\t\tlet headerSize\r\n\t\t\t\t// first we estimate the header size, so we can write to the correct location\r\n\t\t\t\tif (strLength < 0x20) {\r\n\t\t\t\t\theaderSize = 1\r\n\t\t\t\t} else if (strLength < 0x100) {\r\n\t\t\t\t\theaderSize = 2\r\n\t\t\t\t} else if (strLength < 0x10000) {\r\n\t\t\t\t\theaderSize = 3\r\n\t\t\t\t} else {\r\n\t\t\t\t\theaderSize = 5\r\n\t\t\t\t}\r\n\t\t\t\tlet maxBytes = strLength * 3\r\n\t\t\t\tif (position + maxBytes > safeEnd)\r\n\t\t\t\t\ttarget = makeRoom(position + maxBytes)\r\n\r\n\t\t\t\tif (strLength < 0x40 || !encodeUtf8) {\r\n\t\t\t\t\tlet i, c1, c2, strPosition = position + headerSize\r\n\t\t\t\t\tfor (i = 0; i < strLength; i++) {\r\n\t\t\t\t\t\tc1 = value.charCodeAt(i)\r\n\t\t\t\t\t\tif (c1 < 0x80) {\r\n\t\t\t\t\t\t\ttarget[strPosition++] = c1\r\n\t\t\t\t\t\t} else if (c1 < 0x800) {\r\n\t\t\t\t\t\t\ttarget[strPosition++] = c1 >> 6 | 0xc0\r\n\t\t\t\t\t\t\ttarget[strPosition++] = c1 & 0x3f | 0x80\r\n\t\t\t\t\t\t} else if (\r\n\t\t\t\t\t\t\t(c1 & 0xfc00) === 0xd800 &&\r\n\t\t\t\t\t\t\t((c2 = value.charCodeAt(i + 1)) & 0xfc00) === 0xdc00\r\n\t\t\t\t\t\t) {\r\n\t\t\t\t\t\t\tc1 = 0x10000 + ((c1 & 0x03ff) << 10) + (c2 & 0x03ff)\r\n\t\t\t\t\t\t\ti++\r\n\t\t\t\t\t\t\ttarget[strPosition++] = c1 >> 18 | 0xf0\r\n\t\t\t\t\t\t\ttarget[strPosition++] = c1 >> 12 & 0x3f | 0x80\r\n\t\t\t\t\t\t\ttarget[strPosition++] = c1 >> 6 & 0x3f | 0x80\r\n\t\t\t\t\t\t\ttarget[strPosition++] = c1 & 0x3f | 0x80\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\ttarget[strPosition++] = c1 >> 12 | 0xe0\r\n\t\t\t\t\t\t\ttarget[strPosition++] = c1 >> 6 & 0x3f | 0x80\r\n\t\t\t\t\t\t\ttarget[strPosition++] = c1 & 0x3f | 0x80\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tlength = strPosition - position - headerSize\r\n\t\t\t\t} else {\r\n\t\t\t\t\tlength = encodeUtf8(value, position + headerSize, maxBytes)\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (length < 0x20) {\r\n\t\t\t\t\ttarget[position++] = 0xa0 | length\r\n\t\t\t\t} else if (length < 0x100) {\r\n\t\t\t\t\tif (headerSize < 2) {\r\n\t\t\t\t\t\ttarget.copyWithin(position + 2, position + 1, position + 1 + length)\r\n\t\t\t\t\t}\r\n\t\t\t\t\ttarget[position++] = 0xd9\r\n\t\t\t\t\ttarget[position++] = length\r\n\t\t\t\t} else if (length < 0x10000) {\r\n\t\t\t\t\tif (headerSize < 3) {\r\n\t\t\t\t\t\ttarget.copyWithin(position + 3, position + 2, position + 2 + length)\r\n\t\t\t\t\t}\r\n\t\t\t\t\ttarget[position++] = 0xda\r\n\t\t\t\t\ttarget[position++] = length >> 8\r\n\t\t\t\t\ttarget[position++] = length & 0xff\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif (headerSize < 5) {\r\n\t\t\t\t\t\ttarget.copyWithin(position + 5, position + 3, position + 3 + length)\r\n\t\t\t\t\t}\r\n\t\t\t\t\ttarget[position++] = 0xdb\r\n\t\t\t\t\ttargetView.setUint32(position, length)\r\n\t\t\t\t\tposition += 4\r\n\t\t\t\t}\r\n\t\t\t\tposition += length\r\n\t\t\t} else if (type === 'number') {\r\n\t\t\t\tif (value >>> 0 === value) {// positive integer, 32-bit or less\r\n\t\t\t\t\t// positive uint\r\n\t\t\t\t\tif (value < 0x40) {\r\n\t\t\t\t\t\ttarget[position++] = value\r\n\t\t\t\t\t} else if (value < 0x100) {\r\n\t\t\t\t\t\ttarget[position++] = 0xcc\r\n\t\t\t\t\t\ttarget[position++] = value\r\n\t\t\t\t\t} else if (value < 0x10000) {\r\n\t\t\t\t\t\ttarget[position++] = 0xcd\r\n\t\t\t\t\t\ttarget[position++] = value >> 8\r\n\t\t\t\t\t\ttarget[position++] = value & 0xff\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\ttarget[position++] = 0xce\r\n\t\t\t\t\t\ttargetView.setUint32(position, value)\r\n\t\t\t\t\t\tposition += 4\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if (value >> 0 === value) { // negative integer\r\n\t\t\t\t\tif (value >= -0x20) {\r\n\t\t\t\t\t\ttarget[position++] = 0x100 + value\r\n\t\t\t\t\t} else if (value >= -0x80) {\r\n\t\t\t\t\t\ttarget[position++] = 0xd0\r\n\t\t\t\t\t\ttarget[position++] = value + 0x100\r\n\t\t\t\t\t} else if (value >= -0x8000) {\r\n\t\t\t\t\t\ttarget[position++] = 0xd1\r\n\t\t\t\t\t\ttargetView.setInt16(position, value)\r\n\t\t\t\t\t\tposition += 2\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\ttarget[position++] = 0xd2\r\n\t\t\t\t\t\ttargetView.setInt32(position, value)\r\n\t\t\t\t\t\tposition += 4\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tlet useFloat32\r\n\t\t\t\t\tif ((useFloat32 = this.useFloat32) > 0 && value < 0x100000000 && value >= -0x80000000) {\r\n\t\t\t\t\t\ttarget[position++] = 0xca\r\n\t\t\t\t\t\ttargetView.setFloat32(position, value)\r\n\t\t\t\t\t\tlet xShifted\r\n\t\t\t\t\t\tif (useFloat32 < 4 ||\r\n\t\t\t\t\t\t\t\t// this checks for rounding of numbers that were encoded in 32-bit float to nearest significant decimal digit that could be preserved\r\n\t\t\t\t\t\t\t\t((xShifted = value * mult10[((target[position] & 0x7f) << 1) | (target[position + 1] >> 7)]) >> 0) === xShifted) {\r\n\t\t\t\t\t\t\tposition += 4\r\n\t\t\t\t\t\t\treturn\r\n\t\t\t\t\t\t} else\r\n\t\t\t\t\t\t\tposition-- // move back into position for writing a double\r\n\t\t\t\t\t}\r\n\t\t\t\t\ttarget[position++] = 0xcb\r\n\t\t\t\t\ttargetView.setFloat64(position, value)\r\n\t\t\t\t\tposition += 8\r\n\t\t\t\t}\r\n\t\t\t} else if (type === 'object') {\r\n\t\t\t\tif (!value)\r\n\t\t\t\t\ttarget[position++] = 0xc0\r\n\t\t\t\telse {\r\n\t\t\t\t\tif (referenceMap) {\r\n\t\t\t\t\t\tlet referee = referenceMap.get(value)\r\n\t\t\t\t\t\tif (referee) {\r\n\t\t\t\t\t\t\tif (!referee.id) {\r\n\t\t\t\t\t\t\t\tlet idsToInsert = referenceMap.idsToInsert || (referenceMap.idsToInsert = [])\r\n\t\t\t\t\t\t\t\treferee.id = idsToInsert.push(referee)\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\ttarget[position++] = 0xd6 // fixext 4\r\n\t\t\t\t\t\t\ttarget[position++] = 0x70 // \"p\" for pointer\r\n\t\t\t\t\t\t\ttargetView.setUint32(position, referee.id)\r\n\t\t\t\t\t\t\tposition += 4\r\n\t\t\t\t\t\t\treturn\r\n\t\t\t\t\t\t} else \r\n\t\t\t\t\t\t\treferenceMap.set(value, { offset: position - start })\r\n\t\t\t\t\t}\r\n\t\t\t\t\tlet constructor = value.constructor\r\n\t\t\t\t\tif (constructor === Object) {\r\n\t\t\t\t\t\twriteObject(value, true)\r\n\t\t\t\t\t} else if (constructor === Array) {\r\n\t\t\t\t\t\tlength = value.length\r\n\t\t\t\t\t\tif (length < 0x10) {\r\n\t\t\t\t\t\t\ttarget[position++] = 0x90 | length\r\n\t\t\t\t\t\t} else if (length < 0x10000) {\r\n\t\t\t\t\t\t\ttarget[position++] = 0xdc\r\n\t\t\t\t\t\t\ttarget[position++] = length >> 8\r\n\t\t\t\t\t\t\ttarget[position++] = length & 0xff\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\ttarget[position++] = 0xdd\r\n\t\t\t\t\t\t\ttargetView.setUint32(position, length)\r\n\t\t\t\t\t\t\tposition += 4\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tfor (let i = 0; i < length; i++) {\r\n\t\t\t\t\t\t\tpack(value[i])\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else if (constructor === Map) {\r\n\t\t\t\t\t\tlength = value.size\r\n\t\t\t\t\t\tif (length < 0x10) {\r\n\t\t\t\t\t\t\ttarget[position++] = 0x80 | length\r\n\t\t\t\t\t\t} else if (length < 0x10000) {\r\n\t\t\t\t\t\t\ttarget[position++] = 0xde\r\n\t\t\t\t\t\t\ttarget[position++] = length >> 8\r\n\t\t\t\t\t\t\ttarget[position++] = length & 0xff\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\ttarget[position++] = 0xdf\r\n\t\t\t\t\t\t\ttargetView.setUint32(position, length)\r\n\t\t\t\t\t\t\tposition += 4\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tfor (let [ key, entryValue ] of value) {\r\n\t\t\t\t\t\t\tpack(key)\r\n\t\t\t\t\t\t\tpack(entryValue)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\t\r\n\t\t\t\t\t\tfor (let i = 0, l = extensions.length; i < l; i++) {\r\n\t\t\t\t\t\t\tlet extensionClass = extensionClasses[i]\r\n\t\t\t\t\t\t\tif (value instanceof extensionClass) {\r\n\t\t\t\t\t\t\t\tlet extension = extensions[i]\r\n\t\t\t\t\t\t\t\tif (extension.write) {\r\n\t\t\t\t\t\t\t\t\tif (extension.type) {\r\n\t\t\t\t\t\t\t\t\t\ttarget[position++] = 0xd4 // one byte \"tag\" extension\r\n\t\t\t\t\t\t\t\t\t\ttarget[position++] = extension.type\r\n\t\t\t\t\t\t\t\t\t\ttarget[position++] = 0\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tpack(extension.write.call(this, value))\r\n\t\t\t\t\t\t\t\t\treturn\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tlet currentTarget = target\r\n\t\t\t\t\t\t\t\tlet currentTargetView = targetView\r\n\t\t\t\t\t\t\t\tlet currentPosition = position\r\n\t\t\t\t\t\t\t\ttarget = null\r\n\t\t\t\t\t\t\t\tlet result\r\n\t\t\t\t\t\t\t\ttry {\r\n\t\t\t\t\t\t\t\t\tresult = extension.pack.call(this, value, (size) => {\r\n\t\t\t\t\t\t\t\t\t\t// restore target and use it\r\n\t\t\t\t\t\t\t\t\t\ttarget = currentTarget\r\n\t\t\t\t\t\t\t\t\t\tcurrentTarget = null\r\n\t\t\t\t\t\t\t\t\t\tposition += size\r\n\t\t\t\t\t\t\t\t\t\tif (position > safeEnd)\r\n\t\t\t\t\t\t\t\t\t\t\tmakeRoom(position)\r\n\t\t\t\t\t\t\t\t\t\treturn {\r\n\t\t\t\t\t\t\t\t\t\t\ttarget, targetView, position: position - size\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}, pack)\r\n\t\t\t\t\t\t\t\t} finally {\r\n\t\t\t\t\t\t\t\t\t// restore current target information (unless already restored)\r\n\t\t\t\t\t\t\t\t\tif (currentTarget) {\r\n\t\t\t\t\t\t\t\t\t\ttarget = currentTarget\r\n\t\t\t\t\t\t\t\t\t\ttargetView = currentTargetView\r\n\t\t\t\t\t\t\t\t\t\tposition = currentPosition\r\n\t\t\t\t\t\t\t\t\t\tsafeEnd = target.length - 10\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tif (result) {\r\n\t\t\t\t\t\t\t\t\tif (result.length + position > safeEnd)\r\n\t\t\t\t\t\t\t\t\t\tmakeRoom(result.length + position)\r\n\t\t\t\t\t\t\t\t\tposition = writeExtensionData(result, target, position, extension.type)\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\treturn\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t// no extension found, write as object\r\n\t\t\t\t\t\twriteObject(value, !value.hasOwnProperty) // if it doesn't have hasOwnProperty, don't do hasOwnProperty checks\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t} else if (type === 'boolean') {\r\n\t\t\t\ttarget[position++] = value ? 0xc3 : 0xc2\r\n\t\t\t} else if (type === 'bigint') {\r\n\t\t\t\tif (value < (BigInt(1)<<BigInt(63)) && value >= -(BigInt(1)<<BigInt(63))) {\r\n\t\t\t\t\t// use a signed int as long as it fits\r\n\t\t\t\t\ttarget[position++] = 0xd3\r\n\t\t\t\t\ttargetView.setBigInt64(position, value)\r\n\t\t\t\t} else if (value < (BigInt(1)<<BigInt(64)) && value > 0) {\r\n\t\t\t\t\t// if we can fit an unsigned int, use that\r\n\t\t\t\t\ttarget[position++] = 0xcf\r\n\t\t\t\t\ttargetView.setBigUint64(position, value)\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// overflow\r\n\t\t\t\t\tif (this.largeBigIntToFloat) {\r\n\t\t\t\t\t\ttarget[position++] = 0xcb\r\n\t\t\t\t\t\ttargetView.setFloat64(position, Number(value))\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthrow new RangeError(value + ' was too large to fit in MessagePack 64-bit integer format, set largeBigIntToFloat to convert to float-64')\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tposition += 8\r\n\t\t\t} else if (type === 'undefined') {\r\n\t\t\t\tif (this.encodeUndefinedAsNil)\r\n\t\t\t\t\ttarget[position++] = 0xc0\r\n\t\t\t\telse {\r\n\t\t\t\t\ttarget[position++] = 0xd4 // a number of implementations use fixext1 with type 0, data 0 to denote undefined, so we follow suite\r\n\t\t\t\t\ttarget[position++] = 0\r\n\t\t\t\t\ttarget[position++] = 0\r\n\t\t\t\t}\r\n\t\t\t} else if (type === 'function') {\r\n\t\t\t\tpack(this.writeFunction && this.writeFunction()) // if there is a writeFunction, use it, otherwise just encode as undefined\r\n\t\t\t} else {\r\n\t\t\t\tthrow new Error('Unknown type: ' + type)\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tconst writeObject = this.useRecords === false ? this.variableMapSize ? (object) => {\r\n\t\t\t// this method is slightly slower, but generates \"preferred serialization\" (optimally small for smaller objects)\r\n\t\t\tlet keys = Object.keys(object)\r\n\t\t\tlet length = keys.length\r\n\t\t\tif (length < 0x10) {\r\n\t\t\t\ttarget[position++] = 0x80 | length\r\n\t\t\t} else if (length < 0x10000) {\r\n\t\t\t\ttarget[position++] = 0xde\r\n\t\t\t\ttarget[position++] = length >> 8\r\n\t\t\t\ttarget[position++] = length & 0xff\r\n\t\t\t} else {\r\n\t\t\t\ttarget[position++] = 0xdf\r\n\t\t\t\ttargetView.setUint32(position, length)\r\n\t\t\t\tposition += 4\r\n\t\t\t}\r\n\t\t\tlet key\r\n\t\t\tfor (let i = 0; i < length; i++) {\r\n\t\t\t\tpack(key = keys[i])\r\n\t\t\t\tpack(object[key])\r\n\t\t\t}\r\n\t\t} :\r\n\t\t(object, safePrototype) => {\r\n\t\t\ttarget[position++] = 0xde // always using map 16, so we can preallocate and set the length afterwards\r\n\t\t\tlet objectOffset = position - start\r\n\t\t\tposition += 2\r\n\t\t\tlet size = 0\r\n\t\t\tfor (let key in object) {\r\n\t\t\t\tif (safePrototype || object.hasOwnProperty(key)) {\r\n\t\t\t\t\tpack(key)\r\n\t\t\t\t\tpack(object[key])\r\n\t\t\t\t\tsize++\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\ttarget[objectOffset++ + start] = size >> 8\r\n\t\t\ttarget[objectOffset + start] = size & 0xff\r\n\t\t} :\r\n\t\t(options.progressiveRecords && !useTwoByteRecords) ?  // this is about 2% faster for highly stable structures, since it only requires one for-in loop (but much more expensive when new structure needs to be written)\r\n\t\t(object, safePrototype) => {\r\n\t\t\tlet nextTransition, transition = structures.transitions || (structures.transitions = Object.create(null))\r\n\t\t\tlet objectOffset = position++ - start\r\n\t\t\tlet wroteKeys\r\n\t\t\tfor (let key in object) {\r\n\t\t\t\tif (safePrototype || object.hasOwnProperty(key)) {\r\n\t\t\t\t\tnextTransition = transition[key]\r\n\t\t\t\t\tif (nextTransition)\r\n\t\t\t\t\t\ttransition = nextTransition\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\t// record doesn't exist, create full new record and insert it\r\n\t\t\t\t\t\tlet keys = Object.keys(object)\r\n\t\t\t\t\t\tlet lastTransition = transition\r\n\t\t\t\t\t\ttransition = structures.transitions\r\n\t\t\t\t\t\tlet newTransitions = 0\r\n\t\t\t\t\t\tfor (let i = 0, l = keys.length; i < l; i++) {\r\n\t\t\t\t\t\t\tlet key = keys[i]\r\n\t\t\t\t\t\t\tnextTransition = transition[key]\r\n\t\t\t\t\t\t\tif (!nextTransition) {\r\n\t\t\t\t\t\t\t\tnextTransition = transition[key] = Object.create(null)\r\n\t\t\t\t\t\t\t\tnewTransitions++\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\ttransition = nextTransition\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (objectOffset + start + 1 == position) {\r\n\t\t\t\t\t\t\t// first key, so we don't need to insert, we can just write record directly\r\n\t\t\t\t\t\t\tposition--\r\n\t\t\t\t\t\t\tnewRecord(transition, keys, newTransitions)\r\n\t\t\t\t\t\t} else // otherwise we need to insert the record, moving existing data after the record\r\n\t\t\t\t\t\t\tinsertNewRecord(transition, keys, objectOffset, newTransitions)\r\n\t\t\t\t\t\twroteKeys = true\r\n\t\t\t\t\t\ttransition = lastTransition[key]\r\n\t\t\t\t\t}\r\n\t\t\t\t\tpack(object[key])\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (!wroteKeys) {\r\n\t\t\t\tlet recordId = transition[RECORD_SYMBOL]\r\n\t\t\t\tif (recordId)\r\n\t\t\t\t\ttarget[objectOffset + start] = recordId\r\n\t\t\t\telse\r\n\t\t\t\t\tinsertNewRecord(transition, Object.keys(object), objectOffset, 0)\r\n\t\t\t}\r\n\t\t} :\r\n\t\t(object, safePrototype) => {\r\n\t\t\tlet nextTransition, transition = structures.transitions || (structures.transitions = Object.create(null))\r\n\t\t\tlet newTransitions = 0\r\n\t\t\tfor (let key in object) if (safePrototype || object.hasOwnProperty(key)) {\r\n\t\t\t\tnextTransition = transition[key]\r\n\t\t\t\tif (!nextTransition) {\r\n\t\t\t\t\tnextTransition = transition[key] = Object.create(null)\r\n\t\t\t\t\tnewTransitions++\r\n\t\t\t\t}\r\n\t\t\t\ttransition = nextTransition\r\n\t\t\t}\r\n\t\t\tlet recordId = transition[RECORD_SYMBOL]\r\n\t\t\tif (recordId) {\r\n\t\t\t\tif (recordId >= 0x60 && useTwoByteRecords) {\r\n\t\t\t\t\ttarget[position++] = ((recordId -= 0x60) & 0x1f) + 0x60\r\n\t\t\t\t\ttarget[position++] = recordId >> 5\r\n\t\t\t\t} else\r\n\t\t\t\t\ttarget[position++] = recordId\r\n\t\t\t} else {\r\n\t\t\t\tnewRecord(transition, transition.__keys__ || Object.keys(object), newTransitions)\r\n\t\t\t}\r\n\t\t\t// now write the values\r\n\t\t\tfor (let key in object)\r\n\t\t\t\tif (safePrototype || object.hasOwnProperty(key))\r\n\t\t\t\t\tpack(object[key])\r\n\t\t}\r\n\t\tconst makeRoom = (end) => {\r\n\t\t\tlet newSize\r\n\t\t\tif (end > 0x1000000) {\r\n\t\t\t\t// special handling for really large buffers\r\n\t\t\t\tif ((end - start) > MAX_BUFFER_SIZE)\r\n\t\t\t\t\tthrow new Error('Packed buffer would be larger than maximum buffer size')\r\n\t\t\t\tnewSize = Math.min(MAX_BUFFER_SIZE,\r\n\t\t\t\t\tMath.round(Math.max((end - start) * (end > 0x4000000 ? 1.25 : 2), 0x400000) / 0x1000) * 0x1000)\r\n\t\t\t} else // faster handling for smaller buffers\r\n\t\t\t\tnewSize = ((Math.max((end - start) << 2, target.length - 1) >> 12) + 1) << 12\r\n\t\t\tlet newBuffer = new ByteArrayAllocate(newSize)\r\n\t\t\ttargetView = new DataView(newBuffer.buffer, 0, newSize)\r\n\t\t\tif (target.copy)\r\n\t\t\t\ttarget.copy(newBuffer, 0, start, end)\r\n\t\t\telse\r\n\t\t\t\tnewBuffer.set(target.slice(start, end))\r\n\t\t\tposition -= start\r\n\t\t\tstart = 0\r\n\t\t\tsafeEnd = newBuffer.length - 10\r\n\t\t\treturn target = newBuffer\r\n\t\t}\r\n\t\tconst newRecord = (transition, keys, newTransitions) => {\r\n\t\t\tlet recordId = structures.nextId\r\n\t\t\tif (!recordId)\r\n\t\t\t\trecordId = 0x40\r\n\t\t\tif (recordId < sharedLimitId && this.shouldShareStructure && !this.shouldShareStructure(keys)) {\r\n\t\t\t\trecordId = structures.nextOwnId\r\n\t\t\t\tif (!(recordId < maxStructureId))\r\n\t\t\t\t\trecordId = sharedLimitId\r\n\t\t\t\tstructures.nextOwnId = recordId + 1\r\n\t\t\t} else {\r\n\t\t\t\tif (recordId >= maxStructureId)// cycle back around\r\n\t\t\t\t\trecordId = sharedLimitId\r\n\t\t\t\tstructures.nextId = recordId + 1\r\n\t\t\t}\r\n\t\t\tlet highByte = keys.highByte = recordId >= 0x60 && useTwoByteRecords ? (recordId - 0x60) >> 5 : -1\r\n\t\t\ttransition[RECORD_SYMBOL] = recordId\r\n\t\t\ttransition.__keys__ = keys\r\n\t\t\tstructures[recordId - 0x40] = keys\r\n\r\n\t\t\tif (recordId < sharedLimitId) {\r\n\t\t\t\tkeys.isShared = true\r\n\t\t\t\tstructures.sharedLength = recordId - 0x3f\r\n\t\t\t\thasSharedUpdate = true\r\n\t\t\t\tif (highByte >= 0) {\r\n\t\t\t\t\ttarget[position++] = (recordId & 0x1f) + 0x60\r\n\t\t\t\t\ttarget[position++] = highByte\r\n\t\t\t\t} else {\r\n\t\t\t\t\ttarget[position++] = recordId\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tif (highByte >= 0) {\r\n\t\t\t\t\ttarget[position++] = 0xd5 // fixext 2\r\n\t\t\t\t\ttarget[position++] = 0x72 // \"r\" record defintion extension type\r\n\t\t\t\t\ttarget[position++] = (recordId & 0x1f) + 0x60\r\n\t\t\t\t\ttarget[position++] = highByte\r\n\t\t\t\t} else {\r\n\t\t\t\t\ttarget[position++] = 0xd4 // fixext 1\r\n\t\t\t\t\ttarget[position++] = 0x72 // \"r\" record defintion extension type\r\n\t\t\t\t\ttarget[position++] = recordId\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (newTransitions)\r\n\t\t\t\t\ttransitionsCount += serializationsSinceTransitionRebuild * newTransitions\r\n\t\t\t\t// record the removal of the id, we can maintain our shared structure\r\n\t\t\t\tif (recordIdsToRemove.length >= maxOwnStructures)\r\n\t\t\t\t\trecordIdsToRemove.shift()[RECORD_SYMBOL] = 0 // we are cycling back through, and have to remove old ones\r\n\t\t\t\trecordIdsToRemove.push(transition)\r\n\t\t\t\tpack(keys)\r\n\t\t\t}\r\n\t\t}\r\n\t\tconst insertNewRecord = (transition, keys, insertionOffset, newTransitions) => {\r\n\t\t\tlet mainTarget = target\r\n\t\t\tlet mainPosition = position\r\n\t\t\tlet mainSafeEnd = safeEnd\r\n\t\t\tlet mainStart = start\r\n\t\t\ttarget = keysTarget\r\n\t\t\tposition = 0\r\n\t\t\tstart = 0\r\n\t\t\tif (!target)\r\n\t\t\t\tkeysTarget = target = new ByteArrayAllocate(8192)\r\n\t\t\tsafeEnd = target.length - 10\r\n\t\t\tnewRecord(transition, keys, newTransitions)\r\n\t\t\tkeysTarget = target\r\n\t\t\tlet keysPosition = position\r\n\t\t\ttarget = mainTarget\r\n\t\t\tposition = mainPosition\r\n\t\t\tsafeEnd = mainSafeEnd\r\n\t\t\tstart = mainStart\r\n\t\t\tif (keysPosition > 1) {\r\n\t\t\t\tlet newEnd = position + keysPosition - 1\r\n\t\t\t\tif (newEnd > safeEnd)\r\n\t\t\t\t\tmakeRoom(newEnd)\r\n\t\t\t\tlet insertionPosition = insertionOffset + start\r\n\t\t\t\ttarget.copyWithin(insertionPosition + keysPosition, insertionPosition + 1, position)\r\n\t\t\t\ttarget.set(keysTarget.slice(0, keysPosition), insertionPosition)\r\n\t\t\t\tposition = newEnd\r\n\t\t\t} else {\r\n\t\t\t\ttarget[insertionOffset + start] = keysTarget[0]\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tuseBuffer(buffer) {\r\n\t\t// this means we are finished using our own buffer and we can write over it safely\r\n\t\ttarget = buffer\r\n\t\ttargetView = new DataView(target.buffer, target.byteOffset, target.byteLength)\r\n\t\tposition = 0\r\n\t}\r\n\tclearSharedData() {\r\n\t\tif (this.structures)\r\n\t\t\tthis.structures = []\r\n\t}\r\n}\r\n\r\nfunction copyBinary(source, target, targetOffset, offset, endOffset) {\r\n\twhile (offset < endOffset) {\r\n\t\ttarget[targetOffset++] = source[offset++]\r\n\t}\r\n}\r\n\r\nextensionClasses = [ Date, Set, Error, RegExp, ArrayBuffer, Object.getPrototypeOf(Uint8Array.prototype).constructor /*TypedArray*/, C1Type ]\r\nextensions = [{\r\n\tpack(date, allocateForWrite, pack) {\r\n\t\tlet seconds = date.getTime() / 1000\r\n\t\tif ((this.useTimestamp32 || date.getMilliseconds() === 0) && seconds >= 0 && seconds < 0x100000000) {\r\n\t\t\t// Timestamp 32\r\n\t\t\tlet { target, targetView, position} = allocateForWrite(6)\r\n\t\t\ttarget[position++] = 0xd6\r\n\t\t\ttarget[position++] = 0xff\r\n\t\t\ttargetView.setUint32(position, seconds)\r\n\t\t} else if (seconds > 0 && seconds < 0x100000000) {\r\n\t\t\t// Timestamp 64\r\n\t\t\tlet { target, targetView, position} = allocateForWrite(10)\r\n\t\t\ttarget[position++] = 0xd7\r\n\t\t\ttarget[position++] = 0xff\r\n\t\t\ttargetView.setUint32(position, date.getMilliseconds() * 4000000 + ((seconds / 1000 / 0x100000000) >> 0))\r\n\t\t\ttargetView.setUint32(position + 4, seconds)\r\n\t\t} else if (isNaN(seconds)) {\r\n\t\t\tif (this.onInvalidDate) {\r\n\t\t\t\tallocateForWrite(0)\r\n\t\t\t\treturn pack(this.onInvalidDate())\r\n\t\t\t}\r\n\t\t\t// Intentionally invalid timestamp\r\n\t\t\tlet { target, targetView, position} = allocateForWrite(3)\r\n\t\t\ttarget[position++] = 0xd4\r\n\t\t\ttarget[position++] = 0xff\r\n\t\t\ttarget[position++] = 0xff\r\n\t\t} else {\r\n\t\t\t// Timestamp 96\r\n\t\t\tlet { target, targetView, position} = allocateForWrite(15)\r\n\t\t\ttarget[position++] = 0xc7\r\n\t\t\ttarget[position++] = 12\r\n\t\t\ttarget[position++] = 0xff\r\n\t\t\ttargetView.setUint32(position, date.getMilliseconds() * 1000000)\r\n\t\t\ttargetView.setBigInt64(position + 4, BigInt(Math.floor(seconds)))\r\n\t\t}\r\n\t}\r\n}, {\r\n\tpack(set, allocateForWrite, pack) {\r\n\t\tlet array = Array.from(set)\r\n\t\tlet { target, position} = allocateForWrite(this.moreTypes ? 3 : 0)\r\n\t\tif (this.moreTypes) {\r\n\t\t\ttarget[position++] = 0xd4\r\n\t\t\ttarget[position++] = 0x73 // 's' for Set\r\n\t\t\ttarget[position++] = 0\r\n\t\t}\r\n\t\tpack(array)\r\n\t}\r\n}, {\r\n\tpack(error, allocateForWrite, pack) {\r\n\t\tlet { target, position} = allocateForWrite(this.moreTypes ? 3 : 0)\r\n\t\tif (this.moreTypes) {\r\n\t\t\ttarget[position++] = 0xd4\r\n\t\t\ttarget[position++] = 0x65 // 'e' for error\r\n\t\t\ttarget[position++] = 0\r\n\t\t}\r\n\t\tpack([ error.name, error.message ])\r\n\t}\r\n}, {\r\n\tpack(regex, allocateForWrite, pack) {\r\n\t\tlet { target, position} = allocateForWrite(this.moreTypes ? 3 : 0)\r\n\t\tif (this.moreTypes) {\r\n\t\t\ttarget[position++] = 0xd4\r\n\t\t\ttarget[position++] = 0x78 // 'x' for regeXp\r\n\t\t\ttarget[position++] = 0\r\n\t\t}\r\n\t\tpack([ regex.source, regex.flags ])\r\n\t}\r\n}, {\r\n\tpack(arrayBuffer, allocateForWrite) {\r\n\t\tif (this.moreTypes)\r\n\t\t\twriteExtBuffer(arrayBuffer, 0x10, allocateForWrite)\r\n\t\telse\r\n\t\t\twriteBuffer(hasNodeBuffer ? Buffer.from(arrayBuffer) : new Uint8Array(arrayBuffer), allocateForWrite)\r\n\t}\r\n}, {\r\n\tpack(typedArray, allocateForWrite) {\r\n\t\tlet constructor = typedArray.constructor\r\n\t\tif (constructor !== ByteArray && this.moreTypes)\r\n\t\t\twriteExtBuffer(typedArray, typedArrays.indexOf(constructor.name), allocateForWrite)\r\n\t\telse\r\n\t\t\twriteBuffer(typedArray, allocateForWrite)\r\n\t}\r\n}, {\r\n\tpack(c1, allocateForWrite) { // specific 0xC1 object\r\n\t\tlet { target, position} = allocateForWrite(1)\r\n\t\ttarget[position] = 0xc1\r\n\t}\r\n}]\r\n\r\nfunction writeExtBuffer(typedArray, type, allocateForWrite, encode) {\r\n\tlet length = typedArray.byteLength\r\n\tif (length + 1 < 0x100) {\r\n\t\tvar { target, position } = allocateForWrite(4 + length)\r\n\t\ttarget[position++] = 0xc7\r\n\t\ttarget[position++] = length + 1\r\n\t} else if (length + 1 < 0x10000) {\r\n\t\tvar { target, position } = allocateForWrite(5 + length)\r\n\t\ttarget[position++] = 0xc8\r\n\t\ttarget[position++] = (length + 1) >> 8\r\n\t\ttarget[position++] = (length + 1) & 0xff\r\n\t} else {\r\n\t\tvar { target, position, targetView } = allocateForWrite(7 + length)\r\n\t\ttarget[position++] = 0xc9\r\n\t\ttargetView.setUint32(position, length + 1) // plus one for the type byte\r\n\t\tposition += 4\r\n\t}\r\n\ttarget[position++] = 0x74 // \"t\" for typed array\r\n\ttarget[position++] = type\r\n\ttarget.set(new Uint8Array(typedArray.buffer, typedArray.byteOffset, typedArray.byteLength), position)\r\n}\r\nfunction writeBuffer(buffer, allocateForWrite) {\r\n\tlet length = buffer.byteLength\r\n\tvar target, position\r\n\tif (length < 0x100) {\r\n\t\tvar { target, position } = allocateForWrite(length + 2)\r\n\t\ttarget[position++] = 0xc4\r\n\t\ttarget[position++] = length\r\n\t} else if (length < 0x10000) {\r\n\t\tvar { target, position } = allocateForWrite(length + 3)\r\n\t\ttarget[position++] = 0xc5\r\n\t\ttarget[position++] = length >> 8\r\n\t\ttarget[position++] = length & 0xff\r\n\t} else {\r\n\t\tvar { target, position, targetView } = allocateForWrite(length + 5)\r\n\t\ttarget[position++] = 0xc6\r\n\t\ttargetView.setUint32(position, length)\r\n\t\tposition += 4\r\n\t}\r\n\ttarget.set(buffer, position)\r\n}\r\n\r\nfunction writeExtensionData(result, target, position, type) {\r\n\tlet length = result.length\r\n\tswitch (length) {\r\n\t\tcase 1:\r\n\t\t\ttarget[position++] = 0xd4\r\n\t\t\tbreak\r\n\t\tcase 2:\r\n\t\t\ttarget[position++] = 0xd5\r\n\t\t\tbreak\r\n\t\tcase 4:\r\n\t\t\ttarget[position++] = 0xd6\r\n\t\t\tbreak\r\n\t\tcase 8:\r\n\t\t\ttarget[position++] = 0xd7\r\n\t\t\tbreak\r\n\t\tcase 16:\r\n\t\t\ttarget[position++] = 0xd8\r\n\t\t\tbreak\r\n\t\tdefault:\r\n\t\t\tif (length < 0x100) {\r\n\t\t\t\ttarget[position++] = 0xc7\r\n\t\t\t\ttarget[position++] = length\r\n\t\t\t} else if (length < 0x10000) {\r\n\t\t\t\ttarget[position++] = 0xc8\r\n\t\t\t\ttarget[position++] = length >> 8\r\n\t\t\t\ttarget[position++] = length & 0xff\r\n\t\t\t} else {\r\n\t\t\t\ttarget[position++] = 0xc9\r\n\t\t\t\ttarget[position++] = length >> 24\r\n\t\t\t\ttarget[position++] = (length >> 16) & 0xff\r\n\t\t\t\ttarget[position++] = (length >> 8) & 0xff\r\n\t\t\t\ttarget[position++] = length & 0xff\r\n\t\t\t}\r\n\t}\r\n\ttarget[position++] = type\r\n\ttarget.set(result, position)\r\n\tposition += length\r\n\treturn position\r\n}\r\n\r\nfunction insertIds(serialized, idsToInsert) {\r\n\t// insert the ids that need to be referenced for structured clones\r\n\tlet nextId\r\n\tlet distanceToMove = idsToInsert.length * 6\r\n\tlet lastEnd = serialized.length - distanceToMove\r\n\tidsToInsert.sort((a, b) => a.offset > b.offset ? 1 : -1)\r\n\twhile (nextId = idsToInsert.pop()) {\r\n\t\tlet offset = nextId.offset\r\n\t\tlet id = nextId.id\r\n\t\tserialized.copyWithin(offset + distanceToMove, offset, lastEnd)\r\n\t\tdistanceToMove -= 6\r\n\t\tlet position = offset + distanceToMove\r\n\t\tserialized[position++] = 0xd6\r\n\t\tserialized[position++] = 0x69 // 'i'\r\n\t\tserialized[position++] = id >> 24\r\n\t\tserialized[position++] = (id >> 16) & 0xff\r\n\t\tserialized[position++] = (id >> 8) & 0xff\r\n\t\tserialized[position++] = id & 0xff\r\n\t\tlastEnd = offset\r\n\t}\r\n\treturn serialized\r\n}\r\n\r\nfunction writeBundles(start, pack) {\r\n\ttargetView.setUint32(bundledStrings.position + start, position - bundledStrings.position - start)\r\n\tlet writeStrings = bundledStrings\r\n\tbundledStrings = null\r\n\tlet startPosition = position\r\n\tpack(writeStrings[0])\r\n\tpack(writeStrings[1])\r\n}\r\n\r\nexport function addExtension(extension) {\r\n\tif (extension.Class) {\r\n\t\tif (!extension.pack && !extension.write)\r\n\t\t\tthrow new Error('Extension has no pack or write function')\r\n\t\tif (extension.pack && !extension.type)\r\n\t\t\tthrow new Error('Extension has no type (numeric code to identify the extension)')\r\n\t\textensionClasses.unshift(extension.Class)\r\n\t\textensions.unshift(extension)\r\n\t}\r\n\tunpackAddExtension(extension)\r\n}\r\n\r\nlet defaultPackr = new Packr({ useRecords: false })\r\nexport const pack = defaultPackr.pack\r\nexport const encode = defaultPackr.pack\r\nexport const Encoder = Packr\r\nexport { FLOAT32_OPTIONS } from './unpack.js'\r\nimport { FLOAT32_OPTIONS } from './unpack.js'\r\nexport const { NEVER, ALWAYS, DECIMAL_ROUND, DECIMAL_FIT } = FLOAT32_OPTIONS\r\nexport const REUSE_BUFFER_MODE = 512\r\nexport const RESET_BUFFER_MODE = 1024\r\n","\"use strict\"\r\nvar decoder\r\ntry {\r\n\tdecoder = new TextDecoder()\r\n} catch(error) {}\r\nvar src\r\nvar srcEnd\r\nvar position = 0\r\nvar alreadySet\r\nconst EMPTY_ARRAY = []\r\nvar strings = EMPTY_ARRAY\r\nvar stringPosition = 0\r\nvar currentUnpackr = {}\r\nvar currentStructures\r\nvar srcString\r\nvar srcStringStart = 0\r\nvar srcStringEnd = 0\r\nvar bundledStrings\r\nvar referenceMap\r\nvar currentExtensions = []\r\nvar dataView\r\nvar defaultOptions = {\r\n\tuseRecords: false,\r\n\tmapsAsObjects: true\r\n}\r\nexport class C1Type {}\r\nexport const C1 = new C1Type()\r\nC1.name = 'MessagePack 0xC1'\r\nvar sequentialMode = false\r\nvar inlineObjectReadThreshold = 2\r\ntry {\r\n\tnew Function('')\r\n} catch(error) {\r\n\t// if eval variants are not supported, do not create inline object readers ever\r\n\tinlineObjectReadThreshold = Infinity\r\n}\r\n\r\nexport class Unpackr {\r\n\tconstructor(options) {\r\n\t\tif (options) {\r\n\t\t\tif (options.useRecords === false && options.mapsAsObjects === undefined)\r\n\t\t\t\toptions.mapsAsObjects = true\r\n\t\t\tif (options.structures)\r\n\t\t\t\toptions.structures.sharedLength = options.structures.length\r\n\t\t\telse if (options.getStructures) {\r\n\t\t\t\t(options.structures = []).uninitialized = true // this is what we use to denote an uninitialized structures\r\n\t\t\t\toptions.structures.sharedLength = 0\r\n\t\t\t}\r\n\t\t}\r\n\t\tObject.assign(this, options)\r\n\t}\r\n\tunpack(source, end) {\r\n\t\tif (src) {\r\n\t\t\t// re-entrant execution, save the state and restore it after we do this unpack\r\n\t\t\treturn saveState(() => {\r\n\t\t\t\tclearSource()\r\n\t\t\t\treturn this ? this.unpack(source, end) : Unpackr.prototype.unpack.call(defaultOptions, source, end)\r\n\t\t\t})\r\n\t\t}\r\n\t\tsrcEnd = end > -1 ? end : source.length\r\n\t\tposition = 0\r\n\t\tstringPosition = 0\r\n\t\tsrcStringEnd = 0\r\n\t\tsrcString = null\r\n\t\tstrings = EMPTY_ARRAY\r\n\t\tbundledStrings = null\r\n\t\tsrc = source\r\n\t\t// this provides cached access to the data view for a buffer if it is getting reused, which is a recommend\r\n\t\t// technique for getting data from a database where it can be copied into an existing buffer instead of creating\r\n\t\t// new ones\r\n\t\ttry {\r\n\t\t\tdataView = source.dataView || (source.dataView = new DataView(source.buffer, source.byteOffset, source.byteLength))\r\n\t\t} catch(error) {\r\n\t\t\t// if it doesn't have a buffer, maybe it is the wrong type of object\r\n\t\t\tsrc = null\r\n\t\t\tif (source instanceof Uint8Array)\r\n\t\t\t\tthrow error\r\n\t\t\tthrow new Error('Source must be a Uint8Array or Buffer but was a ' + ((source && typeof source == 'object') ? source.constructor.name : typeof source))\r\n\t\t}\r\n\t\tif (this instanceof Unpackr) {\r\n\t\t\tcurrentUnpackr = this\r\n\t\t\tif (this.structures) {\r\n\t\t\t\tcurrentStructures = this.structures\r\n\t\t\t\treturn checkedRead()\r\n\t\t\t} else if (!currentStructures || currentStructures.length > 0) {\r\n\t\t\t\tcurrentStructures = []\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tcurrentUnpackr = defaultOptions\r\n\t\t\tif (!currentStructures || currentStructures.length > 0)\r\n\t\t\t\tcurrentStructures = []\r\n\t\t}\r\n\t\treturn checkedRead()\r\n\t}\r\n\tunpackMultiple(source, forEach) {\r\n\t\tlet values, lastPosition = 0\r\n\t\ttry {\r\n\t\t\tsequentialMode = true\r\n\t\t\tlet size = source.length\r\n\t\t\tlet value = this ? this.unpack(source, size) : defaultUnpackr.unpack(source, size)\r\n\t\t\tif (forEach) {\r\n\t\t\t\tforEach(value)\r\n\t\t\t\twhile(position < size) {\r\n\t\t\t\t\tlastPosition = position\r\n\t\t\t\t\tif (forEach(checkedRead()) === false) {\r\n\t\t\t\t\t\treturn\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tvalues = [ value ]\r\n\t\t\t\twhile(position < size) {\r\n\t\t\t\t\tlastPosition = position\r\n\t\t\t\t\tvalues.push(checkedRead())\r\n\t\t\t\t}\r\n\t\t\t\treturn values\r\n\t\t\t}\r\n\t\t} catch(error) {\r\n\t\t\terror.lastPosition = lastPosition\r\n\t\t\terror.values = values\r\n\t\t\tthrow error\r\n\t\t} finally {\r\n\t\t\tsequentialMode = false\r\n\t\t\tclearSource()\r\n\t\t}\r\n\t}\r\n\t_mergeStructures(loadedStructures, existingStructures) {\r\n\t\tloadedStructures = loadedStructures || []\r\n\t\tfor (let i = 0, l = loadedStructures.length; i < l; i++) {\r\n\t\t\tlet structure = loadedStructures[i]\r\n\t\t\tif (structure) {\r\n\t\t\t\tstructure.isShared = true\r\n\t\t\t\tif (i >= 32)\r\n\t\t\t\t\tstructure.highByte = (i - 32) >> 5\r\n\t\t\t}\r\n\t\t}\r\n\t\tloadedStructures.sharedLength = loadedStructures.length\r\n\t\tfor (let id in existingStructures || []) {\r\n\t\t\tif (id >= 0) {\r\n\t\t\t\tlet structure = loadedStructures[id]\r\n\t\t\t\tlet existing = existingStructures[id]\r\n\t\t\t\tif (existing) {\r\n\t\t\t\t\tif (structure)\r\n\t\t\t\t\t\t(loadedStructures.restoreStructures || (loadedStructures.restoreStructures = []))[id] = structure\r\n\t\t\t\t\tloadedStructures[id] = existing\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn this.structures = loadedStructures\r\n\t}\r\n\tdecode(source, end) {\r\n\t\treturn this.unpack(source, end)\r\n\t}\r\n}\r\nexport function getPosition() {\r\n\treturn position\r\n}\r\nexport function checkedRead() {\r\n\ttry {\r\n\t\tif (!currentUnpackr.trusted && !sequentialMode) {\r\n\t\t\tlet sharedLength = currentStructures.sharedLength || 0\r\n\t\t\tif (sharedLength < currentStructures.length)\r\n\t\t\t\tcurrentStructures.length = sharedLength\r\n\t\t}\r\n\t\tlet result = read()\r\n\t\tif (bundledStrings) // bundled strings to skip past\r\n\t\t\tposition = bundledStrings.postBundlePosition\r\n\r\n\t\tif (position == srcEnd) {\r\n\t\t\t// finished reading this source, cleanup references\r\n\t\t\tif (currentStructures.restoreStructures)\r\n\t\t\t\trestoreStructures()\r\n\t\t\tcurrentStructures = null\r\n\t\t\tsrc = null\r\n\t\t\tif (referenceMap)\r\n\t\t\t\treferenceMap = null\r\n\t\t} else if (position > srcEnd) {\r\n\t\t\t// over read\r\n\t\t\tlet error = new Error('Unexpected end of MessagePack data')\r\n\t\t\terror.incomplete = true\r\n\t\t\tthrow error\r\n\t\t} else if (!sequentialMode) {\r\n\t\t\tthrow new Error('Data read, but end of buffer not reached')\r\n\t\t}\r\n\t\t// else more to read, but we are reading sequentially, so don't clear source yet\r\n\t\treturn result\r\n\t} catch(error) {\r\n\t\tif (currentStructures.restoreStructures)\r\n\t\t\trestoreStructures()\r\n\t\tclearSource()\r\n\t\tif (error instanceof RangeError || error.message.startsWith('Unexpected end of buffer')) {\r\n\t\t\terror.incomplete = true\r\n\t\t}\r\n\t\tthrow error\r\n\t}\r\n}\r\n\r\nfunction restoreStructures() {\r\n\tfor (let id in currentStructures.restoreStructures) {\r\n\t\tcurrentStructures[id] = currentStructures.restoreStructures[id]\r\n\t}\r\n\tcurrentStructures.restoreStructures = null\r\n}\r\n\r\nexport function read() {\r\n\tlet token = src[position++]\r\n\tif (token < 0xa0) {\r\n\t\tif (token < 0x80) {\r\n\t\t\tif (token < 0x40)\r\n\t\t\t\treturn token\r\n\t\t\telse {\r\n\t\t\t\tlet structure = currentStructures[token & 0x3f] ||\r\n\t\t\t\t\tcurrentUnpackr.getStructures && loadStructures()[token & 0x3f]\r\n\t\t\t\tif (structure) {\r\n\t\t\t\t\tif (!structure.read) {\r\n\t\t\t\t\t\tstructure.read = createStructureReader(structure, token & 0x3f)\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn structure.read()\r\n\t\t\t\t} else\r\n\t\t\t\t\treturn token\r\n\t\t\t}\r\n\t\t} else if (token < 0x90) {\r\n\t\t\t// map\r\n\t\t\ttoken -= 0x80\r\n\t\t\tif (currentUnpackr.mapsAsObjects) {\r\n\t\t\t\tlet object = {}\r\n\t\t\t\tfor (let i = 0; i < token; i++) {\r\n\t\t\t\t\tobject[readKey()] = read()\r\n\t\t\t\t}\r\n\t\t\t\treturn object\r\n\t\t\t} else {\r\n\t\t\t\tlet map = new Map()\r\n\t\t\t\tfor (let i = 0; i < token; i++) {\r\n\t\t\t\t\tmap.set(read(), read())\r\n\t\t\t\t}\r\n\t\t\t\treturn map\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\ttoken -= 0x90\r\n\t\t\tlet array = new Array(token)\r\n\t\t\tfor (let i = 0; i < token; i++) {\r\n\t\t\t\tarray[i] = read()\r\n\t\t\t}\r\n\t\t\treturn array\r\n\t\t}\r\n\t} else if (token < 0xc0) {\r\n\t\t// fixstr\r\n\t\tlet length = token - 0xa0\r\n\t\tif (srcStringEnd >= position) {\r\n\t\t\treturn srcString.slice(position - srcStringStart, (position += length) - srcStringStart)\r\n\t\t}\r\n\t\tif (srcStringEnd == 0 && srcEnd < 140) {\r\n\t\t\t// for small blocks, avoiding the overhead of the extract call is helpful\r\n\t\t\tlet string = length < 16 ? shortStringInJS(length) : longStringInJS(length)\r\n\t\t\tif (string != null)\r\n\t\t\t\treturn string\r\n\t\t}\r\n\t\treturn readFixedString(length)\r\n\t} else {\r\n\t\tlet value\r\n\t\tswitch (token) {\r\n\t\t\tcase 0xc0: return null\r\n\t\t\tcase 0xc1:\r\n\t\t\t\tif (bundledStrings) {\r\n\t\t\t\t\tvalue = read() // followed by the length of the string in characters (not bytes!)\r\n\t\t\t\t\tif (value > 0)\r\n\t\t\t\t\t\treturn bundledStrings[1].slice(bundledStrings.position1, bundledStrings.position1 += value)\r\n\t\t\t\t\telse\r\n\t\t\t\t\t\treturn bundledStrings[0].slice(bundledStrings.position0, bundledStrings.position0 -= value)\r\n\t\t\t\t}\r\n\t\t\t\treturn C1; // \"never-used\", return special object to denote that\r\n\t\t\tcase 0xc2: return false\r\n\t\t\tcase 0xc3: return true\r\n\t\t\tcase 0xc4:\r\n\t\t\t\t// bin 8\r\n\t\t\t\treturn readBin(src[position++])\r\n\t\t\tcase 0xc5:\r\n\t\t\t\t// bin 16\r\n\t\t\t\tvalue = dataView.getUint16(position)\r\n\t\t\t\tposition += 2\r\n\t\t\t\treturn readBin(value)\r\n\t\t\tcase 0xc6:\r\n\t\t\t\t// bin 32\r\n\t\t\t\tvalue = dataView.getUint32(position)\r\n\t\t\t\tposition += 4\r\n\t\t\t\treturn readBin(value)\r\n\t\t\tcase 0xc7:\r\n\t\t\t\t// ext 8\r\n\t\t\t\treturn readExt(src[position++])\r\n\t\t\tcase 0xc8:\r\n\t\t\t\t// ext 16\r\n\t\t\t\tvalue = dataView.getUint16(position)\r\n\t\t\t\tposition += 2\r\n\t\t\t\treturn readExt(value)\r\n\t\t\tcase 0xc9:\r\n\t\t\t\t// ext 32\r\n\t\t\t\tvalue = dataView.getUint32(position)\r\n\t\t\t\tposition += 4\r\n\t\t\t\treturn readExt(value)\r\n\t\t\tcase 0xca:\r\n\t\t\t\tvalue = dataView.getFloat32(position)\r\n\t\t\t\tif (currentUnpackr.useFloat32 > 2) {\r\n\t\t\t\t\t// this does rounding of numbers that were encoded in 32-bit float to nearest significant decimal digit that could be preserved\r\n\t\t\t\t\tlet multiplier = mult10[((src[position] & 0x7f) << 1) | (src[position + 1] >> 7)]\r\n\t\t\t\t\tposition += 4\r\n\t\t\t\t\treturn ((multiplier * value + (value > 0 ? 0.5 : -0.5)) >> 0) / multiplier\r\n\t\t\t\t}\r\n\t\t\t\tposition += 4\r\n\t\t\t\treturn value\r\n\t\t\tcase 0xcb:\r\n\t\t\t\tvalue = dataView.getFloat64(position)\r\n\t\t\t\tposition += 8\r\n\t\t\t\treturn value\r\n\t\t\t// uint handlers\r\n\t\t\tcase 0xcc:\r\n\t\t\t\treturn src[position++]\r\n\t\t\tcase 0xcd:\r\n\t\t\t\tvalue = dataView.getUint16(position)\r\n\t\t\t\tposition += 2\r\n\t\t\t\treturn value\r\n\t\t\tcase 0xce:\r\n\t\t\t\tvalue = dataView.getUint32(position)\r\n\t\t\t\tposition += 4\r\n\t\t\t\treturn value\r\n\t\t\tcase 0xcf:\r\n\t\t\t\tif (currentUnpackr.int64AsNumber) {\r\n\t\t\t\t\tvalue = dataView.getUint32(position) * 0x100000000\r\n\t\t\t\t\tvalue += dataView.getUint32(position + 4)\r\n\t\t\t\t} else\r\n\t\t\t\t\tvalue = dataView.getBigUint64(position)\r\n\t\t\t\tposition += 8\r\n\t\t\t\treturn value\r\n\r\n\t\t\t// int handlers\r\n\t\t\tcase 0xd0:\r\n\t\t\t\treturn dataView.getInt8(position++)\r\n\t\t\tcase 0xd1:\r\n\t\t\t\tvalue = dataView.getInt16(position)\r\n\t\t\t\tposition += 2\r\n\t\t\t\treturn value\r\n\t\t\tcase 0xd2:\r\n\t\t\t\tvalue = dataView.getInt32(position)\r\n\t\t\t\tposition += 4\r\n\t\t\t\treturn value\r\n\t\t\tcase 0xd3:\r\n\t\t\t\tif (currentUnpackr.int64AsNumber) {\r\n\t\t\t\t\tvalue = dataView.getInt32(position) * 0x100000000\r\n\t\t\t\t\tvalue += dataView.getUint32(position + 4)\r\n\t\t\t\t} else\r\n\t\t\t\t\tvalue = dataView.getBigInt64(position)\r\n\t\t\t\tposition += 8\r\n\t\t\t\treturn value\r\n\r\n\t\t\tcase 0xd4:\r\n\t\t\t\t// fixext 1\r\n\t\t\t\tvalue = src[position++]\r\n\t\t\t\tif (value == 0x72) {\r\n\t\t\t\t\treturn recordDefinition(src[position++] & 0x3f)\r\n\t\t\t\t} else {\r\n\t\t\t\t\tlet extension = currentExtensions[value]\r\n\t\t\t\t\tif (extension) {\r\n\t\t\t\t\t\tif (extension.read) {\r\n\t\t\t\t\t\t\tposition++ // skip filler byte\r\n\t\t\t\t\t\t\treturn extension.read(read())\r\n\t\t\t\t\t\t} else if (extension.noBuffer) {\r\n\t\t\t\t\t\t\tposition++ // skip filler byte\r\n\t\t\t\t\t\t\treturn extension()\r\n\t\t\t\t\t\t} else\r\n\t\t\t\t\t\t\treturn extension(src.subarray(position, ++position))\r\n\t\t\t\t\t} else\r\n\t\t\t\t\t\tthrow new Error('Unknown extension ' + value)\r\n\t\t\t\t}\r\n\t\t\tcase 0xd5:\r\n\t\t\t\t// fixext 2\r\n\t\t\t\tvalue = src[position]\r\n\t\t\t\tif (value == 0x72) {\r\n\t\t\t\t\tposition++\r\n\t\t\t\t\treturn recordDefinition(src[position++] & 0x3f, src[position++])\r\n\t\t\t\t} else\r\n\t\t\t\t\treturn readExt(2)\r\n\t\t\tcase 0xd6:\r\n\t\t\t\t// fixext 4\r\n\t\t\t\treturn readExt(4)\r\n\t\t\tcase 0xd7:\r\n\t\t\t\t// fixext 8\r\n\t\t\t\treturn readExt(8)\r\n\t\t\tcase 0xd8:\r\n\t\t\t\t// fixext 16\r\n\t\t\t\treturn readExt(16)\r\n\t\t\tcase 0xd9:\r\n\t\t\t// str 8\r\n\t\t\t\tvalue = src[position++]\r\n\t\t\t\tif (srcStringEnd >= position) {\r\n\t\t\t\t\treturn srcString.slice(position - srcStringStart, (position += value) - srcStringStart)\r\n\t\t\t\t}\r\n\t\t\t\treturn readString8(value)\r\n\t\t\tcase 0xda:\r\n\t\t\t// str 16\r\n\t\t\t\tvalue = dataView.getUint16(position)\r\n\t\t\t\tposition += 2\r\n\t\t\t\tif (srcStringEnd >= position) {\r\n\t\t\t\t\treturn srcString.slice(position - srcStringStart, (position += value) - srcStringStart)\r\n\t\t\t\t}\r\n\t\t\t\treturn readString16(value)\r\n\t\t\tcase 0xdb:\r\n\t\t\t// str 32\r\n\t\t\t\tvalue = dataView.getUint32(position)\r\n\t\t\t\tposition += 4\r\n\t\t\t\tif (srcStringEnd >= position) {\r\n\t\t\t\t\treturn srcString.slice(position - srcStringStart, (position += value) - srcStringStart)\r\n\t\t\t\t}\r\n\t\t\t\treturn readString32(value)\r\n\t\t\tcase 0xdc:\r\n\t\t\t// array 16\r\n\t\t\t\tvalue = dataView.getUint16(position)\r\n\t\t\t\tposition += 2\r\n\t\t\t\treturn readArray(value)\r\n\t\t\tcase 0xdd:\r\n\t\t\t// array 32\r\n\t\t\t\tvalue = dataView.getUint32(position)\r\n\t\t\t\tposition += 4\r\n\t\t\t\treturn readArray(value)\r\n\t\t\tcase 0xde:\r\n\t\t\t// map 16\r\n\t\t\t\tvalue = dataView.getUint16(position)\r\n\t\t\t\tposition += 2\r\n\t\t\t\treturn readMap(value)\r\n\t\t\tcase 0xdf:\r\n\t\t\t// map 32\r\n\t\t\t\tvalue = dataView.getUint32(position)\r\n\t\t\t\tposition += 4\r\n\t\t\t\treturn readMap(value)\r\n\t\t\tdefault: // negative int\r\n\t\t\t\tif (token >= 0xe0)\r\n\t\t\t\t\treturn token - 0x100\r\n\t\t\t\tif (token === undefined) {\r\n\t\t\t\t\tlet error = new Error('Unexpected end of MessagePack data')\r\n\t\t\t\t\terror.incomplete = true\r\n\t\t\t\t\tthrow error\r\n\t\t\t\t}\r\n\t\t\t\tthrow new Error('Unknown MessagePack token ' + token)\r\n\r\n\t\t}\r\n\t}\r\n}\r\nconst validName = /^[a-zA-Z_$][a-zA-Z\\d_$]*$/\r\nfunction createStructureReader(structure, firstId) {\r\n\tfunction readObject() {\r\n\t\t// This initial function is quick to instantiate, but runs slower. After several iterations pay the cost to build the faster function\r\n\t\tif (readObject.count++ > inlineObjectReadThreshold) {\r\n\t\t\tlet readObject = structure.read = (new Function('r', 'return function(){return {' + structure.map(key => validName.test(key) ? key + ':r()' : ('[' + JSON.stringify(key) + ']:r()')).join(',') + '}}'))(read)\r\n\t\t\tif (structure.highByte === 0)\r\n\t\t\t\tstructure.read = createSecondByteReader(firstId, structure.read)\r\n\t\t\treturn readObject() // second byte is already read, if there is one so immediately read object\r\n\t\t}\r\n\t\tlet object = {}\r\n\t\tfor (let i = 0, l = structure.length; i < l; i++) {\r\n\t\t\tlet key = structure[i]\r\n\t\t\tobject[key] = read()\r\n\t\t}\r\n\t\treturn object\r\n\t}\r\n\treadObject.count = 0\r\n\tif (structure.highByte === 0) {\r\n\t\treturn createSecondByteReader(firstId, readObject)\r\n\t}\r\n\treturn readObject\r\n}\r\n\r\nconst createSecondByteReader = (firstId, read0) => {\r\n\treturn function() {\r\n\t\tlet highByte = src[position++]\r\n\t\tif (highByte === 0)\r\n\t\t\treturn read0()\r\n\t\tlet id = firstId < 32 ? -(firstId + (highByte << 5)) : firstId + (highByte << 5)\r\n\t\tlet structure = currentStructures[id] || loadStructures()[id]\r\n\t\tif (!structure) {\r\n\t\t\tthrow new Error('Record id is not defined for ' + id)\r\n\t\t}\r\n\t\tif (!structure.read)\r\n\t\t\tstructure.read = createStructureReader(structure, firstId)\r\n\t\treturn structure.read()\r\n\t}\r\n}\r\n\r\nfunction loadStructures() {\r\n\tlet loadedStructures = saveState(() => {\r\n\t\t// save the state in case getStructures modifies our buffer\r\n\t\tsrc = null\r\n\t\treturn currentUnpackr.getStructures()\r\n\t})\r\n\treturn currentStructures = currentUnpackr._mergeStructures(loadedStructures, currentStructures)\r\n}\r\n\r\nvar readFixedString = readStringJS\r\nvar readString8 = readStringJS\r\nvar readString16 = readStringJS\r\nvar readString32 = readStringJS\r\nexport let isNativeAccelerationEnabled = false\r\n\r\nexport function setExtractor(extractStrings) {\r\n\tisNativeAccelerationEnabled = true\r\n\treadFixedString = readString(1)\r\n\treadString8 = readString(2)\r\n\treadString16 = readString(3)\r\n\treadString32 = readString(5)\r\n\tfunction readString(headerLength) {\r\n\t\treturn function readString(length) {\r\n\t\t\tlet string = strings[stringPosition++]\r\n\t\t\tif (string == null) {\r\n\t\t\t\tif (bundledStrings)\r\n\t\t\t\t\treturn readStringJS(length)\r\n\t\t\t\tlet extraction = extractStrings(position - headerLength, srcEnd, src)\r\n\t\t\t\tif (typeof extraction == 'string') {\r\n\t\t\t\t\tstring = extraction\r\n\t\t\t\t\tstrings = EMPTY_ARRAY\r\n\t\t\t\t} else {\r\n\t\t\t\t\tstrings = extraction\r\n\t\t\t\t\tstringPosition = 1\r\n\t\t\t\t\tsrcStringEnd = 1 // even if a utf-8 string was decoded, must indicate we are in the midst of extracted strings and can't skip strings\r\n\t\t\t\t\tstring = strings[0]\r\n\t\t\t\t\tif (string === undefined)\r\n\t\t\t\t\t\tthrow new Error('Unexpected end of buffer')\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tlet srcStringLength = string.length\r\n\t\t\tif (srcStringLength <= length) {\r\n\t\t\t\tposition += length\r\n\t\t\t\treturn string\r\n\t\t\t}\r\n\t\t\tsrcString = string\r\n\t\t\tsrcStringStart = position\r\n\t\t\tsrcStringEnd = position + srcStringLength\r\n\t\t\tposition += length\r\n\t\t\treturn string.slice(0, length) // we know we just want the beginning\r\n\t\t}\r\n\t}\r\n}\r\nfunction readStringJS(length) {\r\n\tlet result\r\n\tif (length < 16) {\r\n\t\tif (result = shortStringInJS(length))\r\n\t\t\treturn result\r\n\t}\r\n\tif (length > 64 && decoder)\r\n\t\treturn decoder.decode(src.subarray(position, position += length))\r\n\tconst end = position + length\r\n\tconst units = []\r\n\tresult = ''\r\n\twhile (position < end) {\r\n\t\tconst byte1 = src[position++]\r\n\t\tif ((byte1 & 0x80) === 0) {\r\n\t\t\t// 1 byte\r\n\t\t\tunits.push(byte1)\r\n\t\t} else if ((byte1 & 0xe0) === 0xc0) {\r\n\t\t\t// 2 bytes\r\n\t\t\tconst byte2 = src[position++] & 0x3f\r\n\t\t\tunits.push(((byte1 & 0x1f) << 6) | byte2)\r\n\t\t} else if ((byte1 & 0xf0) === 0xe0) {\r\n\t\t\t// 3 bytes\r\n\t\t\tconst byte2 = src[position++] & 0x3f\r\n\t\t\tconst byte3 = src[position++] & 0x3f\r\n\t\t\tunits.push(((byte1 & 0x1f) << 12) | (byte2 << 6) | byte3)\r\n\t\t} else if ((byte1 & 0xf8) === 0xf0) {\r\n\t\t\t// 4 bytes\r\n\t\t\tconst byte2 = src[position++] & 0x3f\r\n\t\t\tconst byte3 = src[position++] & 0x3f\r\n\t\t\tconst byte4 = src[position++] & 0x3f\r\n\t\t\tlet unit = ((byte1 & 0x07) << 0x12) | (byte2 << 0x0c) | (byte3 << 0x06) | byte4\r\n\t\t\tif (unit > 0xffff) {\r\n\t\t\t\tunit -= 0x10000\r\n\t\t\t\tunits.push(((unit >>> 10) & 0x3ff) | 0xd800)\r\n\t\t\t\tunit = 0xdc00 | (unit & 0x3ff)\r\n\t\t\t}\r\n\t\t\tunits.push(unit)\r\n\t\t} else {\r\n\t\t\tunits.push(byte1)\r\n\t\t}\r\n\r\n\t\tif (units.length >= 0x1000) {\r\n\t\t\tresult += fromCharCode.apply(String, units)\r\n\t\t\tunits.length = 0\r\n\t\t}\r\n\t}\r\n\r\n\tif (units.length > 0) {\r\n\t\tresult += fromCharCode.apply(String, units)\r\n\t}\r\n\r\n\treturn result\r\n}\r\n\r\nfunction readArray(length) {\r\n\tlet array = new Array(length)\r\n\tfor (let i = 0; i < length; i++) {\r\n\t\tarray[i] = read()\r\n\t}\r\n\treturn array\r\n}\r\n\r\nfunction readMap(length) {\r\n\tif (currentUnpackr.mapsAsObjects) {\r\n\t\tlet object = {}\r\n\t\tfor (let i = 0; i < length; i++) {\r\n\t\t\tobject[readKey()] = read()\r\n\t\t}\r\n\t\treturn object\r\n\t} else {\r\n\t\tlet map = new Map()\r\n\t\tfor (let i = 0; i < length; i++) {\r\n\t\t\tmap.set(read(), read())\r\n\t\t}\r\n\t\treturn map\r\n\t}\r\n}\r\n\r\nvar fromCharCode = String.fromCharCode\r\nfunction longStringInJS(length) {\r\n\tlet start = position\r\n\tlet bytes = new Array(length)\r\n\tfor (let i = 0; i < length; i++) {\r\n\t\tconst byte = src[position++];\r\n\t\tif ((byte & 0x80) > 0) {\r\n\t\t\tposition = start\r\n    \t\t\treturn\r\n    \t\t}\r\n    \t\tbytes[i] = byte\r\n    \t}\r\n    \treturn fromCharCode.apply(String, bytes)\r\n}\r\nfunction shortStringInJS(length) {\r\n\tif (length < 4) {\r\n\t\tif (length < 2) {\r\n\t\t\tif (length === 0)\r\n\t\t\t\treturn ''\r\n\t\t\telse {\r\n\t\t\t\tlet a = src[position++]\r\n\t\t\t\tif ((a & 0x80) > 1) {\r\n\t\t\t\t\tposition -= 1\r\n\t\t\t\t\treturn\r\n\t\t\t\t}\r\n\t\t\t\treturn fromCharCode(a)\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tlet a = src[position++]\r\n\t\t\tlet b = src[position++]\r\n\t\t\tif ((a & 0x80) > 0 || (b & 0x80) > 0) {\r\n\t\t\t\tposition -= 2\r\n\t\t\t\treturn\r\n\t\t\t}\r\n\t\t\tif (length < 3)\r\n\t\t\t\treturn fromCharCode(a, b)\r\n\t\t\tlet c = src[position++]\r\n\t\t\tif ((c & 0x80) > 0) {\r\n\t\t\t\tposition -= 3\r\n\t\t\t\treturn\r\n\t\t\t}\r\n\t\t\treturn fromCharCode(a, b, c)\r\n\t\t}\r\n\t} else {\r\n\t\tlet a = src[position++]\r\n\t\tlet b = src[position++]\r\n\t\tlet c = src[position++]\r\n\t\tlet d = src[position++]\r\n\t\tif ((a & 0x80) > 0 || (b & 0x80) > 0 || (c & 0x80) > 0 || (d & 0x80) > 0) {\r\n\t\t\tposition -= 4\r\n\t\t\treturn\r\n\t\t}\r\n\t\tif (length < 6) {\r\n\t\t\tif (length === 4)\r\n\t\t\t\treturn fromCharCode(a, b, c, d)\r\n\t\t\telse {\r\n\t\t\t\tlet e = src[position++]\r\n\t\t\t\tif ((e & 0x80) > 0) {\r\n\t\t\t\t\tposition -= 5\r\n\t\t\t\t\treturn\r\n\t\t\t\t}\r\n\t\t\t\treturn fromCharCode(a, b, c, d, e)\r\n\t\t\t}\r\n\t\t} else if (length < 8) {\r\n\t\t\tlet e = src[position++]\r\n\t\t\tlet f = src[position++]\r\n\t\t\tif ((e & 0x80) > 0 || (f & 0x80) > 0) {\r\n\t\t\t\tposition -= 6\r\n\t\t\t\treturn\r\n\t\t\t}\r\n\t\t\tif (length < 7)\r\n\t\t\t\treturn fromCharCode(a, b, c, d, e, f)\r\n\t\t\tlet g = src[position++]\r\n\t\t\tif ((g & 0x80) > 0) {\r\n\t\t\t\tposition -= 7\r\n\t\t\t\treturn\r\n\t\t\t}\r\n\t\t\treturn fromCharCode(a, b, c, d, e, f, g)\r\n\t\t} else {\r\n\t\t\tlet e = src[position++]\r\n\t\t\tlet f = src[position++]\r\n\t\t\tlet g = src[position++]\r\n\t\t\tlet h = src[position++]\r\n\t\t\tif ((e & 0x80) > 0 || (f & 0x80) > 0 || (g & 0x80) > 0 || (h & 0x80) > 0) {\r\n\t\t\t\tposition -= 8\r\n\t\t\t\treturn\r\n\t\t\t}\r\n\t\t\tif (length < 10) {\r\n\t\t\t\tif (length === 8)\r\n\t\t\t\t\treturn fromCharCode(a, b, c, d, e, f, g, h)\r\n\t\t\t\telse {\r\n\t\t\t\t\tlet i = src[position++]\r\n\t\t\t\t\tif ((i & 0x80) > 0) {\r\n\t\t\t\t\t\tposition -= 9\r\n\t\t\t\t\t\treturn\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn fromCharCode(a, b, c, d, e, f, g, h, i)\r\n\t\t\t\t}\r\n\t\t\t} else if (length < 12) {\r\n\t\t\t\tlet i = src[position++]\r\n\t\t\t\tlet j = src[position++]\r\n\t\t\t\tif ((i & 0x80) > 0 || (j & 0x80) > 0) {\r\n\t\t\t\t\tposition -= 10\r\n\t\t\t\t\treturn\r\n\t\t\t\t}\r\n\t\t\t\tif (length < 11)\r\n\t\t\t\t\treturn fromCharCode(a, b, c, d, e, f, g, h, i, j)\r\n\t\t\t\tlet k = src[position++]\r\n\t\t\t\tif ((k & 0x80) > 0) {\r\n\t\t\t\t\tposition -= 11\r\n\t\t\t\t\treturn\r\n\t\t\t\t}\r\n\t\t\t\treturn fromCharCode(a, b, c, d, e, f, g, h, i, j, k)\r\n\t\t\t} else {\r\n\t\t\t\tlet i = src[position++]\r\n\t\t\t\tlet j = src[position++]\r\n\t\t\t\tlet k = src[position++]\r\n\t\t\t\tlet l = src[position++]\r\n\t\t\t\tif ((i & 0x80) > 0 || (j & 0x80) > 0 || (k & 0x80) > 0 || (l & 0x80) > 0) {\r\n\t\t\t\t\tposition -= 12\r\n\t\t\t\t\treturn\r\n\t\t\t\t}\r\n\t\t\t\tif (length < 14) {\r\n\t\t\t\t\tif (length === 12)\r\n\t\t\t\t\t\treturn fromCharCode(a, b, c, d, e, f, g, h, i, j, k, l)\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tlet m = src[position++]\r\n\t\t\t\t\t\tif ((m & 0x80) > 0) {\r\n\t\t\t\t\t\t\tposition -= 13\r\n\t\t\t\t\t\t\treturn\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn fromCharCode(a, b, c, d, e, f, g, h, i, j, k, l, m)\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tlet m = src[position++]\r\n\t\t\t\t\tlet n = src[position++]\r\n\t\t\t\t\tif ((m & 0x80) > 0 || (n & 0x80) > 0) {\r\n\t\t\t\t\t\tposition -= 14\r\n\t\t\t\t\t\treturn\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (length < 15)\r\n\t\t\t\t\t\treturn fromCharCode(a, b, c, d, e, f, g, h, i, j, k, l, m, n)\r\n\t\t\t\t\tlet o = src[position++]\r\n\t\t\t\t\tif ((o & 0x80) > 0) {\r\n\t\t\t\t\t\tposition -= 15\r\n\t\t\t\t\t\treturn\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn fromCharCode(a, b, c, d, e, f, g, h, i, j, k, l, m, n, o)\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction readOnlyJSString() {\r\n\tlet token = src[position++]\r\n\tlet length\r\n\tif (token < 0xc0) {\r\n\t\t// fixstr\r\n\t\tlength = token - 0xa0\r\n\t} else {\r\n\t\tswitch(token) {\r\n\t\t\tcase 0xd9:\r\n\t\t\t// str 8\r\n\t\t\t\tlength = src[position++]\r\n\t\t\t\tbreak\r\n\t\t\tcase 0xda:\r\n\t\t\t// str 16\r\n\t\t\t\tlength = dataView.getUint16(position)\r\n\t\t\t\tposition += 2\r\n\t\t\t\tbreak\r\n\t\t\tcase 0xdb:\r\n\t\t\t// str 32\r\n\t\t\t\tlength = dataView.getUint32(position)\r\n\t\t\t\tposition += 4\r\n\t\t\t\tbreak\r\n\t\t\tdefault:\r\n\t\t\t\tthrow new Error('Expected string')\r\n\t\t}\r\n\t}\r\n\treturn readStringJS(length)\r\n}\r\n\r\n\r\nfunction readBin(length) {\r\n\treturn currentUnpackr.copyBuffers ?\r\n\t\t// specifically use the copying slice (not the node one)\r\n\t\tUint8Array.prototype.slice.call(src, position, position += length) :\r\n\t\tsrc.subarray(position, position += length)\r\n}\r\nfunction readExt(length) {\r\n\tlet type = src[position++]\r\n\tif (currentExtensions[type]) {\r\n\t\treturn currentExtensions[type](src.subarray(position, position += length))\r\n\t}\r\n\telse\r\n\t\tthrow new Error('Unknown extension type ' + type)\r\n}\r\n\r\nvar keyCache = new Array(4096)\r\nfunction readKey() {\r\n\tlet length = src[position++]\r\n\tif (length >= 0xa0 && length < 0xc0) {\r\n\t\t// fixstr, potentially use key cache\r\n\t\tlength = length - 0xa0\r\n\t\tif (srcStringEnd >= position) // if it has been extracted, must use it (and faster anyway)\r\n\t\t\treturn srcString.slice(position - srcStringStart, (position += length) - srcStringStart)\r\n\t\telse if (!(srcStringEnd == 0 && srcEnd < 180))\r\n\t\t\treturn readFixedString(length)\r\n\t} else { // not cacheable, go back and do a standard read\r\n\t\tposition--\r\n\t\treturn read()\r\n\t}\r\n\tlet key = ((length << 5) ^ (length > 1 ? dataView.getUint16(position) : length > 0 ? src[position] : 0)) & 0xfff\r\n\tlet entry = keyCache[key]\r\n\tlet checkPosition = position\r\n\tlet end = position + length - 3\r\n\tlet chunk\r\n\tlet i = 0\r\n\tif (entry && entry.bytes == length) {\r\n\t\twhile (checkPosition < end) {\r\n\t\t\tchunk = dataView.getUint32(checkPosition)\r\n\t\t\tif (chunk != entry[i++]) {\r\n\t\t\t\tcheckPosition = 0x70000000\r\n\t\t\t\tbreak\r\n\t\t\t}\r\n\t\t\tcheckPosition += 4\r\n\t\t}\r\n\t\tend += 3\r\n\t\twhile (checkPosition < end) {\r\n\t\t\tchunk = src[checkPosition++]\r\n\t\t\tif (chunk != entry[i++]) {\r\n\t\t\t\tcheckPosition = 0x70000000\r\n\t\t\t\tbreak\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (checkPosition === end) {\r\n\t\t\tposition = checkPosition\r\n\t\t\treturn entry.string\r\n\t\t}\r\n\t\tend -= 3\r\n\t\tcheckPosition = position\r\n\t}\r\n\tentry = []\r\n\tkeyCache[key] = entry\r\n\tentry.bytes = length\r\n\twhile (checkPosition < end) {\r\n\t\tchunk = dataView.getUint32(checkPosition)\r\n\t\tentry.push(chunk)\r\n\t\tcheckPosition += 4\r\n\t}\r\n\tend += 3\r\n\twhile (checkPosition < end) {\r\n\t\tchunk = src[checkPosition++]\r\n\t\tentry.push(chunk)\r\n\t}\r\n\t// for small blocks, avoiding the overhead of the extract call is helpful\r\n\tlet string = length < 16 ? shortStringInJS(length) : longStringInJS(length)\r\n\tif (string != null)\r\n\t\treturn entry.string = string\r\n\treturn entry.string = readFixedString(length)\r\n}\r\n\r\n// the registration of the record definition extension (as \"r\")\r\nconst recordDefinition = (id, highByte) => {\r\n\tvar structure = read()\r\n\tlet firstByte = id\r\n\tif (highByte !== undefined) {\r\n\t\tid = id < 32 ? -((highByte << 5) + id) : ((highByte << 5) + id)\r\n\t\tstructure.highByte = highByte\r\n\t}\r\n\tlet existingStructure = currentStructures[id]\r\n\tif (existingStructure && existingStructure.isShared) {\r\n\t\t(currentStructures.restoreStructures || (currentStructures.restoreStructures = []))[id] = existingStructure\r\n\t}\r\n\tcurrentStructures[id] = structure\r\n\tstructure.read = createStructureReader(structure, firstByte)\r\n\treturn structure.read()\r\n}\r\nvar glbl = typeof self == 'object' ? self : global\r\ncurrentExtensions[0] = () => {} // notepack defines extension 0 to mean undefined, so use that as the default here\r\ncurrentExtensions[0].noBuffer = true\r\n\r\ncurrentExtensions[0x65] = () => {\r\n\tlet data = read()\r\n\treturn (glbl[data[0]] || Error)(data[1])\r\n}\r\n\r\ncurrentExtensions[0x69] = (data) => {\r\n\t// id extension (for structured clones)\r\n\tlet id = dataView.getUint32(position - 4)\r\n\tif (!referenceMap)\r\n\t\treferenceMap = new Map()\r\n\tlet token = src[position]\r\n\tlet target\r\n\t// TODO: handle Maps, Sets, and other types that can cycle; this is complicated, because you potentially need to read\r\n\t// ahead past references to record structure definitions\r\n\tif (token >= 0x90 && token < 0xa0 || token == 0xdc || token == 0xdd)\r\n\t\ttarget = []\r\n\telse\r\n\t\ttarget = {}\r\n\r\n\tlet refEntry = { target } // a placeholder object\r\n\treferenceMap.set(id, refEntry)\r\n\tlet targetProperties = read() // read the next value as the target object to id\r\n\tif (refEntry.used) // there is a cycle, so we have to assign properties to original target\r\n\t\treturn Object.assign(target, targetProperties)\r\n\trefEntry.target = targetProperties // the placeholder wasn't used, replace with the deserialized one\r\n\treturn targetProperties // no cycle, can just use the returned read object\r\n}\r\n\r\ncurrentExtensions[0x70] = (data) => {\r\n\t// pointer extension (for structured clones)\r\n\tlet id = dataView.getUint32(position - 4)\r\n\tlet refEntry = referenceMap.get(id)\r\n\trefEntry.used = true\r\n\treturn refEntry.target\r\n}\r\n\r\ncurrentExtensions[0x73] = () => new Set(read())\r\n\r\nexport const typedArrays = ['Int8','Uint8','Uint8Clamped','Int16','Uint16','Int32','Uint32','Float32','Float64','BigInt64','BigUint64'].map(type => type + 'Array')\r\n\r\ncurrentExtensions[0x74] = (data) => {\r\n\tlet typeCode = data[0]\r\n\tlet typedArrayName = typedArrays[typeCode]\r\n\tif (!typedArrayName)\r\n\t\tthrow new Error('Could not find typed array for code ' + typeCode)\r\n\t// we have to always slice/copy here to get a new ArrayBuffer that is word/byte aligned\r\n\treturn new glbl[typedArrayName](Uint8Array.prototype.slice.call(data, 1).buffer)\r\n}\r\ncurrentExtensions[0x78] = () => {\r\n\tlet data = read()\r\n\treturn new RegExp(data[0], data[1])\r\n}\r\nconst TEMP_BUNDLE = []\r\ncurrentExtensions[0x62] = (data) => {\r\n\tlet dataSize = (data[0] << 24) + (data[1] << 16) + (data[2] << 8) + data[3]\r\n\tlet dataPosition = position\r\n\tposition += dataSize - data.length\r\n\tbundledStrings = TEMP_BUNDLE\r\n\tbundledStrings = [readOnlyJSString(), readOnlyJSString()]\r\n\tbundledStrings.position0 = 0\r\n\tbundledStrings.position1 = 0\r\n\tbundledStrings.postBundlePosition = position\r\n\tposition = dataPosition\r\n\treturn read()\r\n}\r\n\r\ncurrentExtensions[0xff] = (data) => {\r\n\t// 32-bit date extension\r\n\tif (data.length == 4)\r\n\t\treturn new Date((data[0] * 0x1000000 + (data[1] << 16) + (data[2] << 8) + data[3]) * 1000)\r\n\telse if (data.length == 8)\r\n\t\treturn new Date(\r\n\t\t\t((data[0] << 22) + (data[1] << 14) + (data[2] << 6) + (data[3] >> 2)) / 1000000 +\r\n\t\t\t((data[3] & 0x3) * 0x100000000 + data[4] * 0x1000000 + (data[5] << 16) + (data[6] << 8) + data[7]) * 1000)\r\n\telse if (data.length == 12)// TODO: Implement support for negative\r\n\t\treturn new Date(\r\n\t\t\t((data[0] << 24) + (data[1] << 16) + (data[2] << 8) + data[3]) / 1000000 +\r\n\t\t\t(((data[4] & 0x80) ? -0x1000000000000 : 0) + data[6] * 0x10000000000 + data[7] * 0x100000000 + data[8] * 0x1000000 + (data[9] << 16) + (data[10] << 8) + data[11]) * 1000)\r\n\telse\r\n\t\treturn new Date('invalid')\r\n} // notepack defines extension 0 to mean undefined, so use that as the default here\r\n// registration of bulk record definition?\r\n// currentExtensions[0x52] = () =>\r\n\r\nfunction saveState(callback) {\r\n\tlet savedSrcEnd = srcEnd\r\n\tlet savedPosition = position\r\n\tlet savedStringPosition = stringPosition\r\n\tlet savedSrcStringStart = srcStringStart\r\n\tlet savedSrcStringEnd = srcStringEnd\r\n\tlet savedSrcString = srcString\r\n\tlet savedStrings = strings\r\n\tlet savedReferenceMap = referenceMap\r\n\tlet savedBundledStrings = bundledStrings\r\n\r\n\t// TODO: We may need to revisit this if we do more external calls to user code (since it could be slow)\r\n\tlet savedSrc = new Uint8Array(src.slice(0, srcEnd)) // we copy the data in case it changes while external data is processed\r\n\tlet savedStructures = currentStructures\r\n\tlet savedStructuresContents = currentStructures.slice(0, currentStructures.length)\r\n\tlet savedPackr = currentUnpackr\r\n\tlet savedSequentialMode = sequentialMode\r\n\tlet value = callback()\r\n\tsrcEnd = savedSrcEnd\r\n\tposition = savedPosition\r\n\tstringPosition = savedStringPosition\r\n\tsrcStringStart = savedSrcStringStart\r\n\tsrcStringEnd = savedSrcStringEnd\r\n\tsrcString = savedSrcString\r\n\tstrings = savedStrings\r\n\treferenceMap = savedReferenceMap\r\n\tbundledStrings = savedBundledStrings\r\n\tsrc = savedSrc\r\n\tsequentialMode = savedSequentialMode\r\n\tcurrentStructures = savedStructures\r\n\tcurrentStructures.splice(0, currentStructures.length, ...savedStructuresContents)\r\n\tcurrentUnpackr = savedPackr\r\n\tdataView = new DataView(src.buffer, src.byteOffset, src.byteLength)\r\n\treturn value\r\n}\r\nexport function clearSource() {\r\n\tsrc = null\r\n\treferenceMap = null\r\n\tcurrentStructures = null\r\n}\r\n\r\nexport function addExtension(extension) {\r\n\tif (extension.unpack)\r\n\t\tcurrentExtensions[extension.type] = extension.unpack\r\n\telse\r\n\t\tcurrentExtensions[extension.type] = extension\r\n}\r\n\r\nexport const mult10 = new Array(147) // this is a table matching binary exponents to the multiplier to determine significant digit rounding\r\nfor (let i = 0; i < 256; i++) {\r\n\tmult10[i] = +('1e' + Math.floor(45.15 - i * 0.30103))\r\n}\r\nexport const Decoder = Unpackr\r\nvar defaultUnpackr = new Unpackr({ useRecords: false })\r\nexport const unpack = defaultUnpackr.unpack\r\nexport const unpackMultiple = defaultUnpackr.unpackMultiple\r\nexport const decode = defaultUnpackr.unpack\r\nexport const FLOAT32_OPTIONS = {\r\n\tNEVER: 0,\r\n\tALWAYS: 1,\r\n\tDECIMAL_ROUND: 3,\r\n\tDECIMAL_FIT: 4\r\n}\r\nlet f32Array = new Float32Array(1)\r\nlet u8Array = new Uint8Array(f32Array.buffer, 0, 4)\r\nexport function roundFloat32(float32Number) {\r\n\tf32Array[0] = float32Number\r\n\tlet multiplier = mult10[((u8Array[3] & 0x7f) << 1) | (u8Array[2] >> 7)]\r\n\treturn ((multiplier * float32Number + (float32Number > 0 ? 0.5 : -0.5)) >> 0) / multiplier\r\n}\r\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","const Cookies = require('js-cookie')\nconst serial = require('../src/utils/serial')\nconst physics = require('../src/game/physics')\nconst here = document.location\nconst tps = physics.TICKS_PER_SECOND\nconst TURN_UNIT = 2 * Math.PI / tps\nconst BASE_SELF = { dead: true, posX: 0, posY: 0, velX: 0, velY: 0, orient: 0, speedMul: 1 }\nconst ZOOM_LEVELS = [1.0, 1.5, 2.0]\nconst canvas = document.getElementById('screen')\n\nconst common = require('./common')\nconst cursor = require('./cursor')\n\nlet ws = null\nlet self = BASE_SELF\nlet connectTimer = null\n\nlet objects = {\n  ships: [],\n  bullets: [],\n  powerups: [],\n  planets: []\n}\nlet state = {\n  ingame: false,\n  dead: false,\n  token: null,\n  mouseLocked: false\n}\nlet ticksPerFrame = 1\n\nlet count = 1\nlet leaderboard = []\nlet rubber = 150\nlet no_data = 0\nlet pinger = null\nlet seed = 0\nlet zoom = 1\nlet lastPartialTick = null\n\nconst PING_SMOOTHING = 5\nlet gotPing = false\nlet pingIndex = 0\nlet smoothedPings = Array(PING_SMOOTHING)\n\nlet resendCtrl = false\n\nconst draw = require('./draw')(canvas, self, objects, state, cursor)\nconst controls = require('./controls')(canvas, self, state, cursor,\n  {\n    useItem: () => useItem(),\n    resendControls: () => resendCtrl = true,\n    tryLockMouse: (e) => tryLockMouse(e),\n    nextZoom: () => nextZoom(),\n  })\nconst joystick = require('./joystick')(self, state, controls)\nconst tick = require('./tick')(self, objects, controls)\nlet ui\n\ndraw.checkSize()\n\nconst updateZoomText = () => {\n  ui.updateZoomText(zoom)\n  draw.checkSize()\n}\n\nconst setZoom = z => {\n  zoom = z\n  draw.setZoom(z)\n  updateZoomText()\n}\n\nconst nextZoom = () => {\n  let indx = (ZOOM_LEVELS.indexOf(zoom) + 1) % ZOOM_LEVELS.length\n  if (indx < 0) {\n    indx += ZOOM_LEVELS.length\n  }\n  Cookies.set('avaruuspeli-zoom', indx, { sameSite: 'strict' })\n  setZoom(ZOOM_LEVELS[indx])\n}\n\nconst resetPing = () => {\n  pingIndex = 0\n  gotPing = false\n}\n\nconst pingReport = (ping) => {\n  ping = Math.max(ping, 0)\n  if (!gotPing) {\n    gotPing = true\n    smoothedPings.fill(ping)\n  } else {\n    smoothedPings[pingIndex++] = ping\n    pingIndex %= PING_SMOOTHING\n  }\n}\n\nconst getSmoothedPing = () => {\n  if (!gotPing) return 0\n  let aggregate = 0\n  let weightSum = 0\n  const p2 = (pingIndex + PING_SMOOTHING - 2) % PING_SMOOTHING\n  const p1 = (pingIndex + PING_SMOOTHING - 1) % PING_SMOOTHING\n  for (let i = 0; i < PING_SMOOTHING; ++i) {\n    let weight\n    if (i === p1) {\n      weight = 4\n    } else if (i === p2) {\n      weight = 2\n    } else {\n      weight = 1\n    }\n    aggregate += smoothedPings[i] * weight\n    weightSum += weight\n  }\n  return aggregate / weightSum\n}\n\nconst onConnect = () => {\n  state.ingame = true\n  state.dead = false\n  if (connectTimer !== null) {\n    clearTimeout(connectTimer)\n    connectTimer = null\n  }\n  let nick = document.getElementById('nick').value.trim()\n  const perk = document.getElementById('perkselect').value.trim()\n  if (nick.length < 1) {\n    nick = ((100000000 * Math.random()) | 0).toString()\n  } else {\n    Cookies.set('avaruuspeli-name', nick)\n  }\n  Cookies.set('avaruuspeli-perk', perk)\n  ui.updateOnlineStatus('waiting for spawn')\n  serial.send(ws, serial.e_join(nick, perk))\n  draw.checkSize()\n  ui.updateControls(state)\n  joystick.resetJoystickCenter()\n  pinger = setInterval(() => {\n    if (++no_data > 10 || ws === null) {\n      disconnect()\n      return\n    }\n    serial.send(ws, serial.e_ping(performance.now()))\n  }, 500)\n}\n\nconst disconnect = () => {\n  if (ws) {\n    if (ws) ws.close()\n    ws = null\n  }\n  if (self.dead) {\n    reset()\n    ui.endOfBuffer()\n  } else {\n    ui.disconnect()\n  }\n  wasKilled()\n  leaveGame()\n}\n\nconst gotData = obj => {\n  let you = null\n  let ships = []\n  let bullets = null\n  let newBullets = null\n  let oldHealth = {}\n  for (const ship of objects.ships) {\n    oldHealth[ship._id] = ship.health\n  }\n\n  ({ you, ships, bullets, newBullets, count, rubber, seed } = obj)\n  draw.setRubber(rubber)\n\n  objects.ships = ships\n\n  for (const ship of ships) {\n    if (Object.prototype.hasOwnProperty.call(oldHealth, ship._id) && oldHealth[ship._id] > ship.health) {\n      draw.addBubble({ x: ship.posX, y: ship.posY, alpha: 100, radius: 0.3 * (1 + oldHealth[ship._id] - ship.health) })\n    }\n  }\n\n  if (self.dead) {\n    Object.assign(self, you)\n    self.dead = false\n  } else {\n    // if there is a high velocity difference, average them out\n    if (Math.abs(you.posX - self.posX) > 0.2) {\n      self.posX = (self.posX + 3 * you.posX) / 4\n      self.velX = (self.velX + you.velX) / 2\n    }\n    if (Math.abs(you.posY - self.posY) > 0.2) {\n      self.posY = (self.posY + 3 * you.posY) / 4\n      self.velY = (self.velY + you.velY) / 2\n    }\n    if (Math.abs(you.velX - self.velX) > 5) {\n      self.velX = you.velX\n    }\n    if (Math.abs(you.velY - self.velY) > 5) {\n      self.posY = you.posY\n    }\n    \n    if (controls.isAccelerating() !== (you.accel !== null)\n        || controls.isBraking() !== (you.brake !== null)) {\n      resendCtrl = true\n    }\n    ui.updateScore(you.score, self.score)\n    self.name = you.name\n    self.score = you.score\n    self.dead = you.dead\n    if (you.health < self.health) {\n      draw.gotDamage(self.health - you.health)\n      draw.addBubble({ x: self.posX, y: self.posY, alpha: 100, radius: 0.3 * (1 + self.health - you.health) })\n    }\n    self.health = you.health\n    self.latched = you.latched\n    self.speedMul = you.speedMul\n    self.item = you.item\n    self.regen = you.regen\n    self.overdrive = you.overdrive\n    self.rubbership = you.rubbership\n  }\n  if (physics.getPlanetSeed() != seed) {\n    physics.setPlanetSeed(seed)\n    objects.planets = physics.getPlanets(self.posX, self.posY)\n  }\n\n  const bulletTable = Object.fromEntries(bullets.map(bullet => [bullet._id, bullet]))\n  objects.bullets = [...objects.bullets, ...newBullets.filter(x => x)].\n    filter(bullet => bulletTable[bullet._id]).\n    map(bullet => Object.assign(bullet, bulletTable[bullet._id]))\n\n  ui.updatePowerup(self, state)\n  physics.setPlanetSeed(seed)\n  ui.updatePlayerCount(count)\n  ui.updateHealthBar(self.health)\n}\n\nconst onWebsocketMessage = (e) => {\n  let data = serial.recv(e.data)\n  if (data instanceof ArrayBuffer)\n    data = new Uint8Array(data)\n  const [cmd, obj] = serial.decode(data)\n\n  switch (cmd) {\n  case serial.C_token:\n    ui.updateOnlineStatus('in game')\n    state.token = obj.token\n    break\n\n  case serial.C_pong:\n    pingReport(performance.now() - obj.time)\n    ui.updateOnlineStatus(\n      `${self.dead ? 'game over' : 'in game'}, ping: ${getSmoothedPing().toFixed(1)}ms`)\n    break\n\n  case serial.C_data:\n    no_data = 0\n    obj.you = serial.deserializeShip(obj.you)\n    obj.ships = obj.ships.map(serial.deserializeShip)\n    obj.bullets = obj.bullets.map(serial.deserializeBullet)\n    obj.newBullets = obj.newBullets.map(serial.deserializeBullet)\n    gotData(obj)\n    state.dead = self.dead\n    break\n\n  case serial.C_board:\n    if (self.dead) break\n    leaderboard = obj.board\n    ui.updateLeaderboard(leaderboard)\n    break\n\n  case serial.C_orient:\n    self.orient = obj.orient\n    break\n\n  case serial.C_unauth:\n    disconnect()\n    break\n\n  case serial.C_killed:\n    draw.explosion(self, ticksPerFrame)\n    ui.defeatedByPlayer(obj.ship)\n    wasKilled()\n    break\n\n  case serial.C_crashed:\n    draw.explosion(self, ticksPerFrame)\n    ui.defeatedByCrash(obj.ship)\n    wasKilled()\n    break\n\n  case serial.C_hitpl:\n    draw.explosion(self, ticksPerFrame)\n    ui.defeatedByPlanet(obj.ship)\n    wasKilled()\n    self.velX = 0\n    self.velY = 0\n    break\n\n  case serial.C_killship:\n    obj.ship = serial.deserializeShip(obj.ship)\n    if (objects.ships.find(ship => ship._id === obj.ship._id) !== null) {\n      draw.explosion(obj.ship, ticksPerFrame)\n    }\n    objects.ships = objects.ships.filter(ship => ship._id !== obj.ship._id)\n    break\n\n  case serial.C_minexpl:\n  {\n    const mine = serial.deserializeBullet(obj.mine)\n    draw.addBubble({ x: mine.posX, y: mine.posY, alpha: 200, radius: 1 })\n    break\n  }\n\n  case serial.C_addpup:\n    if (self.dead) break\n    objects.powerups.push(serial.deserializePowerup(obj.powerup))\n    ui.showPowerupAnimation()\n    break\n\n  case serial.C_delpup:\n    objects.powerups = objects.powerups.filter(powerup => powerup._id !== obj.powerup)\n    break\n\n  case serial.C_deathk:\n    ui.addDeathLog(`${obj.ship} was killed by ${obj.by}`)\n    break\n\n  case serial.C_deathc:\n    ui.addDeathLog(`${obj.ship} crashed into ${obj.by}`)\n    break\n\n  case serial.C_deathp:\n    ui.addDeathLog(`${obj.ship} crashed into a planet`)\n    break\n\n  case serial.C_addpups:\n    objects.powerups.push(...obj.powerups.map(serial.deserializePowerup))\n    break\n  }\n}\n\nconst onWebsocketClose = (e) => {\n  const socket = e.target\n  if (socket !== ws) return\n\n  if (state.ingame) {\n    disconnect()\n  }\n  state.ingame = false\n  state.dead = true\n}\n\nconst joinGame = () => {\n  if (state.ingame && ws !== null) {\n    ws.removeEventListener('message', onWebsocketMessage)\n    ws.removeEventListener('close', onWebsocketClose)\n    state.token = null\n    if (ws) ws.close()\n    ws = null\n  }\n  reset()\n  state.token = null\n  ui.joiningGame()\n  ui.hideDialog()\n\n  resetPing()\n  \n  connectTimer = setTimeout(() => disconnect(), 5000)\n\n  let wsproto = here.protocol.replace('http', 'ws')\n  let port = here.port\n  if (port) {\n    port = `:${port}`\n  }\n  ws = new WebSocket(`${wsproto}//${here.hostname}${port}${here.pathname}`)\n  ws.binaryType = 'arraybuffer'\n  state.ingame = true\n\n  ws.addEventListener('open', onConnect)\n  ws.addEventListener('message', onWebsocketMessage)\n  ws.addEventListener('close', onWebsocketClose)\n}\n\nconst reset = () => {\n  objects.ships = []\n  objects.bullets = []\n  objects.powerups = []\n  //objects.planets = []\n  draw.reset()\n  controls.reset()\n}\n\nconst wasKilled = () => {\n  if (state.mouseLocked) {\n    document.exitPointerLock()\n  }\n  no_data = 0\n  state.dead = self.dead = true\n  state.token = null\n  ui.wasKilled()\n  ui.showDialog()\n  draw.checkSize()\n}\n\nconst leaveGame = () => {\n  if (pinger !== null) {\n    clearInterval(pinger)\n    pinger = null\n  }\n  state.dead = self.dead = true\n  state.ingame = false\n\n  ui.updateOnlineStatus('offline')\n  ui.showDialog()\n  draw.checkSize()\n  ui.updateControls(state)\n}\n\nconst serverTick = () => {\n  if (!ws || !self || self.dead) {\n    self.velX *= 0.95\n    self.velY *= 0.95\n    return\n  }\n\n  if (!state.token) {\n    return\n  }\n\n  if (resendCtrl) {\n    serial.send(ws, serial.e_ctrl(state.token, self.orient, \n      controls.isAccelerating(), controls.isBraking(), controls.isFiring()))\n    resendCtrl = false\n  }\n  \n  tick.serverTick(physics.TICK_DELTA, rubber)\n  ui.updateColors(self.health, performance.now())\n}\nsetInterval(serverTick, physics.MS_PER_TICK)\n\nlet turnLeftRamp = 0\nlet turnRightRamp = 0\n\nconst partialTick = (delta) => {\n  if (self.dead) return\n  ticksPerFrame = 1000 * delta / physics.MS_PER_TICK\n\n  if (!self.latched) {\n    // turning\n    const turnLeft = controls.isTurningLeft()\n    const turnRight = controls.isTurningRight()\n    if (turnLeft && !turnRight) {\n      self.orient -= turnLeftRamp * TURN_UNIT * ticksPerFrame\n      turnLeftRamp = Math.min(1, turnLeftRamp + ticksPerFrame * 0.1)\n      //physics.onTurn(self, chron.timeMs())\n      resendCtrl = true\n    } else if (turnRight && !turnLeft) {\n      self.orient += turnRightRamp * TURN_UNIT * ticksPerFrame\n      turnRightRamp = Math.min(1, turnRightRamp + ticksPerFrame * 0.1)\n      //physics.onTurn(self, chron.timeMs())\n      resendCtrl = true\n    }\n    if (!turnLeft)\n      turnLeftRamp = 0\n    if (!turnRight)\n      turnRightRamp = 0\n  } else {\n    turnLeftRamp = 0\n    turnRightRamp = 0\n  }\n  \n  // interpolate\n  self.posX += delta * self.velX\n  self.posY += delta * self.velY\n\n  for (const ship of objects.ships) {\n    ship.posX += delta * ship.velX\n    ship.posY += delta * ship.velY\n  }\n  for (const bullet of objects.bullets) {\n    switch (bullet.type) {\n    case 'bullet':\n    case 'laser':\n    case 'knockout':\n      bullet.posX += delta * bullet.velX\n      bullet.posY += delta * bullet.velY\n      bullet.dist += delta * bullet.velocity\n      break\n    case 'mine':\n      bullet.dist += delta / (physics.TICKS_PER_SECOND * physics.MINE_LIFETIME)\n    }\n  }\n  objects.bullets = objects.bullets.filter(b => b.dist <= physics.MAX_BULLET_DISTANCE)\n}\n\nconst useItem = () => {\n  if (self.item !== null) {\n    serial.send(ws, serial.e_useitem(state.token))\n    self.item = null\n  }\n}\n\nconst tryLockMouse = (e) => {\n  if (common.isMobile()) {\n    return\n  }\n  cursor.setPosition(e.clientX, e.clientY)\n  canvas.requestPointerLock()\n}\n\nwindow.addEventListener('blur', () => {\n  if (!state.token || state.dead) {\n    return\n  }\n  controls.unpress()\n}, true)\n\nwindow.addEventListener('beforeunload', () => {\n  if (ws) serial.send(ws, serial.e_quit(state.token))\n}, true)\n\nconst tryReadCookies = () => {\n  const name = Cookies.get('avaruuspeli-name')\n  if (name) {\n    document.getElementById('nick').value = name.substring(0, 20).trim()\n  }\n  const perk = Cookies.get('avaruuspeli-perk')\n  if (perk) {\n    document.getElementById('perkselect').value = ''\n    for (let i = 0; i < document.getElementById('perkselect').options.length; ++i) {\n      const option = document.getElementById('perkselect').options[i]\n      if (option.value == perk) {\n        option.selected = true\n        break\n      }\n    }\n  }\n  const cookieZoom = Cookies.get('avaruuspeli-zoom') | 0\n  if (isFinite(cookieZoom)) {\n    setZoom(ZOOM_LEVELS[cookieZoom % ZOOM_LEVELS.length])\n  }\n}\n\nconst frame = time => {\n  let delta = 0\n  if (lastPartialTick != null) {\n    delta = time - lastPartialTick\n    partialTick(delta / 1000)\n    ui.updateOpacity(delta)\n  }\n  lastPartialTick = time\n  draw.frame(time, delta)\n  window.requestAnimationFrame(frame)\n}\n\nwindow.requestAnimationFrame(frame)\n\nui = require('./ui')({ joinGame, tryLockMouse, nextZoom })\nreset()\nui.showDialog(true)\nleaveGame()\nupdateZoomText()\nui.endOfBuffer()\nui.reset()\ntryReadCookies()\n"],"names":["isMobile","test","navigator","userAgent","module","exports","chron","require","canvas","self","state","cursor","callbacks","firing","accel","brake","turnLeft","turnRight","isAccelerating","isBraking","isFiring","isTurningLeft","isTurningRight","accelerate","flag","resendControls","reset","unpress","handleMouseDown","e","mouseLocked","document","hidden","dead","tryLockMouse","handleMouseMove","handleMouseUp","leftButton","buttons","rightButton","useItem","addPosition","movementX","movementY","mcx","body","clientWidth","mcy","clientHeight","radius","Math","hypot","getX","getY","latched","orient","atan2","addEventListener","pointerLockElement","pointerType","getElementById","pressure","window","PointerEvent","token","code","timeMs","nextZoom","shiftKey","cursorX","cursorY","setPosition","x","y","LCG","geom","physics","fogCanvas","createElement","fogCtx","getContext","SQRT_H","sqrt","GRID_SIZE","PLANET_SPIN_SPEED","MINE_X","MINE_Y","objects","ctx","damageGot","lcg","lines","smokes","bubbles","planetAngle","damageAlpha","lastSmoke","zoom","rubber","cx","cy","unitSize","gotDamage","damage","performance","now","setZoom","z","setRubber","r","checkSize","width","innerWidth","devicePixelRatio","height","innerHeight","min","VIEW_DISTANCE","drawFog","addBubble","bubble","push","clearRect","bgradient","createRadialGradient","addColorStop","beginPath","arc","PI","rect","fillStyle","fill","drawShip","ship","p1","p2","p3","p4","getShipPoints","x1","y1","x2","y2","x3","y3","x4","y4","x0","y0","posX","posY","strokeStyle","moveTo","lineTo","closePath","stroke","tp1","tp2","tp3","tp4","tp5","getThrusterPoints","x5","y5","xo","random","yo","font","textAlign","fillText","name","drawBullet","bullet","lineWidth","type","i","angle","sin","cos","velX","velY","drawLine","line","alpha","drawPowerup","powerup","color","sx","sy","drawSmoke","smoke","drawBubble","max","computePlanetAngle","drawPlanet","planet","reseed","seed","gon","abs","randomInt","randomOffset","randomSign","fac","createLine","xv","yv","tpf","vx","vy","vangle","explosion","x6","y6","frame","time","delta","xm","ym","fillRect","dx","dy","ingame","gradient","RUBBERBAND_BUFFER","health","interval","Object","prototype","hasOwnProperty","call","_id","ships","bullets","planets","powerups","length","ctr","alp","powerupColor","filter","shipid","keys","drawImage","jouter","jbase","jstick","controls","applyPosition","hjbw","offsetWidth","hjbh","offsetHeight","offsetLeft","offsetTop","h","willAccel","shouldUpdateAccelStart","resetJoystickCenter","style","top","left","clientX","clientY","stopPropagation","stopImmediatePropagation","serverTick","fireWaitTicks","recoil","inertia","rubberband","getPlanets","gravityShip","syncPosX","syncPosY","gravityBullet","common","dialogOpacity","DEBUG","animation","visibility","updateZoomText","textContent","showDialog","always","display","opacity","position","overflow","wasKilled","hideDialog","endOfBuffer","disconnect","updateOpacity","makeTd","text","td","makeTableRow","lb","tr","appendChild","updateLeaderboard","leaderboard","leaderBoardTable","newBody","replaceChild","childNodes","formatTime","sec","floor","slice","updateControls","updatePowerup","resText","item","rubbership","overdrive","regen","trim","updateOnlineStatus","debug","updateColors","background","t","updateScore","scoreNow","scoreWas","updatePlayerCount","players","updateHealthBar","ceil","addDeathLog","deathLog","childElementCount","removeChild","firstChild","p","setTimeout","parentNode","defeatedByPlayer","innerHTML","defeatedByCrash","defeatedByPlanet","showPowerupAnimation","joiningGame","blur","joinGame","fullscreenElement","exitFullscreen","documentElement","requestFullscreen","global","factory","define","amd","current","Cookies","noConflict","assign","target","arguments","source","key","defaultConverter","read","value","replace","decodeURIComponent","write","encodeURIComponent","init","converter","defaultAttributes","set","attributes","expires","Date","toUTCString","escape","stringifiedAttributes","attributeName","split","cookie","get","cookies","jar","parts","join","foundKey","create","remove","withAttributes","withConverter","freeze","api","path","maths","Counter","bulletCounter","filterInplace","BULLET_VELOCITY","MAX_SHIP_VELOCITY","BULLET_DAMAGE_MULTIPLIER","newBullet","dist","velocity","shooter","shooterName","isHit","canPickUp","punch","next","FIELDS","FIELDS_SHORT","bulletTypeRadius","laser","knockout","bulletSystemFactory","handler","getBullets","removeBullet","onBulletDeleted","handleShipBulletCollision","getShipById","absorber","healthMul","damageShip","killShipByBullet","hitX","hitY","normalize","lastDamageAt","lastDamageBy","checkMaxVelocity","handlePowerupBulletCollision","applyPowerup","removeMinesBy","shipId","projList","projCount","moveBullets","powerupList","getPowerups","bulletList","powerupCount","bulletCount","MAX_BULLET_DISTANCE","newX","newY","isLaser","collisionShip","iterateShips","closestSynchroDistance","posXnew","posYnew","lerp2D","clamp","getCollisionPoints","lineClosestDistanceToTriangle","collisionPowerup","j","pickupRadius","a1","a2","lineIntersectsLine","hitPlanet","primerShip","onMineExplode","MINE_LIFETIME","TICKS_PER_SECOND","addProjectile","extras","extraDist","orientOffset","speedFactor","damageFactor","rangeSub","noShear","typeSpeedMul","bulletSpeedMul","system","GRAV","TICK_DELTA","MS_PER_TICK","ACTUAL_MAX_SHIP_VELOCITY","ACCEL_BASE","ACCEL_FACTOR","MIN_SHIP_VELOCITY","LATCH_VELOCITY","BRAKE_MUL","RUBBERBAND_RADIUS_MUL","INERTIA_MUL","RECOIL","PLANET_CHUNK_SIZE","PLANET_SEED","getAccelMul","accelTimeMs","getAccelRamp","v","unlerp1D","checkMinVelocity","maxvel","healthToVelocity","speedMul","getPlanetSeed","setPlanetSeed","newPlanetSeed","getPlanetsForChunk","xb","yb","xu","yu","hasOverdrive","hasRubbership","hasRegen","accelMul","thrustBoost","highAgility","gx","gy","gravity","d","r2","f","thrust","vector","dv","direction","dot2D","getRubberbandRadius","playerCount","pow","distCenter","maxRadius","baseX","baseY","nv","lerp1D","powerupCounter","newPowerup","despawn","pickupDist","Infinity","pickupPlayer","powerupSystemFactory","nextPowerup","clear","trySpawnPowerup","tries","count","theta","playerDist","apply","getShips","map","inPlanet","tooClose","onPowerupSpawned","setNextPowerupTime","division","getShipCount","maybeSpawnPowerup","ITEM_COUNT","removePowerup","updateClosestPlayer","onPowerupDeleted","updatePowerups","forEach","shipCounter","SHIP_RECT_RADIUS","SHIP_RADIUS","newShip","score","firingInterval","planetDamageMul","healRate","shipSystemFactory","Map","values","id","size","newPlayerShip","spawn","latchToPlanet","latchToPlanetWithAngle","computePlanetPoint","onShipLatch","spawnLone","randShip","bulletDist","ideal","find","testPlanet","a","b","mostIdeal","reduce","angleOffset","minimalScore","testAngle","doFire","shipAcceleration","radiusGoal","doAccel","doBrake","premoveShips","moveShips","ship1","pup","lineIntersectCircleFirstDepth","ship2","testShipShipCollision","search","searchSquare","lineClosestPointToPoint","squarePair","handleShipPlanetCollision","handleShipShipCollision","dmg1","dmg2","onShipKilledByCrash","killShip","q1","q2","q4","testTriangleCollision","col_mul","getPlanetDamageMultiplier","col_vmul","getPlanetDamageSpeedMultiplier","offx","offy","by","onShipKilledByPlanet","deleteShip","delete","onDeath","onShipKilled","getTime","constructor","counter","BigInt","val","toString","padStart","asUintN","list","fn","SHIP_SCALE","v1","v2","dot2Dxy","m","pointInTriangle","xp","yp","c1","c2","c3","testTriangleCollisionSub","a3","b1","b2","b3","dax","day","dbx","dby","dcx","dcy","b32x","b23y","D","sa","sb","sc","ta","tb","tc","getDirectionSign","s","sign","collinearLinesIntersect","c","isFinite","n","lineIntersectsTriangle","l1","l2","t1","t2","t3","lineClosestDistanceToLine","rx","ry","ux","uy","ru","rv","uu","uv","vv","det","s0","t0","s1","as","bt","pointClosestDistanceToLine","pointClosestDistanceToTriangle","Number","NaN","ax","ay","bx","px","py","u1","u2","vu","A","B","C","wrapRadianAngle","ox","oy","padFromBelow","withinBoundingSquare","center","rotatePoint","rotatePointOffset","S","LCG_A","LCG_C","SC","Generator","msgpackr","moduleShip","moduleBullet","modulePowerup","serializeFrom","object","fields","field","deserializeFrom","array","serializeShip","obj","serializeShipShort","deserializeShip","arr","serializeBullet","serializeBulletShort","deserializeBullet","serializePowerup","deserializePowerup","C_ping","C_join","C_ctrl","C_quit","C_useitem","C_pong","C_token","C_data","C_board","C_killship","C_orient","C_unauth","C_addpup","C_delpup","C_minexpl","C_deathk","C_deathc","C_deathp","C_addpups","C_crashed","C_killed","C_hitpl","encode","cmd","data","pack","messageKeys","decode","unpack","fromEntries","index","recv","send","ws","e_token","e_data","you","newBullets","e_unauth","e_board","board","e_killship","e_crashed","e_killed","e_orient","e_hitpl","e_join","nick","perk","e_ping","e_pong","e_quit","e_ctrl","e_addpup","e_delpup","e_useitem","e_minexpl","proj","e_deathk","e_deathc","e_deathp","e_addpups","Packr","Encoder","addExtension","NEVER","ALWAYS","DECIMAL_ROUND","DECIMAL_FIT","REUSE_BUFFER_MODE","Unpackr","Decoder","C1","unpackMultiple","FLOAT32_OPTIONS","clearSource","roundFloat32","isNativeAccelerationEnabled","decodeIter","encodeIter","useRecords","mapsAsObjects","packIter","objectIterator","options","Error","Symbol","iterator","packIterSync","then","asyncIterator","packIterAsync","packr","unpackIter","bufferIterator","unpackr","incomplete","parser","chunk","yields","Buffer","concat","undefined","err","lastPosition","iter","mult10","C1Type","typedArrays","unpackAddExtension","textEncoder","TextEncoder","error","extensions","extensionClasses","hasNodeBuffer","ByteArrayAllocate","allocUnsafeSlow","Uint8Array","ByteArray","MAX_BUFFER_SIZE","keysTarget","targetView","safeEnd","bundledStrings","MAX_BUNDLE_SIZE","hasNonLatin","RECORD_SYMBOL","offset","typeBuffer","start","hasSharedUpdate","structures","referenceMap","lastSharedStructuresLength","encodeUtf8","utf8Write","string","maxBytes","encodeInto","subarray","written","isSequential","sequential","hasSharedStructures","saveStructures","maxSharedStructures","structuredClone","moreTypes","maxOwnStructures","useTwoByteRecords","sharedLimitId","maxStructureId","recordIdsToRemove","transitionsCount","serializationsSinceTransitionRebuild","encodeOptions","DataView","buffer","bundleStrings","uninitialized","_mergeStructures","getStructures","sharedLength","transitions","nextTransition","transition","l","nextId","writeBundles","idsToInsert","makeRoom","serialized","insertIds","end","returnBuffer","RESET_BUFFER_MODE","strLength","extStart","setUint16","twoByte","headerSize","strPosition","charCodeAt","copyWithin","setUint32","setInt16","setInt32","useFloat32","setFloat32","xShifted","setFloat64","referee","writeObject","Array","entryValue","extensionClass","extension","currentTarget","currentTargetView","currentPosition","result","writeExtensionData","setBigInt64","setBigUint64","largeBigIntToFloat","RangeError","encodeUndefinedAsNil","writeFunction","variableMapSize","safePrototype","objectOffset","progressiveRecords","wroteKeys","lastTransition","newTransitions","newRecord","insertNewRecord","recordId","__keys__","newSize","round","newBuffer","copy","shouldShareStructure","nextOwnId","highByte","isShared","shift","insertionOffset","mainTarget","mainPosition","mainSafeEnd","mainStart","keysPosition","newEnd","insertionPosition","useBuffer","byteOffset","byteLength","clearSharedData","copyBinary","targetOffset","endOffset","Set","RegExp","ArrayBuffer","getPrototypeOf","date","allocateForWrite","seconds","useTimestamp32","getMilliseconds","isNaN","onInvalidDate","from","message","regex","flags","arrayBuffer","writeExtBuffer","writeBuffer","typedArray","indexOf","distanceToMove","lastEnd","sort","pop","writeStrings","startPosition","Class","unshift","defaultPackr","decoder","TextDecoder","src","srcEnd","alreadySet","EMPTY_ARRAY","strings","stringPosition","currentUnpackr","currentStructures","srcString","srcStringStart","srcStringEnd","currentExtensions","dataView","defaultOptions","sequentialMode","inlineObjectReadThreshold","Function","saveState","checkedRead","defaultUnpackr","loadedStructures","existingStructures","structure","existing","restoreStructures","getPosition","trusted","postBundlePosition","startsWith","loadStructures","createStructureReader","readKey","shortStringInJS","longStringInJS","readFixedString","position1","position0","readBin","getUint16","getUint32","readExt","getFloat32","multiplier","getFloat64","int64AsNumber","getBigUint64","getInt8","getInt16","getInt32","getBigInt64","recordDefinition","noBuffer","readString8","readString16","readString32","readArray","readMap","validName","firstId","readObject","JSON","stringify","createSecondByteReader","read0","readStringJS","setExtractor","extractStrings","readString","headerLength","extraction","srcStringLength","units","byte1","byte2","byte3","byte4","unit","fromCharCode","String","bytes","byte","g","k","o","readOnlyJSString","copyBuffers","keyCache","entry","checkPosition","firstByte","existingStructure","glbl","refEntry","targetProperties","used","typeCode","typedArrayName","TEMP_BUNDLE","dataSize","dataPosition","callback","savedSrcEnd","savedPosition","savedStringPosition","savedSrcStringStart","savedSrcStringEnd","savedSrcString","savedStrings","savedReferenceMap","savedBundledStrings","savedSrc","savedStructures","savedStructuresContents","savedPackr","savedSequentialMode","splice","f32Array","Float32Array","u8Array","float32Number","serial","here","location","tps","TURN_UNIT","BASE_SELF","ZOOM_LEVELS","connectTimer","ticksPerFrame","no_data","pinger","lastPartialTick","PING_SMOOTHING","gotPing","pingIndex","smoothedPings","resendCtrl","draw","joystick","tick","ui","indx","sameSite","resetPing","pingReport","ping","getSmoothedPing","aggregate","weightSum","weight","onConnect","clearTimeout","setInterval","close","leaveGame","gotData","oldHealth","bulletTable","onWebsocketMessage","toFixed","mine","onWebsocketClose","socket","removeEventListener","wsproto","protocol","port","WebSocket","hostname","pathname","binaryType","exitPointerLock","clearInterval","turnLeftRamp","turnRightRamp","partialTick","requestPointerLock","tryReadCookies","substring","option","selected","cookieZoom","requestAnimationFrame"],"sourceRoot":""}